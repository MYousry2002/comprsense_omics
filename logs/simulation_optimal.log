Running simulation with: num_measurements=10, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=500
Running repeat 1/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799384.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_111390_1741799384'
Loaded dataset: downsampled_500genes_111390_1741799384
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.17728115251464405 2.8770354602799904 nan 8.0 8.0
0.06735163020345869 10.896706348560155 nan 8.0 8.0
0.06460593180989394 10.871380393881765 nan 8.0 8.0
0.06322782876768462 11.26414902048289 nan 8.0 8.0
0.06251026262926851 11.491228698141255 nan 8.0 8.0
0.06189663840215265 11.642191168129845 nan 8.0 8.0
0.06132667672244141 11.692994146957776 nan 8.0 8.0
0.06065183420297415 11.787871881194732 nan 8.0 8.0
0.06030782523360878 11.854839740011945 nan 8.0 8.0
0.06007079602951648 11.8775813585801 nan 8.0 8.0
0.05986794621651126 11.892159207645824 nan 8.0 8.0
0.059716353655029475 11.905587676151928 nan 8.0 8.0
0.05965027794561717 11.898320936422769 nan 8.0 8.0
0.0595431174153328 11.91681982881125 nan 8.0 8.0
0.05943554398427642 11.920669134243276 nan 8.0 8.0
0.059344637115504195 11.934949559390999 nan 8.0 8.0
0.05919200544986225 11.920986336443768 nan 8.0 8.0
0.05911149511036118 11.909638337108014 nan 8.0 8.0
0.059032816168934854 11.95486251417299 nan 8.0 8.0
0.05898113679592931 11.924010274961432 nan 8.0 8.0
U dimensions = (477, 32)
Iteration 0 of 1
phi.shape: (10, 477)
U.shape: (477, 32)
phi.dot(U).T shape: (32, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799384.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799384_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799384_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799384_test_data.npy
Cleanup complete.

Simulation 1/10 score: 0.6573777556640363
Running repeat 2/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799420.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_111390_1741799420'
Loaded dataset: downsampled_500genes_111390_1741799420
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.20653750812848515 3.1143799309841276 nan 8.0 8.0
0.06841040457595438 11.036735537638961 nan 8.0 8.0
0.06614327271044107 11.198248386678172 nan 8.0 8.0
0.06478816258153386 11.252308338129776 nan 8.0 8.0
0.06374027184085573 11.388691124079422 nan 8.0 8.0
0.06204222992771957 11.482865180934699 nan 8.0 8.0
0.059924992423505796 11.421080956735535 nan 8.0 8.0
0.05881787190098986 11.28674126861629 nan 8.0 8.0
0.05842630926636594 11.213095191852014 nan 8.0 8.0
0.05820089779894799 11.17502661312113 nan 8.0 8.0
0.058091997158581044 11.11890780329611 nan 8.0 8.0
0.058011218175646584 11.098126318477924 nan 8.0 8.0
0.05795896171058834 11.061254946129425 nan 8.0 8.0
0.057948477310126534 11.041210566736488 nan 8.0 8.0
0.057917679997163574 11.023678748933067 nan 8.0 8.0
0.057910103190004225 11.021862794004315 nan 8.0 8.0
0.05787246371588073 11.031501596475731 nan 8.0 8.0
0.057835216767150754 11.02761551672215 nan 8.0 8.0
0.05781032343672288 11.025975407527918 nan 8.0 8.0
0.05778677519875697 11.040778363908824 nan 8.0 8.0
U dimensions = (477, 32)
Iteration 0 of 1
phi.shape: (10, 477)
U.shape: (477, 32)
phi.dot(U).T shape: (32, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799420.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799420_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799420_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799420_test_data.npy
Cleanup complete.

Simulation 2/10 score: 0.6509211168758356
Running repeat 3/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799454.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_111390_1741799454'
Loaded dataset: downsampled_500genes_111390_1741799454
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.204388975810038 3.0177919448888315 nan 8.0 8.0
0.06632391743868682 11.322529104512041 nan 8.0 8.0
0.06413911625997326 11.065378457310613 nan 8.0 8.0
0.06285882497140405 10.955247088973264 nan 8.0 8.0
0.06200585073428411 10.91273077904565 nan 8.0 8.0
0.06124493867685776 10.865348299872334 nan 8.0 8.0
0.06077316175762504 10.701309678866382 nan 8.0 8.0
0.06046185432654161 10.569110458024127 nan 8.0 8.0
0.06020815167805915 10.59639514147271 nan 8.0 8.0
0.06006167141931407 10.592219223745456 nan 8.0 8.0
0.05989756318756423 10.578875174774572 nan 8.0 8.0
0.059787523095192086 10.582680131874826 nan 8.0 8.0
0.059711812781362505 10.568551835146677 nan 8.0 8.0
0.059671368767006294 10.565561635815707 nan 8.0 8.0
0.05961376216832903 10.58046659476134 nan 8.0 8.0
0.05958462489136185 10.589295657163163 nan 8.0 8.0
0.05958112613769451 10.57949075237977 nan 8.0 8.0
0.059575290382084756 10.577482042380186 nan 8.0 8.0
0.05955227157099885 10.582212128137677 nan 8.0 8.0
0.059551946667173006 10.565953147401736 nan 8.0 8.0
U dimensions = (477, 35)
Iteration 0 of 1
phi.shape: (10, 477)
U.shape: (477, 35)
phi.dot(U).T shape: (35, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799454.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799454_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799454_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799454_test_data.npy
Cleanup complete.

Simulation 3/10 score: 0.6778559002134896
Running repeat 4/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799500.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_111390_1741799500'
Loaded dataset: downsampled_500genes_111390_1741799500
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.20249005948604848 3.116700432310019 nan 8.0 8.0
0.06963882777565478 11.238877491936401 nan 8.0 8.0
0.06742517225262834 11.189261845643669 nan 8.0 8.0
0.06572242598081723 11.318416572685226 nan 8.0 8.0
0.06476809047204968 11.359368219308617 nan 8.0 8.0
0.06417230523710082 11.566097943064658 nan 8.0 8.0
0.06367799115074257 11.605801492709015 nan 8.0 8.0
0.06325681674514394 11.616781253547307 nan 8.0 8.0
0.06310678033911754 11.614772743246714 nan 8.0 8.0
0.0629791335444766 11.612475085861467 nan 8.0 8.0
0.06284615103138536 11.606334711207703 nan 8.0 8.0
0.06279721119028114 11.589275116011414 nan 8.0 8.0
0.0627266300426712 11.58949749411482 nan 8.0 8.0
0.06262322719175573 11.570883713887453 nan 8.0 8.0
0.06251486310306631 11.566019263958108 nan 8.0 8.0
0.06232482270657269 11.541225294409164 nan 8.0 8.0
0.06221540439521733 11.531728042771194 nan 8.0 8.0
0.06219324315731123 11.519961851353369 nan 8.0 8.0
0.062158646325006006 11.525095244586042 nan 8.0 8.0
0.062131196553501966 11.524250947007802 nan 8.0 8.0
U dimensions = (477, 34)
Iteration 0 of 1
phi.shape: (10, 477)
U.shape: (477, 34)
phi.dot(U).T shape: (34, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799500.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799500_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799500_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799500_test_data.npy
Cleanup complete.

Simulation 4/10 score: 0.6526478887781251
Running repeat 5/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799557.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_111390_1741799557'
Loaded dataset: downsampled_500genes_111390_1741799557
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.18991019367198436 2.98584619402446 nan 8.0 8.0
0.06923834871712042 11.536257995462364 nan 8.0 8.0
0.06547944944304718 11.42407297192299 nan 8.0 8.0
0.06345128007339373 11.352496629345957 nan 8.0 8.0
0.06230306601621627 11.320714536290525 nan 8.0 8.0
0.06157267978633285 11.348007074293632 nan 8.0 8.0
0.06117899214303968 11.327294480652315 nan 8.0 8.0
0.06095807892524885 11.309463495592825 nan 8.0 8.0
0.060757218248689404 11.269153133652463 nan 8.0 8.0
0.06071331956634496 11.223809126225389 nan 8.0 8.0
0.06065653399138515 11.2035335021118 nan 8.0 8.0
0.060600467741334985 11.1792911388865 nan 8.0 8.0
0.06053567575374941 11.175612260345225 nan 8.0 8.0
0.06045147936111972 11.18186592693684 nan 8.0 8.0
0.06040960221210023 11.166759138221261 nan 8.0 8.0
0.06040168490260511 11.135307468853467 nan 8.0 8.0
0.06035928087529552 11.142123028054606 nan 8.0 8.0
0.0603098875557343 11.147564358647362 nan 8.0 8.0
0.06029113002352948 11.142372681310821 nan 8.0 8.0
0.060284902561357656 11.141518658241013 nan 8.0 8.0
U dimensions = (477, 33)
Iteration 0 of 1
phi.shape: (10, 477)
U.shape: (477, 33)
phi.dot(U).T shape: (33, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799557.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799557_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799557_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799557_test_data.npy
Cleanup complete.

Simulation 5/10 score: 0.650517233821261
Running repeat 6/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799619.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_111390_1741799619'
Loaded dataset: downsampled_500genes_111390_1741799619
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.20635357529455678 2.8500348871993193 nan 8.0 8.0
0.06933949154339702 10.971056349517466 nan 8.0 8.0
0.06541477869907208 10.817788137082252 nan 8.0 8.0
0.06303568369509371 10.663750220254803 nan 8.0 8.0
0.06205830851693206 10.65465877411169 nan 8.0 8.0
0.0617238698130278 10.737233724858946 nan 8.0 8.0
0.06153082895972484 10.864902923577779 nan 8.0 8.0
0.06138284053885035 10.835477329908874 nan 8.0 8.0
0.06126392100252154 10.836874977146383 nan 8.0 8.0
0.061124893300722016 10.873213785535075 nan 8.0 8.0
0.06094642112695614 10.876886441946416 nan 8.0 8.0
0.06082746265280381 10.870674815067025 nan 8.0 8.0
0.06076964338463231 10.873914273199825 nan 8.0 8.0
0.06073796291240574 10.88565342112176 nan 8.0 8.0
0.06069839429267254 10.897811459584927 nan 8.0 8.0
0.06064946746692823 10.909301195543758 nan 8.0 8.0
0.06064115954876359 10.9285319976587 nan 8.0 8.0
0.06063296725354206 10.933358778918636 nan 8.0 8.0
0.06062213894805313 10.931109558311421 nan 8.0 8.0
0.06062092043078848 10.930889987839086 nan 8.0 8.0
U dimensions = (477, 30)
Iteration 0 of 1
phi.shape: (10, 477)
U.shape: (477, 30)
phi.dot(U).T shape: (30, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799619.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799619_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799619_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799619_test_data.npy
Cleanup complete.

Simulation 6/10 score: 0.652822079656188
Running repeat 7/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799670.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_111390_1741799670'
Loaded dataset: downsampled_500genes_111390_1741799670
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.18745085056507282 2.882721607840635 nan 8.0 8.0
0.07023711257115817 11.370923034141287 nan 8.0 8.0
0.06770295371321422 11.386140339787435 nan 8.0 8.0
0.0666670682159306 11.3876910999983 nan 8.0 8.0
0.0658425662246872 11.460437201157047 nan 8.0 8.0
0.06488527188442772 11.556649024777625 nan 8.0 8.0
0.06433154723334467 11.618008076907053 nan 8.0 8.0
0.06396620128013797 11.610477520037966 nan 8.0 8.0
0.06380818341960404 11.593568777018998 nan 8.0 8.0
0.06371204969030164 11.614237419289307 nan 8.0 8.0
0.06365259901448661 11.653183771657687 nan 8.0 8.0
0.06360441368213421 11.720607241704581 nan 8.0 8.0
0.0634644600413985 11.702997818133083 nan 8.0 8.0
0.06337113486810664 11.680460059829601 nan 8.0 8.0
0.06334580182589578 11.677276672280444 nan 8.0 8.0
0.06334334814854514 11.668716306621816 nan 8.0 8.0
0.06333175104571542 11.673185023224113 nan 8.0 8.0
0.06331536508944913 11.676827386444796 nan 8.0 8.0
0.06330062446632079 11.678492874984439 nan 8.0 8.0
0.06326690831815307 11.68285164951888 nan 8.0 8.0
U dimensions = (477, 34)
Iteration 0 of 1
phi.shape: (10, 477)
U.shape: (477, 34)
phi.dot(U).T shape: (34, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799670.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799670_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799670_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799670_test_data.npy
Cleanup complete.

Simulation 7/10 score: 0.7066072988166329
Running repeat 8/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799705.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_111390_1741799705'
Loaded dataset: downsampled_500genes_111390_1741799705
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.19143113998872863 2.9771493769241255 nan 8.0 8.0
0.07390085705918203 11.422367367197188 nan 8.0 8.0
0.06893527513208819 11.33020423605709 nan 8.0 8.0
0.0671513845588283 11.391747871772456 nan 8.0 8.0
0.06655370249859538 11.49316197013185 nan 8.0 8.0
0.06569923847119219 11.534174073670169 nan 8.0 8.0
0.06504210761324214 11.624903305817472 nan 8.0 8.0
0.06462275297912212 11.656606796504398 nan 8.0 8.0
0.06441399850197749 11.657391227240243 nan 8.0 8.0
0.06423923557812217 11.657297737148351 nan 8.0 8.0
0.06416040403544299 11.651067042500967 nan 8.0 8.0
0.064093822273116 11.65274222599772 nan 8.0 8.0
0.06404119499870642 11.652033231756743 nan 8.0 8.0
0.0640187468008756 11.654277019378961 nan 8.0 8.0
0.06400635188297243 11.652147672338302 nan 8.0 8.0
0.06399549067715504 11.649795789761571 nan 8.0 8.0
0.06398243897142575 11.646420054899648 nan 8.0 8.0
0.06397816907176268 11.644956451878594 nan 8.0 8.0
0.06396319196485278 11.647993637457938 nan 8.0 8.0
0.06395949938129952 11.648343791128848 nan 8.0 8.0
U dimensions = (477, 29)
Iteration 0 of 1
phi.shape: (10, 477)
U.shape: (477, 29)
phi.dot(U).T shape: (29, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799705.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799705_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799705_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799705_test_data.npy
Cleanup complete.

Simulation 8/10 score: 0.6552025987529203
Running repeat 9/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799739.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_111390_1741799739'
Loaded dataset: downsampled_500genes_111390_1741799739
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.2122881281336193 2.7263994411172368 nan 8.0 8.0
0.07164525709283842 11.514763233483603 nan 8.0 8.0
0.0689079812188903 11.052649686831009 nan 8.0 8.0
0.06675838791031774 11.048744479222492 nan 8.0 8.0
0.06571787511343441 11.102726508269189 nan 8.0 8.0
0.06508898908887528 11.179873001506243 nan 8.0 8.0
0.06472868197893866 11.21175036048522 nan 8.0 8.0
0.06451867132229872 11.214488198352921 nan 8.0 8.0
0.0644057274996388 11.220095627616226 nan 8.0 8.0
0.06430996274078149 11.218615521979519 nan 8.0 8.0
0.06420919155005655 11.209211596871867 nan 8.0 8.0
0.06413625053126937 11.211303921196485 nan 8.0 8.0
0.06405319647546381 11.206020952958355 nan 8.0 8.0
0.06397035738936374 11.194542941957296 nan 8.0 8.0
0.06383768764078557 11.18178264696725 nan 8.0 8.0
0.06375783642908817 11.132964569757515 nan 8.0 8.0
0.06371421757838669 11.130814142836671 nan 8.0 8.0
0.06369699032182663 11.13306141990222 nan 8.0 8.0
0.06367872663703145 11.138058718733095 nan 8.0 8.0
0.06365382127014796 11.12416033636411 nan 8.0 8.0
U dimensions = (477, 28)
Iteration 0 of 1
phi.shape: (10, 477)
U.shape: (477, 28)
phi.dot(U).T shape: (28, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799739.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799739_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799739_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799739_test_data.npy
Cleanup complete.

Simulation 9/10 score: 0.643066572038377
Running repeat 10/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799781.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_111390_1741799781'
Loaded dataset: downsampled_500genes_111390_1741799781
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.22146752618371068 2.6074910605090103 nan 8.0 8.0
0.07190921683072349 10.273468437086759 nan 8.0 8.0
0.0691830370259634 10.665267972839143 nan 8.0 8.0
0.06741333148451345 10.791943738772973 nan 8.0 8.0
0.06654540898906247 10.870862897586052 nan 8.0 8.0
0.06592826583177125 10.94170274844839 nan 8.0 8.0
0.0653022582052214 11.009909945088525 nan 8.0 8.0
0.06467268968020745 11.001656097005823 nan 8.0 8.0
0.0644076333251472 10.996482269036191 nan 8.0 8.0
0.0641355520909529 10.98495503176432 nan 8.0 8.0
0.06403787752512502 10.95443625714693 nan 8.0 8.0
0.06395817044982322 10.949713578910865 nan 8.0 8.0
0.06390750272931411 10.942076472126363 nan 8.0 8.0
0.0638546350584811 10.932760528916935 nan 8.0 8.0
0.06381058816487806 10.919228650133562 nan 8.0 8.0
0.06376520361069438 10.911777057052687 nan 8.0 8.0
0.06374559731985074 10.91263176686509 nan 8.0 8.0
0.06373467732247329 10.912531101498713 nan 8.0 8.0
0.06371923503897836 10.91445825176404 nan 8.0 8.0
0.06369836953451335 10.926211805282241 nan 8.0 8.0
U dimensions = (477, 29)
Iteration 0 of 1
phi.shape: (10, 477)
U.shape: (477, 29)
phi.dot(U).T shape: (29, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799781.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799781_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799781_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_111390_1741799781_test_data.npy
Cleanup complete.

Simulation 10/10 score: 0.6537037618356858
Results saved: results/simulation/results_optimal.csv
Running simulation with: num_measurements=10, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=1000
Running repeat 1/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799391.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_280394_1741799391'
Loaded dataset: downsampled_1000genes_280394_1741799391
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.10499950338263464 4.70414573288264 nan 8.0 8.0
0.06215909482990378 8.904964852406959 nan 8.0 8.0
0.062091035388812665 8.066852002017797 nan 8.0 8.0
0.06218979636431898 7.721660627925106 nan 8.0 8.0
0.062069001410373525 7.749978425217655 nan 8.0 8.0
0.061987795734516404 7.792879492963605 nan 8.0 8.0
0.061923856895438334 7.934816730154244 nan 8.0 8.0
0.06190366948880077 8.031701329663196 nan 8.0 8.0
0.061928259742066394 8.023832937950253 nan 8.0 8.0
0.06190899445634768 8.016447576148424 nan 8.0 8.0
0.06191074815065778 8.005593303697584 nan 8.0 8.0
0.061929905198301216 7.998794355926159 nan 8.0 8.0
0.061943723274741624 7.90200657186442 nan 8.0 8.0
0.061954761546436976 7.887407548784112 nan 8.0 8.0
0.06196867403893791 7.951839365745572 nan 8.0 8.0
0.06199559287263301 7.941600991296925 nan 8.0 8.0
0.06203475086431487 7.929661090815669 nan 8.0 8.0
0.06208916443455026 7.924267075637871 nan 8.0 8.0
0.06211152471754733 7.920319993556299 nan 8.0 8.0
0.062146523812323884 7.9038893259138145 nan 8.0 8.0
U dimensions = (906, 34)
Iteration 0 of 1
phi.shape: (10, 906)
U.shape: (906, 34)
phi.dot(U).T shape: (34, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799391.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799391_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799391_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799391_test_data.npy
Cleanup complete.

Simulation 1/10 score: 0.7147366362331503
Running repeat 2/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799443.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_280394_1741799443'
Loaded dataset: downsampled_1000genes_280394_1741799443
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.17757762870158544 5.83795873988629 1.0 8.0 8.0
0.08023212868232588 12.39145597845706 1.0 8.0 8.0
0.07954145089243814 12.09394454632244 1.0 8.0 8.0
0.07905491307030466 11.77707248347144 1.0 8.0 8.0
0.07889812614512615 11.372091214863811 1.0 8.0 8.0
0.07903177734538835 11.157977132697734 1.0 8.0 8.0
0.07916067238588853 11.112355056766004 1.0 8.0 8.0
0.07916475835006032 11.1080541255328 1.0 8.0 8.0
0.07922143437583118 11.06129444064249 1.0 8.0 8.0
0.07921679917075064 11.056375130251501 1.0 8.0 8.0
0.07922439861231245 11.053922693271254 1.0 8.0 8.0
0.07921710048568165 11.055804788780128 1.0 8.0 8.0
0.07921724310806666 11.05571088975937 1.0 8.0 8.0
0.0792172445186835 11.055709009459147 1.0 8.0 8.0
0.07921724467541158 11.055708872257766 1.0 8.0 8.0
0.07921724468019531 11.055708864380708 1.0 8.0 8.0
0.07921724468058444 11.055708863794903 1.0 8.0 8.0
0.07921724468060043 11.055708863754257 1.0 8.0 8.0
0.07921724468060176 11.055708863751203 1.0 8.0 8.0
0.0792172446806021 11.055708863750985 1.0 8.0 8.0
U dimensions = (906, 39)
Iteration 0 of 1
phi.shape: (10, 906)
U.shape: (906, 39)
phi.dot(U).T shape: (39, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799443.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799443_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799443_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799443_test_data.npy
Cleanup complete.

Simulation 2/10 score: 0.6655149015739625
Running repeat 3/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799495.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_280394_1741799495'
Loaded dataset: downsampled_1000genes_280394_1741799495
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.1792818666210455 5.377039864636862 1.0 8.0 8.0
0.08515627688628424 12.735903426833023 1.0 8.0 8.0
0.08423842753038113 12.56132143233033 1.0 8.0 8.0
0.0836496216471132 12.24513844803918 1.0 8.0 8.0
0.08310113122475415 12.11389138105694 1.0 8.0 8.0
0.08221983192397275 12.02070203098837 1.0 8.0 8.0
0.08149709681375927 11.860026158967832 1.0 8.0 8.0
0.08125978021070279 11.8161393129806 1.0 8.0 8.0
0.0811933317296496 11.754562650217679 1.0 8.0 8.0
0.08112170880214642 11.725350493345129 1.0 8.0 8.0
0.08106746900351036 11.724274986667796 1.0 8.0 8.0
0.08106835612399155 11.71536818875253 1.0 8.0 8.0
0.08105075770334291 11.720225419376018 1.0 8.0 8.0
0.08100754422721967 11.720702488997048 1.0 8.0 8.0
0.08098876941893618 11.718193024306432 1.0 8.0 8.0
0.0809699239689351 11.72064820516427 1.0 8.0 8.0
0.08094964929863124 11.721796576796317 1.0 8.0 8.0
0.08095367013595833 11.713218311030205 1.0 8.0 8.0
0.08092963367621564 11.718917921229517 1.0 8.0 8.0
0.08092016530807078 11.720430969490701 1.0 8.0 8.0
U dimensions = (906, 34)
Iteration 0 of 1
phi.shape: (10, 906)
U.shape: (906, 34)
phi.dot(U).T shape: (34, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799495.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799495_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799495_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799495_test_data.npy
Cleanup complete.

Simulation 3/10 score: 0.6523525837798794
Running repeat 4/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799550.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_280394_1741799550'
Loaded dataset: downsampled_1000genes_280394_1741799550
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.1577772901784773 5.21232236571568 1.0 8.0 8.0
0.08718116880705606 11.423399884616302 1.0 8.0 8.0
0.08501414156356646 11.25955342817355 1.0 8.0 8.0
0.08450389869762165 11.133760722601735 1.0 8.0 8.0
0.0843303281437604 11.04824674708162 1.0 8.0 8.0
0.08417911026456693 10.970598699993497 1.0 8.0 8.0
0.08406111248418424 10.902220340635935 1.0 8.0 8.0
0.08396783102688743 10.883837273732036 1.0 8.0 8.0
0.08396797933473532 10.852928286492352 1.0 8.0 8.0
0.08400054393259082 10.79524223456871 1.0 8.0 8.0
0.08394040680988069 10.723965313269785 1.0 8.0 8.0
0.0839157981534221 10.733730826904326 1.0 8.0 8.0
0.08393982669031286 10.688250309275402 1.0 8.0 8.0
0.08391523987964722 10.676684362933416 1.0 8.0 8.0
0.08388149690153301 10.66495879810459 1.0 8.0 8.0
0.08390894456161246 10.644076773674087 1.0 8.0 8.0
0.0839132687184787 10.645890978792604 1.0 8.0 8.0
0.08390616198464174 10.649390249522572 1.0 8.0 8.0
0.083917926381751 10.644894080984647 1.0 8.0 8.0
0.08403707922907433 10.616141705277272 1.0 8.0 8.0
U dimensions = (906, 38)
Iteration 0 of 1
phi.shape: (10, 906)
U.shape: (906, 38)
phi.dot(U).T shape: (38, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799550.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799550_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799550_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799550_test_data.npy
Cleanup complete.

Simulation 4/10 score: 0.6667547536141405
Running repeat 5/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799602.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_280394_1741799602'
Loaded dataset: downsampled_1000genes_280394_1741799602
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.19168754260463206 5.898317988384118 1.0 8.0 8.0
0.08635617789136574 14.782227834820207 1.0 8.0 8.0
0.0826363711721001 14.064295501514204 1.0 8.0 8.0
0.08176664326237026 13.74671105965168 1.0 8.0 8.0
0.08142637846007728 13.503106346998795 1.0 8.0 8.0
0.08137225619733823 13.334837545971206 1.0 8.0 8.0
0.08135390325373726 13.26311422855269 1.0 8.0 8.0
0.08130883005443335 13.243527910055949 1.0 8.0 8.0
0.08132460168978994 13.188566524786577 1.0 8.0 8.0
0.08144879590473153 13.15665492019299 1.0 8.0 8.0
0.08155215229612933 13.139893280956247 1.0 8.0 8.0
0.08161461181169671 13.119604839289119 1.0 8.0 8.0
0.08167070538387655 13.025494464460223 1.0 8.0 8.0
0.08166365109564044 13.017458137458886 1.0 8.0 8.0
0.08175441421631413 13.027542844975533 1.0 8.0 8.0
0.08181053946761452 13.006252291306833 1.0 8.0 8.0
0.08189410157850063 13.009510686152094 1.0 8.0 8.0
0.08195922417069879 12.987300480633316 1.0 8.0 8.0
0.08193602695030078 12.90990977360539 1.0 8.0 8.0
0.08193100334579018 12.913674904592765 1.0 8.0 8.0
U dimensions = (906, 37)
Iteration 0 of 1
phi.shape: (10, 906)
U.shape: (906, 37)
phi.dot(U).T shape: (37, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799602.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799602_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799602_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799602_test_data.npy
Cleanup complete.

Simulation 5/10 score: 0.645915518304917
Running repeat 6/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799651.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_280394_1741799651'
Loaded dataset: downsampled_1000genes_280394_1741799651
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.172950029103475 5.9672291688943515 1.0 8.0 8.0
0.08653846111862651 14.05396019906351 1.0 8.0 8.0
0.08377580610017987 12.921223953555009 1.0 8.0 8.0
0.08333363971880958 12.442734239635449 1.0 8.0 8.0
0.08293360491254065 12.519047864889522 1.0 8.0 8.0
0.08244877690764674 12.498294795243616 1.0 8.0 8.0
0.08212571363848686 12.54526522800878 1.0 8.0 8.0
0.08206914889881234 12.448004436713644 1.0 8.0 8.0
0.08208278010282577 12.381971617056996 1.0 8.0 8.0
0.08223029797536585 12.189932298665873 1.0 8.0 8.0
0.08228548246854828 12.13560616083638 1.0 8.0 8.0
0.08233401732735979 12.07073200246226 1.0 8.0 8.0
0.08236124849754445 11.935415470048138 1.0 8.0 8.0
0.08237622665700595 11.823488786311811 1.0 8.0 8.0
0.08238670711101737 11.822141465511839 1.0 8.0 8.0
0.08238640364724803 11.863020924359759 1.0 8.0 8.0
0.08236741875195819 11.894619944689431 1.0 8.0 8.0
0.0823564451377522 11.882483478920264 1.0 8.0 8.0
0.08236002006563092 11.875888955796801 1.0 8.0 8.0
0.08235666592915558 11.881211508288997 1.0 8.0 8.0
U dimensions = (906, 36)
Iteration 0 of 1
phi.shape: (10, 906)
U.shape: (906, 36)
phi.dot(U).T shape: (36, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799651.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799651_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799651_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799651_test_data.npy
Cleanup complete.

Simulation 6/10 score: 0.5994450564976908
Running repeat 7/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799705.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_280394_1741799705'
Loaded dataset: downsampled_1000genes_280394_1741799705
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.17698974472880236 5.781313968948801 1.0 8.0 8.0
0.08489439547639066 12.67413057947191 1.0 8.0 8.0
0.08340530542935665 12.157132438804481 1.0 8.0 8.0
0.08262387054342824 12.15799696728168 1.0 8.0 8.0
0.08219085940672688 12.177049714225745 1.0 8.0 8.0
0.08179312707514674 12.230636767192316 1.0 8.0 8.0
0.08147622614301697 12.252593757291281 1.0 8.0 8.0
0.08136367463763039 12.191159669280044 1.0 8.0 8.0
0.08120509151676236 12.19285680343013 1.0 8.0 8.0
0.08110620347167263 12.19141965064702 1.0 8.0 8.0
0.08103088945000214 12.207975957154169 1.0 8.0 8.0
0.08098354657429296 12.194113169055834 1.0 8.0 8.0
0.08092092890913516 12.185954015069298 1.0 8.0 8.0
0.08088848944388927 12.17217020100958 1.0 8.0 8.0
0.08085229911078218 12.173633132460933 1.0 8.0 8.0
0.08081229660265388 12.18474594920299 1.0 8.0 8.0
0.08080126189749959 12.182086751643757 1.0 8.0 8.0
0.08080653376759139 12.179060659199658 1.0 8.0 8.0
0.08080810931835603 12.17640771563908 1.0 8.0 8.0
0.08080355472058631 12.17644383356295 1.0 8.0 8.0
U dimensions = (906, 39)
Iteration 0 of 1
phi.shape: (10, 906)
U.shape: (906, 39)
phi.dot(U).T shape: (39, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799705.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799705_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799705_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799705_test_data.npy
Cleanup complete.

Simulation 7/10 score: 0.6430232054152649
Running repeat 8/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799758.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_280394_1741799758'
Loaded dataset: downsampled_1000genes_280394_1741799758
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.16766328344922088 5.190357971437183 1.0 8.0 8.0
0.08839865109604039 12.151783091055183 1.0 8.0 8.0
0.08500738104079675 11.912819119343649 1.0 8.0 8.0
0.0840150326471153 11.630415044924504 1.0 8.0 8.0
0.08371409478380087 11.620654247771693 1.0 8.0 8.0
0.08346162013762759 11.635010923459863 1.0 8.0 8.0
0.08334216978900533 11.444803913507547 1.0 8.0 8.0
0.08331313757860004 11.37333147610155 1.0 8.0 8.0
0.08314609482030422 11.374723345809285 1.0 8.0 8.0
0.08297996813694575 11.383562151510196 1.0 8.0 8.0
0.08283620653302115 11.299466364306388 1.0 8.0 8.0
0.08256540530081968 11.215792505129903 1.0 8.0 8.0
0.08240672665877047 11.145352926711356 1.0 8.0 8.0
0.08230180943725396 11.122018515662797 1.0 8.0 8.0
0.08221982392233218 11.10404239083657 1.0 8.0 8.0
0.08217460499994589 11.089159054774482 1.0 8.0 8.0
0.08207458745532004 11.085096024597087 1.0 8.0 8.0
0.08202906264951937 11.082859401639661 1.0 8.0 8.0
0.08200543728502896 11.08049299338828 1.0 8.0 8.0
0.081954574567916 11.096100983476356 1.0 8.0 8.0
U dimensions = (906, 37)
Iteration 0 of 1
phi.shape: (10, 906)
U.shape: (906, 37)
phi.dot(U).T shape: (37, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799758.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799758_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799758_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799758_test_data.npy
Cleanup complete.

Simulation 8/10 score: 0.5732413411738343
Running repeat 9/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799812.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_280394_1741799812'
Loaded dataset: downsampled_1000genes_280394_1741799812
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.16993559260705782 6.019953164177076 1.0 8.0 8.0
0.0843693201389919 12.596996229037225 1.0 8.0 8.0
0.08337710625917971 12.138145978365426 1.0 8.0 8.0
0.0825084378948312 11.987773882412156 1.0 8.0 8.0
0.08203387948577434 11.877422081413266 1.0 8.0 8.0
0.08159907020928214 11.78662573624999 1.0 8.0 8.0
0.08147224169007239 11.58120991168063 1.0 8.0 8.0
0.08129776824040957 11.556327921880497 1.0 8.0 8.0
0.08126033947559319 11.563017080811626 1.0 8.0 8.0
0.08125518200355308 11.559543624530413 1.0 8.0 8.0
0.0812493648162097 11.541848024958796 1.0 8.0 8.0
0.08129574532606842 11.530391706449803 1.0 8.0 8.0
0.08131803028873286 11.533299793368936 1.0 8.0 8.0
0.08134796706457281 11.514383628577884 1.0 8.0 8.0
0.08133505270838559 11.505029758434759 1.0 8.0 8.0
0.08132580495143682 11.498445252011727 1.0 8.0 8.0
0.0813255616331422 11.499024143761373 1.0 8.0 8.0
0.08132936534710622 11.496276682927972 1.0 8.0 8.0
0.08133173730089127 11.502880643683733 1.0 8.0 8.0
0.08133150113980991 11.501542709306866 1.0 8.0 8.0
U dimensions = (906, 35)
Iteration 0 of 1
phi.shape: (10, 906)
U.shape: (906, 35)
phi.dot(U).T shape: (35, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799812.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799812_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799812_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799812_test_data.npy
Cleanup complete.

Simulation 9/10 score: 0.6214682536838718
Running repeat 10/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799867.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_280394_1741799867'
Loaded dataset: downsampled_1000genes_280394_1741799867
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.1529019801118371 5.577871801709959 nan 8.0 8.0
0.08752401713245839 13.10519315162289 nan 8.0 8.0
0.08519246694891836 12.120599314364686 nan 8.0 8.0
0.08352851761016178 12.025389141296525 nan 8.0 8.0
0.08274534220835783 11.964436033538307 nan 8.0 8.0
0.08250329497714759 11.845904383809128 nan 8.0 8.0
0.08236834179141794 11.792820208121029 nan 8.0 8.0
0.08231006134741126 11.733477761537031 nan 8.0 8.0
0.08231564814487113 11.682971533567724 nan 8.0 8.0
0.08232276666509597 11.661014695590938 nan 8.0 8.0
0.08237955721045465 11.628412266383647 nan 8.0 8.0
0.08239962791327982 11.604203548568199 nan 8.0 8.0
0.08238342717266889 11.591278955218485 nan 8.0 8.0
0.08244313751146704 11.562761627914533 nan 8.0 8.0
0.08247726145361467 11.544698297818261 nan 8.0 8.0
0.08227549644982157 11.56995631938792 nan 8.0 8.0
0.08236466609137971 11.52313812125558 nan 8.0 8.0
0.08239599714897528 11.51844310076395 nan 8.0 8.0
0.08239934983388852 11.52039763284228 nan 8.0 8.0
0.08236746289157348 11.526322031112986 nan 8.0 8.0
U dimensions = (906, 37)
Iteration 0 of 1
phi.shape: (10, 906)
U.shape: (906, 37)
phi.dot(U).T shape: (37, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799867.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799867_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799867_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_280394_1741799867_test_data.npy
Cleanup complete.

Simulation 10/10 score: 0.656941910696289
Results saved: results/simulation/results_optimal.csv
Running simulation with: num_measurements=25, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=1000
Running repeat 1/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799593.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_118526_1741799593'
Loaded dataset: downsampled_1000genes_118526_1741799593
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.18938958976292974 4.856100954323943 1.0 8.0 8.0
0.08617010221863453 12.489788476027492 1.0 8.0 8.0
0.08384871693828166 11.989573174460723 1.0 8.0 8.0
0.08262639945404882 11.575172483060014 1.0 8.0 8.0
0.08220619360311321 11.336154280810492 1.0 8.0 8.0
0.08210544109216888 11.247425123135072 1.0 8.0 8.0
0.0820816460153897 11.080101730971446 1.0 8.0 8.0
0.08203774662764385 11.10017032553063 1.0 8.0 8.0
0.08198884651378802 11.107605634071007 1.0 8.0 8.0
0.08195515657174313 11.09686710408862 1.0 8.0 8.0
0.0819155714606995 11.090768285608124 1.0 8.0 8.0
0.08189687921940059 11.086400263997538 1.0 8.0 8.0
0.08187133291936166 11.085703926294832 1.0 8.0 8.0
0.08183613003475287 11.090845192409622 1.0 8.0 8.0
0.08182639463162 11.092553264830372 1.0 8.0 8.0
0.0818147844930579 11.093082570553905 1.0 8.0 8.0
0.08181218446737981 11.091666484532773 1.0 8.0 8.0
0.08181215546428844 11.09163348391596 1.0 8.0 8.0
0.08181215219813687 11.091508027460192 1.0 8.0 8.0
0.08181216407703651 11.091530184085904 1.0 8.0 8.0
U dimensions = (906, 36)
Iteration 0 of 1
phi.shape: (25, 906)
U.shape: (906, 36)
phi.dot(U).T shape: (36, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799593.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799593_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799593_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799593_test_data.npy
Cleanup complete.

Simulation 1/10 score: 0.6937528754733597
Running repeat 2/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799632.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_118526_1741799632'
Loaded dataset: downsampled_1000genes_118526_1741799632
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.16400876039580248 5.466291795043897 1.0 8.0 8.0
0.08648789605713181 11.549027183918747 1.0 8.0 8.0
0.08553998513906791 11.18250717600645 1.0 8.0 8.0
0.08500085802489399 11.31155279875658 1.0 8.0 8.0
0.08458685782886688 11.177173907637417 1.0 8.0 8.0
0.08418518318930479 11.100509226778925 1.0 8.0 8.0
0.08407878517895118 10.954245000396346 1.0 8.0 8.0
0.08407520619670772 10.811957302316564 1.0 8.0 8.0
0.08409011617414475 10.758923795029704 1.0 8.0 8.0
0.08415487926486853 10.679163502753847 1.0 8.0 8.0
0.08417316684451404 10.666161751513979 1.0 8.0 8.0
0.08420235328006775 10.655284596154747 1.0 8.0 8.0
0.08421640625974858 10.646231484332437 1.0 8.0 8.0
0.08426133913468858 10.6057960454753 1.0 8.0 8.0
0.0842951029072575 10.58305770683337 1.0 8.0 8.0
0.08429973563771698 10.580300605148954 1.0 8.0 8.0
0.08431468053703683 10.576905732002496 1.0 8.0 8.0
0.08431229491589654 10.57849724122692 1.0 8.0 8.0
0.08431920525543046 10.575639008512528 1.0 8.0 8.0
0.08428489884295476 10.581557509667599 1.0 8.0 8.0
U dimensions = (906, 38)
Iteration 0 of 1
phi.shape: (25, 906)
U.shape: (906, 38)
phi.dot(U).T shape: (38, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799632.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799632_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799632_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799632_test_data.npy
Cleanup complete.

Simulation 2/10 score: 0.4194067619269982
Running repeat 3/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799671.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_118526_1741799671'
Loaded dataset: downsampled_1000genes_118526_1741799671
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.1706042123476036 5.4438915174638325 1.0 8.0 8.0
0.08610531756461992 12.455008134809207 1.0 8.0 8.0
0.08290802188449664 12.732699743567823 1.0 8.0 8.0
0.08180759733588872 12.142471196019093 1.0 8.0 8.0
0.0813000621581974 12.156938642880988 1.0 8.0 8.0
0.08120820937697959 12.024818483603612 1.0 8.0 8.0
0.08112907231384392 11.96535681800328 1.0 8.0 8.0
0.08095633492501375 11.932521245749946 1.0 8.0 8.0
0.08067519616245611 11.855505182407846 1.0 8.0 8.0
0.08064863580480885 11.701547851609588 1.0 8.0 8.0
0.08067344329665571 11.664490725481295 1.0 8.0 8.0
0.08070682296385501 11.641624294712392 1.0 8.0 8.0
0.08073698854839195 11.614816897193831 1.0 8.0 8.0
0.08073569387388291 11.608129731173333 1.0 8.0 8.0
0.08073711758282587 11.598044447767267 1.0 8.0 8.0
0.08073691577986963 11.596450607471699 1.0 8.0 8.0
0.08073247419769869 11.592465092932141 1.0 8.0 8.0
0.08070414993462105 11.590402954909072 1.0 8.0 8.0
0.08063889471248742 11.606483865072914 1.0 8.0 8.0
0.08061628221289363 11.608708399927973 1.0 8.0 8.0
U dimensions = (906, 36)
Iteration 0 of 1
phi.shape: (25, 906)
U.shape: (906, 36)
phi.dot(U).T shape: (36, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799671.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799671_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799671_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799671_test_data.npy
Cleanup complete.

Simulation 3/10 score: 0.5239831227271067
Running repeat 4/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799711.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_118526_1741799711'
Loaded dataset: downsampled_1000genes_118526_1741799711
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.17917180769409968 5.532453963398095 nan 8.0 8.0
0.0846427214076868 12.780975883855396 nan 8.0 8.0
0.08318348060709124 12.250815622126495 nan 8.0 8.0
0.0827987343127452 11.99453974471697 nan 8.0 8.0
0.08275721167738681 11.960512085796134 nan 8.0 8.0
0.08268436473175378 11.920097700492839 nan 8.0 8.0
0.08270646327600217 11.90869936982994 nan 8.0 8.0
0.08250143847665004 12.058661845003261 nan 8.0 8.0
0.0824142643835355 12.118089477317865 nan 8.0 8.0
0.0823873786114031 12.116137128890426 nan 8.0 8.0
0.08238228543433879 12.11203558516185 nan 8.0 8.0
0.08239397617136224 12.123222099556198 nan 8.0 8.0
0.08242139182680808 12.114875545012627 nan 8.0 8.0
0.08236661531206269 12.122838096234348 nan 8.0 8.0
0.08235019785125874 12.122344666214083 nan 8.0 8.0
0.08234745483993888 12.122266595585279 nan 8.0 8.0
0.08234737511766088 12.122289262790183 nan 8.0 8.0
0.08234737400154046 12.122289797503406 nan 8.0 8.0
0.08234737399162084 12.122289813229125 nan 8.0 8.0
0.08234737399234437 12.122289813441393 nan 8.0 8.0
U dimensions = (906, 36)
Iteration 0 of 1
phi.shape: (25, 906)
U.shape: (906, 36)
phi.dot(U).T shape: (36, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799711.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799711_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799711_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799711_test_data.npy
Cleanup complete.

Simulation 4/10 score: 0.7206454389764384
Running repeat 5/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799750.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_118526_1741799750'
Loaded dataset: downsampled_1000genes_118526_1741799750
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.181587328129164 5.490398637863132 1.0 8.0 8.0
0.08824122943344981 13.309064736154273 1.0 8.0 8.0
0.08579322012336221 12.635250659779526 1.0 8.0 8.0
0.08446348780578083 12.23844687399145 1.0 8.0 8.0
0.08392691915632156 12.193786794443795 1.0 8.0 8.0
0.08335690719795807 12.073342862816897 1.0 8.0 8.0
0.08305763052011339 12.064512213177451 1.0 8.0 8.0
0.08292379930019478 11.974531351268654 1.0 8.0 8.0
0.08284112287677636 11.966897319265728 1.0 8.0 8.0
0.08275673125514649 11.974263951238763 1.0 8.0 8.0
0.08269003684438558 11.968674403809874 1.0 8.0 8.0
0.08264779465451644 11.969226649255814 1.0 8.0 8.0
0.08261418800343268 11.970135555760468 1.0 8.0 8.0
0.08258962609631859 11.972248690846012 1.0 8.0 8.0
0.08257589647690966 11.975952310746283 1.0 8.0 8.0
0.08256807206696726 11.976940672028258 1.0 8.0 8.0
0.08256813554705256 11.976945319861418 1.0 8.0 8.0
0.08256811912965689 11.97694187680176 1.0 8.0 8.0
0.08256811640380612 11.976948825543321 1.0 8.0 8.0
0.08256811636977657 11.976949027441654 1.0 8.0 8.0
U dimensions = (906, 35)
Iteration 0 of 1
phi.shape: (25, 906)
U.shape: (906, 35)
phi.dot(U).T shape: (35, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799750.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799750_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799750_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799750_test_data.npy
Cleanup complete.

Simulation 5/10 score: 0.6648120665182102
Running repeat 6/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799788.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_118526_1741799788'
Loaded dataset: downsampled_1000genes_118526_1741799788
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.16167297357151966 5.013772534970471 1.0 8.0 8.0
0.07902517258147213 11.299642769488 1.0 8.0 8.0
0.07746977504644237 10.917325564848742 1.0 8.0 8.0
0.07664912312564098 10.560690585672242 1.0 8.0 8.0
0.07640745365670598 10.49257937013605 1.0 8.0 8.0
0.07631350816726612 10.516953147587625 1.0 8.0 8.0
0.07627292486226078 10.615045596284297 1.0 8.0 8.0
0.07621115119687616 10.657655620833358 1.0 8.0 8.0
0.07618458869352818 10.65790125869642 1.0 8.0 8.0
0.07615292674625884 10.651445629867442 1.0 8.0 8.0
0.0760973642202708 10.66017114977695 1.0 8.0 8.0
0.07608730987373857 10.653133972573587 1.0 8.0 8.0
0.07609855393116127 10.646823791585392 1.0 8.0 8.0
0.07611432611995683 10.642594018810913 1.0 8.0 8.0
0.07612345977755763 10.651285398143889 1.0 8.0 8.0
0.07612203185056099 10.656652340953578 1.0 8.0 8.0
0.07611607862212877 10.649171777355626 1.0 8.0 8.0
0.07612446550837748 10.639524879205213 1.0 8.0 8.0
0.07612838049659809 10.635447496488036 1.0 8.0 8.0
0.07612837463311861 10.635461093600966 1.0 8.0 8.0
U dimensions = (906, 35)
Iteration 0 of 1
phi.shape: (25, 906)
U.shape: (906, 35)
phi.dot(U).T shape: (35, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799788.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799788_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799788_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799788_test_data.npy
Cleanup complete.

Simulation 6/10 score: 0.5904826534578894
Running repeat 7/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799827.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_118526_1741799827'
Loaded dataset: downsampled_1000genes_118526_1741799827
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.17465359826252091 5.263450730179105 1.0 8.0 8.0
0.08511887380136796 12.091030955225449 1.0 8.0 8.0
0.08392155345575769 11.40167591471138 1.0 8.0 8.0
0.08322406047854491 11.156136492540513 1.0 8.0 8.0
0.08282053850703042 11.269085880013739 1.0 8.0 8.0
0.08237119162510231 11.386711813538207 1.0 8.0 8.0
0.08198892593756169 11.290865057254917 1.0 8.0 8.0
0.08187639258519774 11.213297119478943 1.0 8.0 8.0
0.08180591355476685 11.112864013828124 1.0 8.0 8.0
0.08173432737963782 11.042776983357086 1.0 8.0 8.0
0.0815596855788121 11.020460455000435 1.0 8.0 8.0
0.08153046522897567 10.975570354920075 1.0 8.0 8.0
0.08145067740092371 10.993678781689397 1.0 8.0 8.0
0.08136165259628869 11.006793845098281 1.0 8.0 8.0
0.0813177043358313 11.01653254556635 1.0 8.0 8.0
0.08131016710797534 11.018593052446574 1.0 8.0 8.0
0.08131914923460348 11.036192588861667 1.0 8.0 8.0
0.08133540733117262 11.040456182141954 1.0 8.0 8.0
0.08133843226365944 11.043910704181071 1.0 8.0 8.0
0.0813271623077153 11.0645800875862 1.0 8.0 8.0
U dimensions = (906, 38)
Iteration 0 of 1
phi.shape: (25, 906)
U.shape: (906, 38)
phi.dot(U).T shape: (38, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799827.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799827_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799827_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799827_test_data.npy
Cleanup complete.

Simulation 7/10 score: 0.7183434988480156
Running repeat 8/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799870.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_118526_1741799870'
Loaded dataset: downsampled_1000genes_118526_1741799870
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.1905214383934598 4.9886715976241085 1.0 8.0 8.0
0.0811198786828704 12.134248243453953 1.0 8.0 8.0
0.07987522902633692 11.825663462292324 1.0 8.0 8.0
0.07885433062811109 11.296299044090834 1.0 8.0 8.0
0.07842174447797479 10.977491888958514 1.0 8.0 8.0
0.07836092771876058 10.929044248251179 1.0 8.0 8.0
0.07845619939391513 10.8713992720367 1.0 8.0 8.0
0.0784947937228575 10.851301333122134 1.0 8.0 8.0
0.07853026641846528 10.847756938659321 1.0 8.0 8.0
0.07850041014582665 10.855275840770034 1.0 8.0 8.0
0.07849346353940712 10.862916364707054 1.0 8.0 8.0
0.07849936343330477 10.85664262763759 1.0 8.0 8.0
0.0784858476711987 10.852585747434038 1.0 8.0 8.0
0.0784833796500134 10.855817827945504 1.0 8.0 8.0
0.07849776782790885 10.853251238594325 1.0 8.0 8.0
0.07851736795110187 10.844956182487817 1.0 8.0 8.0
0.07852106183434338 10.837235434119002 1.0 8.0 8.0
0.07848661342150498 10.846163304597475 1.0 8.0 8.0
0.07844490997518738 10.85312165018952 1.0 8.0 8.0
0.07843048450041834 10.856279886945128 1.0 8.0 8.0
U dimensions = (906, 32)
Iteration 0 of 1
phi.shape: (25, 906)
U.shape: (906, 32)
phi.dot(U).T shape: (32, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799870.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799870_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799870_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799870_test_data.npy
Cleanup complete.

Simulation 8/10 score: 0.6982636157307148
Running repeat 9/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799909.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_118526_1741799909'
Loaded dataset: downsampled_1000genes_118526_1741799909
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.16519884070915747 5.206539708009435 1.0 8.0 8.0
0.09119178052090438 11.65277847525574 1.0 8.0 8.0
0.08729401358284972 11.80387246267204 1.0 8.0 8.0
0.08514722424164389 11.484510177245072 1.0 8.0 8.0
0.08408557836260899 11.665146632425131 1.0 8.0 8.0
0.08361719987804928 11.70402754836212 1.0 8.0 8.0
0.08341223752343685 11.56044468033093 1.0 8.0 8.0
0.08327120349095662 11.566854150564229 1.0 8.0 8.0
0.08315943340844922 11.553881080916842 1.0 8.0 8.0
0.08310023864386462 11.499001578206824 1.0 8.0 8.0
0.08305774689874712 11.445478416659366 1.0 8.0 8.0
0.08306232818905612 11.413054214847396 1.0 8.0 8.0
0.0830669756398037 11.380175212627325 1.0 8.0 8.0
0.08301798664558857 11.366053505349983 1.0 8.0 8.0
0.08290887312868611 11.366967510127711 1.0 8.0 8.0
0.08288942687109258 11.371093142234052 1.0 8.0 8.0
0.08290830040398467 11.370940810508383 1.0 8.0 8.0
0.08292928248131026 11.369295832983754 1.0 8.0 8.0
0.08291768960499246 11.370788034815947 1.0 8.0 8.0
0.08295137369364591 11.368991976056572 1.0 8.0 8.0
U dimensions = (906, 37)
Iteration 0 of 1
phi.shape: (25, 906)
U.shape: (906, 37)
phi.dot(U).T shape: (37, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799909.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799909_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799909_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799909_test_data.npy
Cleanup complete.

Simulation 9/10 score: 0.6992983350401426
Running repeat 10/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799946.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_118526_1741799946'
Loaded dataset: downsampled_1000genes_118526_1741799946
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.14941362712843964 4.740097163634281 nan 8.0 8.0
0.07432713671020652 11.282468963922243 nan 8.0 8.0
0.07337728613156203 10.811171823415673 nan 8.0 8.0
0.07255606155976935 10.74386592897479 nan 8.0 8.0
0.07246353329221356 10.437030628506205 nan 8.0 8.0
0.0723724568499382 10.315545254714781 nan 8.0 8.0
0.07233209595624523 10.221076737586461 nan 8.0 8.0
0.07227254677719541 10.173785435927988 nan 8.0 8.0
0.07222856796082822 10.191915242409674 nan 8.0 8.0
0.07229027274156719 10.129521530272052 nan 8.0 8.0
0.07228106985516491 10.100945944493239 nan 8.0 8.0
0.07227010250110777 10.10787203017473 nan 8.0 8.0
0.07224751064180113 10.108070672666711 nan 8.0 8.0
0.07224475614107062 10.111056188589874 nan 8.0 8.0
0.07224449712357284 10.110576745353859 nan 8.0 8.0
0.07224791241365403 10.107432263007658 nan 8.0 8.0
0.07224463855934649 10.105560571832324 nan 8.0 8.0
0.07224402072797387 10.104072110379422 nan 8.0 8.0
0.07224867565474002 10.102701637028868 nan 8.0 8.0
0.07225355137668477 10.100782308619689 nan 8.0 8.0
U dimensions = (906, 35)
Iteration 0 of 1
phi.shape: (25, 906)
U.shape: (906, 35)
phi.dot(U).T shape: (35, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799946.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799946_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799946_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_118526_1741799946_test_data.npy
Cleanup complete.

Simulation 10/10 score: 0.5322429812816373
Results saved: results/simulation/results_optimal.csv
Running simulation with: num_measurements=25, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=500
Running repeat 1/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799596.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_1803571_1741799596'
Loaded dataset: downsampled_500genes_1803571_1741799596
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.1920205722053009 2.8997079477247283 nan 8.0 8.0
0.06872005733700115 11.17512565249265 nan 8.0 8.0
0.06659184121574668 11.003970847725162 nan 8.0 8.0
0.06573942607161432 10.934690961265632 nan 8.0 8.0
0.0651523580867015 10.894086613852643 nan 8.0 8.0
0.064728897921289 10.833197105388471 nan 8.0 8.0
0.06446586617639016 10.826065234945155 nan 8.0 8.0
0.06425794141131891 10.862480031218208 nan 8.0 8.0
0.06399496741938215 10.897942524302001 nan 8.0 8.0
0.06373064075749568 10.893459395561523 nan 8.0 8.0
0.06340293923569096 10.912824349218788 nan 8.0 8.0
0.06320716456421749 10.889327049411278 nan 8.0 8.0
0.06304844180633373 10.904937693383875 nan 8.0 8.0
0.06296940134013773 10.902187554570114 nan 8.0 8.0
0.06288003014386445 10.908349131398747 nan 8.0 8.0
0.06279436150175566 10.906319548355373 nan 8.0 8.0
0.06272120039139661 10.91831671543278 nan 8.0 8.0
0.06266052474548567 10.936715579430993 nan 8.0 8.0
0.06261503770428456 10.943188321688258 nan 8.0 8.0
0.06259038300539765 10.945073785833348 nan 8.0 8.0
U dimensions = (477, 32)
Iteration 0 of 1
phi.shape: (25, 477)
U.shape: (477, 32)
phi.dot(U).T shape: (32, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799596.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799596_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799596_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799596_test_data.npy
Cleanup complete.

Simulation 1/10 score: 0.6323179707381573
Running repeat 2/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799640.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_1803571_1741799640'
Loaded dataset: downsampled_500genes_1803571_1741799640
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.1787742011473118 3.027416276115497 nan 8.0 8.0
0.06639644403856826 10.873453912373021 nan 8.0 8.0
0.06309054006913839 11.042299446575496 nan 8.0 8.0
0.06119642214168464 11.210635534303766 nan 8.0 8.0
0.06024002339525747 11.252463725262704 nan 8.0 8.0
0.05957754863860576 11.250808732803904 nan 8.0 8.0
0.059257957648166215 11.211104038914359 nan 8.0 8.0
0.05896609760373839 11.219646943890908 nan 8.0 8.0
0.05855369693604462 11.209785727389551 nan 8.0 8.0
0.05835491367822343 11.208187637331214 nan 8.0 8.0
0.05826645103567196 11.21204267294518 nan 8.0 8.0
0.05819402436695753 11.222441188492985 nan 8.0 8.0
0.05812425615701844 11.237448051418777 nan 8.0 8.0
0.058092102072548446 11.24886658222583 nan 8.0 8.0
0.05808124799269476 11.251375254368458 nan 8.0 8.0
0.05806156562873521 11.256381115165343 nan 8.0 8.0
0.05804819918367121 11.25148888107043 nan 8.0 8.0
0.058033628121990866 11.249173427247536 nan 8.0 8.0
0.058023685700567706 11.249782703718367 nan 8.0 8.0
0.05801984162429741 11.24410435470703 nan 8.0 8.0
U dimensions = (477, 33)
Iteration 0 of 1
phi.shape: (25, 477)
U.shape: (477, 33)
phi.dot(U).T shape: (33, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799640.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799640_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799640_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799640_test_data.npy
Cleanup complete.

Simulation 2/10 score: 0.6829956334193826
Running repeat 3/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799682.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_1803571_1741799682'
Loaded dataset: downsampled_500genes_1803571_1741799682
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.18129006785794055 3.281281886158283 nan 8.0 8.0
0.06694055970303248 11.580931873560653 nan 8.0 8.0
0.06313296420979186 11.489835628404494 nan 8.0 8.0
0.06108446114486821 11.431211671378986 nan 8.0 8.0
0.06022197284310993 11.310796173830086 nan 8.0 8.0
0.05966529055892322 11.298833996615821 nan 8.0 8.0
0.059219471810686874 11.303433277529109 nan 8.0 8.0
0.05898388514188846 11.321468927895989 nan 8.0 8.0
0.05878588972454357 11.351098385298203 nan 8.0 8.0
0.05866586402815133 11.446105363682236 nan 8.0 8.0
0.0585890443642656 11.416095285947446 nan 8.0 8.0
0.05852413847025262 11.448556181799837 nan 8.0 8.0
0.05829201798614714 11.519965926869288 nan 8.0 8.0
0.05801155491726151 11.670866745562366 nan 8.0 8.0
0.05793846408894088 11.678192875117587 nan 8.0 8.0
0.057903681258013484 11.686882755877555 nan 8.0 8.0
0.05787756215511397 11.668741317448202 nan 8.0 8.0
0.05783797390907264 11.675871749343093 nan 8.0 8.0
0.05782627925902328 11.66738432115874 nan 8.0 8.0
0.05780594081572288 11.655320619576091 nan 8.0 8.0
U dimensions = (477, 35)
Iteration 0 of 1
phi.shape: (25, 477)
U.shape: (477, 35)
phi.dot(U).T shape: (35, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799682.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799682_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799682_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799682_test_data.npy
Cleanup complete.

Simulation 3/10 score: 0.5910749155632585
Running repeat 4/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799729.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_1803571_1741799729'
Loaded dataset: downsampled_500genes_1803571_1741799729
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.1943310988809156 3.0759255172432645 nan 8.0 8.0
0.0701672691910844 11.663493334589417 nan 8.0 8.0
0.06763034892466269 11.265709835795613 nan 8.0 8.0
0.06614152857875322 11.4012868619624 nan 8.0 8.0
0.06493237109144256 11.433877356959924 nan 8.0 8.0
0.06392201160805988 11.572658376205528 nan 8.0 8.0
0.06344414135194465 11.583627655914675 nan 8.0 8.0
0.06321601772063534 11.594087824650348 nan 8.0 8.0
0.06300116402880984 11.618316883010902 nan 8.0 8.0
0.06282693558099006 11.644850240644672 nan 8.0 8.0
0.06261159957776274 11.659274719365289 nan 8.0 8.0
0.06244147940461919 11.636789926490222 nan 8.0 8.0
0.062335949434137894 11.643295650201493 nan 8.0 8.0
0.06224898151791647 11.573153478597174 nan 8.0 8.0
0.06218810117897977 11.58389179769579 nan 8.0 8.0
0.06208725619113875 11.61468569156122 nan 8.0 8.0
0.061685518205202405 11.65347121985616 nan 8.0 8.0
0.06157693263352382 11.731028626652053 nan 8.0 8.0
0.0615575647428771 11.7345787301837 nan 8.0 8.0
0.06150308270370752 11.743440183248115 nan 8.0 8.0
U dimensions = (477, 33)
Iteration 0 of 1
phi.shape: (25, 477)
U.shape: (477, 33)
phi.dot(U).T shape: (33, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799729.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799729_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799729_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799729_test_data.npy
Cleanup complete.

Simulation 4/10 score: 0.6727401905913243
Running repeat 5/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799772.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_1803571_1741799772'
Loaded dataset: downsampled_500genes_1803571_1741799772
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.16375880820610678 2.9376429826424526 nan 8.0 8.0
0.07101738887773867 10.267272911672864 nan 8.0 8.0
0.06870886590152492 10.275574645168957 nan 8.0 8.0
0.06665488424646826 10.476955882888564 nan 8.0 8.0
0.0649513689154102 10.632134475064493 nan 8.0 8.0
0.0633599147646674 10.7879085249341 nan 8.0 8.0
0.0624159531924845 10.713926175235564 nan 8.0 8.0
0.06154788553474588 10.837129016835528 nan 8.0 8.0
0.06111151208820287 10.859231798632297 nan 8.0 8.0
0.06090419429205163 10.881607612469129 nan 8.0 8.0
0.06074557541278214 10.891301542387662 nan 8.0 8.0
0.06064489921016081 10.90491728001203 nan 8.0 8.0
0.0605673393937447 10.916137244408818 nan 8.0 8.0
0.06049042326083409 10.898878980926721 nan 8.0 8.0
0.06044175839805799 10.872498090485673 nan 8.0 8.0
0.06040838418138128 10.86980375483467 nan 8.0 8.0
0.06037193544285446 10.873482490835698 nan 8.0 8.0
0.06036120121402988 10.871314824116725 nan 8.0 8.0
0.06035841766386896 10.869380318993539 nan 8.0 8.0
0.06035621968488758 10.869633966159602 nan 8.0 8.0
U dimensions = (477, 30)
Iteration 0 of 1
phi.shape: (25, 477)
U.shape: (477, 30)
phi.dot(U).T shape: (30, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799772.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799772_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799772_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799772_test_data.npy
Cleanup complete.

Simulation 5/10 score: 0.7009155462348582
Running repeat 6/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799819.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_1803571_1741799819'
Loaded dataset: downsampled_500genes_1803571_1741799819
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.20049338508757986 2.9155956760520674 nan 8.0 8.0
0.06893745038235777 10.983443167955425 nan 8.0 8.0
0.0653105300890644 11.076661025484137 nan 8.0 8.0
0.0631635005408222 11.463849872785428 nan 8.0 8.0
0.06198782866458041 11.645613672142668 nan 8.0 8.0
0.061346031339437834 11.612483237496349 nan 8.0 8.0
0.06093910824782989 11.619061680731454 nan 8.0 8.0
0.06069142920738635 11.614928432190467 nan 8.0 8.0
0.060522388269683924 11.614148362791681 nan 8.0 8.0
0.060381643316146816 11.648005859255987 nan 8.0 8.0
0.060297027223855104 11.616621809350784 nan 8.0 8.0
0.06021598919643267 11.607062788388163 nan 8.0 8.0
0.060182977710362184 11.604931037890237 nan 8.0 8.0
0.06015534758004648 11.612831457574861 nan 8.0 8.0
0.06013627772544161 11.61400470193529 nan 8.0 8.0
0.060124306467615685 11.616181725617636 nan 8.0 8.0
0.06011199269525913 11.620986467044936 nan 8.0 8.0
0.0601076941731602 11.623139053078049 nan 8.0 8.0
0.060094280151909096 11.625127064894302 nan 8.0 8.0
0.06008566479803212 11.628282294257097 nan 8.0 8.0
U dimensions = (477, 34)
Iteration 0 of 1
phi.shape: (25, 477)
U.shape: (477, 34)
phi.dot(U).T shape: (34, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799819.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799819_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799819_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799819_test_data.npy
Cleanup complete.

Simulation 6/10 score: 0.6794821801259417
Running repeat 7/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799867.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_1803571_1741799867'
Loaded dataset: downsampled_500genes_1803571_1741799867
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.18216327428739232 2.943088517293565 nan 8.0 8.0
0.06856302629812461 10.779567528253379 nan 8.0 8.0
0.0659671132290065 10.819435195097391 nan 8.0 8.0
0.0644750847191723 10.663253885129446 nan 8.0 8.0
0.06388947155675873 10.826134382301378 nan 8.0 8.0
0.06354110137438396 10.901105393411687 nan 8.0 8.0
0.06320057051317085 10.936545834367372 nan 8.0 8.0
0.06288799305949411 10.980179728908645 nan 8.0 8.0
0.06255020254433574 11.092981612881282 nan 8.0 8.0
0.06221524559276159 11.122396416320516 nan 8.0 8.0
0.06199168621671913 11.116835475552703 nan 8.0 8.0
0.061837708525811164 11.120553800614488 nan 8.0 8.0
0.0616472602442838 11.143091563153247 nan 8.0 8.0
0.061561126864193905 11.136392581984648 nan 8.0 8.0
0.06149963111181678 11.133720449812992 nan 8.0 8.0
0.06145342278427701 11.127402739322328 nan 8.0 8.0
0.06140669015872002 11.118449165945085 nan 8.0 8.0
0.06135880662124471 11.122312130576361 nan 8.0 8.0
0.0613045715511803 11.115827950894174 nan 8.0 8.0
0.061264524862680636 11.113380421558906 nan 8.0 8.0
U dimensions = (477, 33)
Iteration 0 of 1
phi.shape: (25, 477)
U.shape: (477, 33)
phi.dot(U).T shape: (33, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799867.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799867_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799867_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799867_test_data.npy
Cleanup complete.

Simulation 7/10 score: 0.6889445728244371
Running repeat 8/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799919.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_1803571_1741799919'
Loaded dataset: downsampled_500genes_1803571_1741799919
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.19354095088425316 2.9383501133124135 nan 8.0 8.0
0.06703126404842774 10.57038641387614 nan 8.0 8.0
0.06537998732849926 10.667701680791106 nan 8.0 8.0
0.06405993180824576 10.811321990577715 nan 8.0 8.0
0.06285836471075212 11.125317143053524 nan 8.0 8.0
0.061857670807515364 11.14947398160999 nan 8.0 8.0
0.06127332187269052 11.149223596302106 nan 8.0 8.0
0.06091972617380903 11.140750869524766 nan 8.0 8.0
0.06067997277777837 11.153753768300097 nan 8.0 8.0
0.06046702170989271 11.148627832903063 nan 8.0 8.0
0.06034733647160351 11.13736453088739 nan 8.0 8.0
0.06028949441903597 11.11359382347592 nan 8.0 8.0
0.0602763244299761 11.101596276589259 nan 8.0 8.0
0.06023827394835335 11.079562871708397 nan 8.0 8.0
0.06020748286097988 11.075244057770172 nan 8.0 8.0
0.060151198666682726 11.062670245441746 nan 8.0 8.0
0.06009939884377424 11.047019831220087 nan 8.0 8.0
0.06006875636942588 11.034338488329047 nan 8.0 8.0
0.06004453746672711 11.037722781970285 nan 8.0 8.0
0.06003494771809437 11.039161744525389 nan 8.0 8.0
U dimensions = (477, 30)
Iteration 0 of 1
phi.shape: (25, 477)
U.shape: (477, 30)
phi.dot(U).T shape: (30, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799919.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799919_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799919_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799919_test_data.npy
Cleanup complete.

Simulation 8/10 score: 0.6699011847159301
Running repeat 9/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799965.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_1803571_1741799965'
Loaded dataset: downsampled_500genes_1803571_1741799965
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.1873672766437312 2.9932325278914726 nan 8.0 8.0
0.06703947968041024 11.08810736080021 nan 8.0 8.0
0.06368337337260266 11.005314505985075 nan 8.0 8.0
0.0623428717116189 11.128360633093187 nan 8.0 8.0
0.061580813795798495 11.212100996159176 nan 8.0 8.0
0.06105209723269611 11.271392956062154 nan 8.0 8.0
0.060750240007726664 11.283245553638327 nan 8.0 8.0
0.06056227415821591 11.319407259417424 nan 8.0 8.0
0.060420372510287534 11.331090506750602 nan 8.0 8.0
0.06030053487321363 11.373901554517362 nan 8.0 8.0
0.06020430867126281 11.4431361381327 nan 8.0 8.0
0.06012387174567846 11.474774745185599 nan 8.0 8.0
0.060070830692050436 11.476360908562999 nan 8.0 8.0
0.06003873798870141 11.492693950411969 nan 8.0 8.0
0.05999237177978611 11.518294597601964 nan 8.0 8.0
0.0599015322403702 11.54635105238343 nan 8.0 8.0
0.05979389638294119 11.557472620452678 nan 8.0 8.0
0.05972270234317356 11.554906977683356 nan 8.0 8.0
0.05969454303117394 11.583248170404511 nan 8.0 8.0
0.0596927075778072 11.587270730716922 nan 8.0 8.0
U dimensions = (477, 33)
Iteration 0 of 1
phi.shape: (25, 477)
U.shape: (477, 33)
phi.dot(U).T shape: (33, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799965.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799965_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799965_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741799965_test_data.npy
Cleanup complete.

Simulation 9/10 score: 0.6293109101135551
Running repeat 10/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741800014.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_1803571_1741800014'
Loaded dataset: downsampled_500genes_1803571_1741800014
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.186220072162541 2.846299338876547 nan 8.0 8.0
0.06939057455179809 11.309173898400495 nan 8.0 8.0
0.06502450441950602 11.134284576947302 nan 8.0 8.0
0.06372359596242272 11.096790956538436 nan 8.0 8.0
0.0631146994236329 11.106044083160976 nan 8.0 8.0
0.06273296717321952 11.11515763512886 nan 8.0 8.0
0.06249978364381492 11.112095896632216 nan 8.0 8.0
0.062291519741015766 11.096574663501391 nan 8.0 8.0
0.06208172108958809 11.084952013843449 nan 8.0 8.0
0.06189481457856383 11.165196032309028 nan 8.0 8.0
0.06173064302426601 11.219995365165811 nan 8.0 8.0
0.06156802521452387 11.23161233410772 nan 8.0 8.0
0.06137808688567947 11.258542038243911 nan 8.0 8.0
0.061255452987116765 11.252148255362435 nan 8.0 8.0
0.06117401768200237 11.25222975716608 nan 8.0 8.0
0.061095884311411 11.258514882497249 nan 8.0 8.0
0.06105123159802406 11.265953181278327 nan 8.0 8.0
0.06103210406603399 11.270753254768431 nan 8.0 8.0
0.061006191088248896 11.27652182067059 nan 8.0 8.0
0.06098062504333113 11.285443461920398 nan 8.0 8.0
U dimensions = (477, 31)
Iteration 0 of 1
phi.shape: (25, 477)
U.shape: (477, 31)
phi.dot(U).T shape: (31, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741800014.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741800014_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741800014_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_1803571_1741800014_test_data.npy
Cleanup complete.

Simulation 10/10 score: 0.584382941650064
Results saved: results/simulation/results_optimal.csv
Running simulation with: num_measurements=50, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=500
Running repeat 1/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741799962.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_118538_1741799962'
Loaded dataset: downsampled_500genes_118538_1741799962
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.21124344841242204 2.8978209268994113 nan 8.0 8.0
0.06943185250919715 11.569386728051162 nan 8.0 8.0
0.06766721026410716 11.4438922417763 nan 8.0 8.0
0.06676570104395241 11.431724571122196 nan 8.0 8.0
0.06624338806015195 11.421219058379775 nan 8.0 8.0
0.06543767140189471 11.542579378341175 nan 8.0 8.0
0.06469781692844068 11.775696861854298 nan 8.0 8.0
0.0641661305480048 11.944396090564812 nan 8.0 8.0
0.06381202877775105 11.999078357673543 nan 8.0 8.0
0.06350325895573927 12.0230923194753 nan 8.0 8.0
0.06321222735843546 12.024105772373728 nan 8.0 8.0
0.06293102897243152 12.03295638339017 nan 8.0 8.0
0.06270907764882139 12.033419807612248 nan 8.0 8.0
0.06257609594492042 12.03819611539878 nan 8.0 8.0
0.062419377445906754 12.039151674124057 nan 8.0 8.0
0.062279840975553835 12.018372693651646 nan 8.0 8.0
0.062197060801478354 11.984657327427062 nan 8.0 8.0
0.06213293066562087 11.965767501017497 nan 8.0 8.0
0.062059561300987665 11.983022186555797 nan 8.0 8.0
0.06201049501502687 11.986082126405796 nan 8.0 8.0
U dimensions = (477, 29)
Iteration 0 of 1
phi.shape: (50, 477)
U.shape: (477, 29)
phi.dot(U).T shape: (29, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741799962.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741799962_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741799962_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741799962_test_data.npy
Cleanup complete.

Simulation 1/10 score: 0.8082293313928378
Running repeat 2/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741799999.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_118538_1741799999'
Loaded dataset: downsampled_500genes_118538_1741799999
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.17955185752080527 3.2720276166139852 nan 8.0 8.0
0.06718429632907252 11.191626607549537 nan 8.0 8.0
0.06467974889541805 10.849006755505041 nan 8.0 8.0
0.06332090187311057 10.904829165458594 nan 8.0 8.0
0.06262845493305591 10.948770795797486 nan 8.0 8.0
0.06213890412340728 10.945315073738534 nan 8.0 8.0
0.0618292995834927 10.933737560307943 nan 8.0 8.0
0.061685557912438016 10.932694605230331 nan 8.0 8.0
0.06159009135225468 10.935906089141955 nan 8.0 8.0
0.061449014154175474 10.933129446380882 nan 8.0 8.0
0.06137839119138444 10.919318678931528 nan 8.0 8.0
0.06129653932796797 10.906563707974634 nan 8.0 8.0
0.0612270619028209 10.92208529863087 nan 8.0 8.0
0.06116627158857124 10.930807404351945 nan 8.0 8.0
0.06110656359902489 10.940790430821504 nan 8.0 8.0
0.061048356932771775 10.942066354788288 nan 8.0 8.0
0.06100248450464463 10.944928566978234 nan 8.0 8.0
0.06095273572571924 10.951674892356056 nan 8.0 8.0
0.06091627543279243 10.954677041337076 nan 8.0 8.0
0.060894438984328225 10.949111506225224 nan 8.0 8.0
U dimensions = (477, 32)
Iteration 0 of 1
phi.shape: (50, 477)
U.shape: (477, 32)
phi.dot(U).T shape: (32, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741799999.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741799999_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741799999_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741799999_test_data.npy
Cleanup complete.

Simulation 2/10 score: 0.8305086846374413
Running repeat 3/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800051.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_118538_1741800051'
Loaded dataset: downsampled_500genes_118538_1741800051
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.21178528174019595 2.9255398558618166 nan 8.0 8.0
0.06968423669454149 11.678878542654935 nan 8.0 8.0
0.0659540318228935 11.247256651981438 nan 8.0 8.0
0.06443165489220337 11.144609558486039 nan 8.0 8.0
0.06316014029544237 11.244181164508449 nan 8.0 8.0
0.06264641406281779 11.310229185160143 nan 8.0 8.0
0.06242444439146633 11.324529276665185 nan 8.0 8.0
0.06220956397858568 11.322688492008734 nan 8.0 8.0
0.06194821995335131 11.355043931720704 nan 8.0 8.0
0.06167762236799701 11.387441821134463 nan 8.0 8.0
0.06145204054080167 11.416812320807027 nan 8.0 8.0
0.061275949390565354 11.421131131352857 nan 8.0 8.0
0.06114467263787293 11.416298130592162 nan 8.0 8.0
0.0610391121885534 11.40800825783382 nan 8.0 8.0
0.06094809009468771 11.400054925713727 nan 8.0 8.0
0.06086737434887257 11.387671788336649 nan 8.0 8.0
0.060801997756061876 11.369800541070566 nan 8.0 8.0
0.060770444124440215 11.34568776698774 nan 8.0 8.0
0.06073988335752256 11.332020099213434 nan 8.0 8.0
0.06072382375151719 11.338546906773146 nan 8.0 8.0
U dimensions = (477, 33)
Iteration 0 of 1
phi.shape: (50, 477)
U.shape: (477, 33)
phi.dot(U).T shape: (33, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800051.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800051_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800051_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800051_test_data.npy
Cleanup complete.

Simulation 3/10 score: 0.809993570752475
Running repeat 4/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800096.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_118538_1741800096'
Loaded dataset: downsampled_500genes_118538_1741800096
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.1866648815773322 2.7772689181495767 nan 8.0 8.0
0.06798772355931415 10.692407823982299 nan 8.0 8.0
0.0653690567139188 10.876549642041615 nan 8.0 8.0
0.0637531360260305 10.91897980327534 nan 8.0 8.0
0.06269491778423253 11.040359599716092 nan 8.0 8.0
0.061957758137062724 11.168848882769058 nan 8.0 8.0
0.06172945351098991 11.161942599595553 nan 8.0 8.0
0.06161046981914253 11.181030590696091 nan 8.0 8.0
0.06152177604408615 11.178972509091963 nan 8.0 8.0
0.06142913279780826 11.189009426662414 nan 8.0 8.0
0.061368972645008846 11.18999839152531 nan 8.0 8.0
0.0612861476869726 11.187594461973458 nan 8.0 8.0
0.06118851938961889 11.185131846261495 nan 8.0 8.0
0.06109654295620737 11.164201850787142 nan 8.0 8.0
0.06099390646460878 11.127657972053138 nan 8.0 8.0
0.06092990144024135 11.125243870551744 nan 8.0 8.0
0.06086412363116123 11.116073283293073 nan 8.0 8.0
0.06076410622042061 11.119754711316691 nan 8.0 8.0
0.06070192244586947 11.109971042165341 nan 8.0 8.0
0.06065172838541766 11.113128485021008 nan 8.0 8.0
U dimensions = (477, 33)
Iteration 0 of 1
phi.shape: (50, 477)
U.shape: (477, 33)
phi.dot(U).T shape: (33, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800096.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800096_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800096_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800096_test_data.npy
Cleanup complete.

Simulation 4/10 score: 0.8275868274010479
Running repeat 5/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800149.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_118538_1741800149'
Loaded dataset: downsampled_500genes_118538_1741800149
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.20381250092906955 2.9463198355647577 nan 8.0 8.0
0.07017556037154249 10.653765221766497 nan 8.0 8.0
0.0675936064780539 10.833726503111059 nan 8.0 8.0
0.0652506152046104 10.937676000186265 nan 8.0 8.0
0.0640987006600564 11.077910149173462 nan 8.0 8.0
0.06345175532626468 10.97290875684579 nan 8.0 8.0
0.06270369124641917 10.952748728610917 nan 8.0 8.0
0.062219837219544494 10.972305039153731 nan 8.0 8.0
0.06205445408321919 10.994503982824472 nan 8.0 8.0
0.06193975591810552 11.000799533528838 nan 8.0 8.0
0.06186615576115306 11.006907238997613 nan 8.0 8.0
0.06176049630620162 11.021566842562066 nan 8.0 8.0
0.061698677792501155 11.017048979171774 nan 8.0 8.0
0.061661400491928586 11.014546206735815 nan 8.0 8.0
0.06160264238842872 11.017273098939448 nan 8.0 8.0
0.06155948764441277 11.040854116889019 nan 8.0 8.0
0.06152445671017093 11.139501052053252 nan 8.0 8.0
0.06149729916449165 11.146700292974437 nan 8.0 8.0
0.061470155358726464 11.150989280474114 nan 8.0 8.0
0.06144809080197844 11.161087141506819 nan 8.0 8.0
U dimensions = (477, 32)
Iteration 0 of 1
phi.shape: (50, 477)
U.shape: (477, 32)
phi.dot(U).T shape: (32, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800149.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800149_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800149_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800149_test_data.npy
Cleanup complete.

Simulation 5/10 score: 0.7953356453783433
Running repeat 6/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800196.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_118538_1741800196'
Loaded dataset: downsampled_500genes_118538_1741800196
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.1911975641044179 2.7070550417389203 nan 8.0 8.0
0.06982518992078968 11.492556480593342 nan 8.0 8.0
0.0675199867184596 11.446729994542805 nan 8.0 8.0
0.06595491757017913 11.493664861865659 nan 8.0 8.0
0.06497028268656868 11.640620032329213 nan 8.0 8.0
0.06401638321239134 11.643396424293941 nan 8.0 8.0
0.06325359209220716 11.695188275403526 nan 8.0 8.0
0.06270998157486518 11.713608695713212 nan 8.0 8.0
0.06228827978112961 11.724686297329587 nan 8.0 8.0
0.06210036208425429 11.599346953171219 nan 8.0 8.0
0.06203959071520637 11.468318965730429 nan 8.0 8.0
0.06191663645326728 11.446871686261602 nan 8.0 8.0
0.06184870289036526 11.44984477820527 nan 8.0 8.0
0.06177154371998761 11.462558435047743 nan 8.0 8.0
0.06173122329746039 11.446350359246335 nan 8.0 8.0
0.061691204169613045 11.440665583588657 nan 8.0 8.0
0.0616841908958784 11.434678490322307 nan 8.0 8.0
0.06168206047467939 11.434615972896438 nan 8.0 8.0
0.06168204405063005 11.434493851589865 nan 8.0 8.0
0.06168204591937754 11.434478991670053 nan 8.0 8.0
U dimensions = (477, 30)
Iteration 0 of 1
phi.shape: (50, 477)
U.shape: (477, 30)
phi.dot(U).T shape: (30, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800196.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800196_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800196_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800196_test_data.npy
Cleanup complete.

Simulation 6/10 score: 0.827594744699124
Running repeat 7/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800244.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_118538_1741800244'
Loaded dataset: downsampled_500genes_118538_1741800244
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.2255582807805644 2.8763041047200955 nan 8.0 8.0
0.0700978079642991 11.5830054617175 nan 8.0 8.0
0.06675886184998114 11.305300712631139 nan 8.0 8.0
0.0656274854525224 11.296989953351092 nan 8.0 8.0
0.06516278550908738 11.321338047986728 nan 8.0 8.0
0.06493592385462854 11.304466173951576 nan 8.0 8.0
0.06481775803477896 11.304852107779938 nan 8.0 8.0
0.06470893400146926 11.307408655716712 nan 8.0 8.0
0.064642459846881 11.313913951511697 nan 8.0 8.0
0.06459623255934954 11.300213468825332 nan 8.0 8.0
0.06457849522956649 11.291444559752156 nan 8.0 8.0
0.06456535268901276 11.292038885025715 nan 8.0 8.0
0.06456200929183176 11.291470727243716 nan 8.0 8.0
0.06456224872568717 11.287836588602408 nan 8.0 8.0
0.06456226572289281 11.286888929513449 nan 8.0 8.0
0.06455862663295375 11.287883936823011 nan 8.0 8.0
0.0645482772742052 11.289949058929453 nan 8.0 8.0
0.06454353815002445 11.292915849980307 nan 8.0 8.0
0.06454069526826378 11.292117771649014 nan 8.0 8.0
0.06452783934745487 11.289831022734166 nan 8.0 8.0
U dimensions = (477, 30)
Iteration 0 of 1
phi.shape: (50, 477)
U.shape: (477, 30)
phi.dot(U).T shape: (30, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800244.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800244_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800244_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800244_test_data.npy
Cleanup complete.

Simulation 7/10 score: 0.8321733917046773
Running repeat 8/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800297.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_118538_1741800297'
Loaded dataset: downsampled_500genes_118538_1741800297
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.202900579657057 2.7514872055584267 nan 8.0 8.0
0.07280420301157386 11.64764148251127 nan 8.0 8.0
0.0706226027146617 11.302124236855542 nan 8.0 8.0
0.06921641210875484 11.54387937883667 nan 8.0 8.0
0.06821303800307821 11.61118131591552 nan 8.0 8.0
0.06754087903789485 11.66895939399657 nan 8.0 8.0
0.0668566129291761 11.633518961039789 nan 8.0 8.0
0.0659534306740166 11.617898526446258 nan 8.0 8.0
0.065468418970685 11.629058993403762 nan 8.0 8.0
0.06519555825156409 11.69680198587823 nan 8.0 8.0
0.06507209756907872 11.71434677700051 nan 8.0 8.0
0.06495963105225167 11.737095570179104 nan 8.0 8.0
0.06460916314579424 11.821902134379878 nan 8.0 8.0
0.06407118990040295 11.882638131006253 nan 8.0 8.0
0.06379407605115739 11.853417667475519 nan 8.0 8.0
0.06370153890205743 11.8420902453584 nan 8.0 8.0
0.06364156134410126 11.843853711165599 nan 8.0 8.0
0.06354179081579336 11.849364702576212 nan 8.0 8.0
0.06350825141227412 11.859673383034226 nan 8.0 8.0
0.06348565899149572 11.865265145328314 nan 8.0 8.0
U dimensions = (477, 29)
Iteration 0 of 1
phi.shape: (50, 477)
U.shape: (477, 29)
phi.dot(U).T shape: (29, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800297.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800297_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800297_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800297_test_data.npy
Cleanup complete.

Simulation 8/10 score: 0.805668622547388
Running repeat 9/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800348.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_118538_1741800348'
Loaded dataset: downsampled_500genes_118538_1741800348
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.18850092920078532 3.0919126915132775 nan 8.0 8.0
0.06665291228862291 11.34911783782887 nan 8.0 8.0
0.06423585178089664 11.059952101775805 nan 8.0 8.0
0.06249483432811731 11.101283489805894 nan 8.0 8.0
0.06119471503848206 11.153469374684292 nan 8.0 8.0
0.06027157682790096 11.184793432092603 nan 8.0 8.0
0.059834485969459617 11.280209939126731 nan 8.0 8.0
0.05935782457724037 11.23067214173689 nan 8.0 8.0
0.05911030264577721 11.280129497716844 nan 8.0 8.0
0.05886276465296891 11.382673209064498 nan 8.0 8.0
0.05858981895363313 11.389870087039206 nan 8.0 8.0
0.05843448963908782 11.3846497564361 nan 8.0 8.0
0.058315304290738945 11.424666964437483 nan 8.0 8.0
0.058245506712234385 11.408869084136231 nan 8.0 8.0
0.05821170318485758 11.40608734690702 nan 8.0 8.0
0.05817904016761766 11.409077124959554 nan 8.0 8.0
0.05812369007953444 11.429644924115706 nan 8.0 8.0
0.058084712418984163 11.432979190531158 nan 8.0 8.0
0.058054180660664256 11.460324631275357 nan 8.0 8.0
0.058021146486561315 11.465582250193078 nan 8.0 8.0
U dimensions = (477, 34)
Iteration 0 of 1
phi.shape: (50, 477)
U.shape: (477, 34)
phi.dot(U).T shape: (34, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800348.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800348_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800348_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800348_test_data.npy
Cleanup complete.

Simulation 9/10 score: 0.8186638976235665
Running repeat 10/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800397.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_118538_1741800397'
Loaded dataset: downsampled_500genes_118538_1741800397
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.2244426989667504 2.736396579049136 nan 8.0 8.0
0.07191747695148476 11.286312242341271 nan 8.0 8.0
0.0685796023568418 11.413599671040995 nan 8.0 8.0
0.06636217095087005 11.638556530885477 nan 8.0 8.0
0.06511879116630481 11.597213249563023 nan 8.0 8.0
0.06429182146032986 11.694845092203774 nan 8.0 8.0
0.06388058983934097 11.808756373366293 nan 8.0 8.0
0.06361420394033068 11.876315820714874 nan 8.0 8.0
0.06337752844207489 11.893010400397738 nan 8.0 8.0
0.06314696595114688 11.91345821114891 nan 8.0 8.0
0.0629863197852294 11.910712574156834 nan 8.0 8.0
0.0627740769204348 11.902237019499234 nan 8.0 8.0
0.06250111418390769 11.873095099588278 nan 8.0 8.0
0.062372257607985704 11.828770278790305 nan 8.0 8.0
0.06231882537042066 11.840068836597112 nan 8.0 8.0
0.062285934156430356 11.848540182681033 nan 8.0 8.0
0.06225201468679287 11.858909355256612 nan 8.0 8.0
0.062129818772998835 11.845147381778366 nan 8.0 8.0
0.06205039199662887 11.841901167062677 nan 8.0 8.0
0.06199741244425705 11.84554618109023 nan 8.0 8.0
U dimensions = (477, 28)
Iteration 0 of 1
phi.shape: (50, 477)
U.shape: (477, 28)
phi.dot(U).T shape: (28, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800397.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800397_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800397_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_118538_1741800397_test_data.npy
Cleanup complete.

Simulation 10/10 score: 0.810380163934089
Results saved: results/simulation/results_optimal.csv
Running simulation with: num_measurements=10, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=5000
Running repeat 1/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799596.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3984295_1741799596'
Loaded dataset: downsampled_5000genes_3984295_1741799596
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.33778158205763587 10.654146931128825 1.0 8.0 8.0
0.2858423279547603 18.188480883157265 1.0 8.0 8.0
0.29370552327504995 16.679155168943847 1.0 8.0 8.0
0.2950792559113926 16.53240840552506 1.0 8.0 8.0
0.296303993973136 16.34978579679932 1.0 8.0 8.0
0.296847117241819 16.412930846113895 1.0 8.0 8.0
0.2968239935855804 16.469686046162224 1.0 8.0 8.0
0.2972179695299767 16.459809835693516 1.0 8.0 8.0
0.2972121685968835 16.500632578150856 1.0 8.0 8.0
0.2972099203164835 16.485477532138127 1.0 8.0 8.0
0.29721075220922366 16.465291039383462 1.0 8.0 8.0
0.29720071641289314 16.45247887176572 1.0 8.0 8.0
0.2971804030641688 16.430957612888744 1.0 8.0 8.0
0.29715518135000574 16.3329971525645 1.0 8.0 8.0
0.2971455980770572 16.31559250097847 1.0 8.0 8.0
0.29713919230806396 16.312721136493913 1.0 8.0 8.0
0.29713286883806755 16.290738151910823 1.0 8.0 8.0
0.29713222177766563 16.282988601952542 1.0 8.0 8.0
0.2971328561718203 16.28151583415177 1.0 8.0 8.0
0.2971330569490265 16.281019543280138 1.0 8.0 8.0
U dimensions = (4971, 36)
Iteration 0 of 1
phi.shape: (10, 4971)
U.shape: (4971, 36)
phi.dot(U).T shape: (36, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799596.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799596_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799596_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799596_test_data.npy
Cleanup complete.

Simulation 1/10 score: 0.6845204789711306
Running repeat 2/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799681.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3984295_1741799681'
Loaded dataset: downsampled_5000genes_3984295_1741799681
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3557589847513867 11.789534797978082 1.0 8.0 8.0
0.28420390306567045 19.334507730178444 1.0 8.0 8.0
0.29143711957691865 16.625410617510024 1.0 8.0 8.0
0.29348931357368346 16.60350044718139 1.0 8.0 8.0
0.2944853204052851 16.28535998527302 1.0 8.0 8.0
0.29491729495459007 16.327519014666223 1.0 8.0 8.0
0.2953686670867931 16.244849695634286 1.0 8.0 8.0
0.2955299159894168 16.231544392322558 1.0 8.0 8.0
0.29571110687305724 16.2529133227995 1.0 8.0 8.0
0.2957707422067686 16.24176252445012 1.0 8.0 8.0
0.2957476821639551 16.042346199522687 1.0 8.0 8.0
0.29578181893477207 15.979125686966345 1.0 8.0 8.0
0.2957913311360063 16.0354668441239 1.0 8.0 8.0
0.29580770933652056 16.033553697704743 1.0 8.0 8.0
0.29580366365853994 16.043945796659045 1.0 8.0 8.0
0.29580449440755263 16.04334404525675 1.0 8.0 8.0
0.29580386964103045 16.04357804613351 1.0 8.0 8.0
0.2958042903414394 16.040384515181287 1.0 8.0 8.0
0.2958062825982011 16.042022902635086 1.0 8.0 8.0
0.29580739000473066 16.038393150170826 1.0 8.0 8.0
U dimensions = (4971, 36)
Iteration 0 of 1
phi.shape: (10, 4971)
U.shape: (4971, 36)
phi.dot(U).T shape: (36, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799681.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799681_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799681_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799681_test_data.npy
Cleanup complete.

Simulation 2/10 score: 0.6916980778815797
Running repeat 3/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799764.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3984295_1741799764'
Loaded dataset: downsampled_5000genes_3984295_1741799764
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3887554260729602 12.301001270971211 1.0 8.0 8.0
0.27890039524756793 23.703299950136547 1.0 8.0 8.0
0.2889273618651472 18.336892517578228 1.0 8.0 8.0
0.2940773325294872 17.82021476007732 1.0 8.0 8.0
0.29546191740297745 16.972400337885947 1.0 8.0 8.0
0.2962969887840404 16.997654380278913 1.0 8.0 8.0
0.296801411510217 17.047411306948206 1.0 8.0 8.0
0.29707371546310946 17.16118771387002 1.0 8.0 8.0
0.2970998253895174 17.163639059168744 1.0 8.0 8.0
0.2970685988449383 17.149024165525887 1.0 8.0 8.0
0.29706316949697464 17.137147478335695 1.0 8.0 8.0
0.29706144823578395 17.14628451505612 1.0 8.0 8.0
0.29705889384220063 17.15201711147739 1.0 8.0 8.0
0.29705856277656195 17.156110860467624 1.0 8.0 8.0
0.2970580277712065 17.15763325564912 1.0 8.0 8.0
0.2970576554918404 17.154908164443416 1.0 8.0 8.0
0.2970574908710846 17.155193978339817 1.0 8.0 8.0
0.2970574866165937 17.154954534024753 1.0 8.0 8.0
0.2970574877880984 17.154973426858533 1.0 8.0 8.0
0.29705748784683206 17.15497419047468 1.0 8.0 8.0
U dimensions = (4971, 36)
Iteration 0 of 1
phi.shape: (10, 4971)
U.shape: (4971, 36)
phi.dot(U).T shape: (36, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799764.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799764_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799764_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799764_test_data.npy
Cleanup complete.

Simulation 3/10 score: 0.6969579231581392
Running repeat 4/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799848.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3984295_1741799848'
Loaded dataset: downsampled_5000genes_3984295_1741799848
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.35869405691083633 10.827796843131132 1.0 8.0 8.0
0.28785520404729137 20.66659442883652 1.0 8.0 8.0
0.2933995125266061 17.76924954406681 1.0 8.0 8.0
0.29443551731803197 17.01212205819962 1.0 8.0 8.0
0.29471530385913647 17.0450977917742 1.0 8.0 8.0
0.29502441327490336 17.023005874711515 1.0 8.0 8.0
0.2953701242415251 16.962574696747637 1.0 8.0 8.0
0.29559687588156736 16.9009303221083 1.0 8.0 8.0
0.29577215122388123 16.964150511287556 1.0 8.0 8.0
0.2957948828644795 16.95668720944538 1.0 8.0 8.0
0.29579454308730835 16.95683730056472 1.0 8.0 8.0
0.2957944229434263 16.956282338158303 1.0 8.0 8.0
0.29579397495393533 16.948884203797935 1.0 8.0 8.0
0.2957938905373704 16.948073451849325 1.0 8.0 8.0
0.29579389024271574 16.94801306058157 1.0 8.0 8.0
0.29579389009432566 16.948005946517448 1.0 8.0 8.0
0.2957938900883649 16.948005865314162 1.0 8.0 8.0
0.29579389008792456 16.94800585638437 1.0 8.0 8.0
0.295793890087902 16.948005856607182 1.0 8.0 8.0
0.2957938900878998 16.94800585661297 1.0 8.0 8.0
U dimensions = (4971, 34)
Iteration 0 of 1
phi.shape: (10, 4971)
U.shape: (4971, 34)
phi.dot(U).T shape: (34, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799848.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799848_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799848_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799848_test_data.npy
Cleanup complete.

Simulation 4/10 score: 0.6901377878431889
Running repeat 5/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799916.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3984295_1741799916'
Loaded dataset: downsampled_5000genes_3984295_1741799916
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3487769291453451 11.051082239747076 1.0 8.0 8.0
0.2904074584894242 18.695889988051842 1.0 8.0 8.0
0.2952669705601175 16.86559984565806 1.0 8.0 8.0
0.29642161757147845 17.12515408260691 1.0 8.0 8.0
0.2968889159992536 17.310409833271287 1.0 8.0 8.0
0.29717972007199356 17.29883939130116 1.0 8.0 8.0
0.29719783182572435 17.313275813872913 1.0 8.0 8.0
0.29710549235161143 17.38791856662715 1.0 8.0 8.0
0.2970662039983679 17.401685478631762 1.0 8.0 8.0
0.2970581771987585 17.40228661047929 1.0 8.0 8.0
0.29704759806149084 17.38764566680624 1.0 8.0 8.0
0.29704017461076526 17.353614929102726 1.0 8.0 8.0
0.29702988660099827 17.325128353355343 1.0 8.0 8.0
0.29701333342674774 17.331748725703903 1.0 8.0 8.0
0.2969961899966782 17.36260991253372 1.0 8.0 8.0
0.29696899561592893 17.380975065620145 1.0 8.0 8.0
0.29694214373103756 17.371410645596704 1.0 8.0 8.0
0.2969312125480845 17.377051506419182 1.0 8.0 8.0
0.29692659328551363 17.375857030035526 1.0 8.0 8.0
0.2969234311436053 17.36705161146929 1.0 8.0 8.0
U dimensions = (4971, 35)
Iteration 0 of 1
phi.shape: (10, 4971)
U.shape: (4971, 35)
phi.dot(U).T shape: (35, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799916.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799916_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799916_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799916_test_data.npy
Cleanup complete.

Simulation 5/10 score: 0.6735233726765463
Running repeat 6/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799987.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3984295_1741799987'
Loaded dataset: downsampled_5000genes_3984295_1741799987
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.34328474547740484 10.636893810584498 1.0 8.0 8.0
0.28694367946409416 18.7052127246202 1.0 8.0 8.0
0.29393064992373186 16.251240921576667 1.0 8.0 8.0
0.2955397444119211 15.86171598991176 1.0 8.0 8.0
0.29630096461566646 15.532967456319065 1.0 8.0 8.0
0.2965710908779112 15.465269617840002 1.0 8.0 8.0
0.2967739216276746 15.460511190662649 1.0 8.0 8.0
0.2970284780032757 15.4285471714655 1.0 8.0 8.0
0.2971904690637328 15.40221802431316 1.0 8.0 8.0
0.2973209996682721 15.40344054514237 1.0 8.0 8.0
0.29751284923931454 15.430821993337865 1.0 8.0 8.0
0.29761161585812 15.469057961063708 1.0 8.0 8.0
0.2977059581525887 15.492839701849805 1.0 8.0 8.0
0.2977498316848861 15.607849673872133 1.0 8.0 8.0
0.29781033835584325 15.671516589329869 1.0 8.0 8.0
0.298026373029609 15.800608938482583 1.0 8.0 8.0
0.298313647889872 15.703748717608518 1.0 8.0 8.0
0.29830897290777125 15.70219674728194 1.0 8.0 8.0
0.29831018722610736 15.705993005305741 1.0 8.0 8.0
0.29830985763855555 15.707470140209427 1.0 8.0 8.0
U dimensions = (4971, 35)
Iteration 0 of 1
phi.shape: (10, 4971)
U.shape: (4971, 35)
phi.dot(U).T shape: (35, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799987.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799987_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799987_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741799987_test_data.npy
Cleanup complete.

Simulation 6/10 score: 0.6406521470674531
Running repeat 7/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741800071.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3984295_1741800071'
Loaded dataset: downsampled_5000genes_3984295_1741800071
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.35201060924209804 10.545359254412567 1.0 8.0 8.0
0.29430480468450526 20.287761322956197 1.0 8.0 8.0
0.29721774834257975 19.066289480911454 1.0 8.0 8.0
0.29782066226718706 17.855063900751997 1.0 8.0 8.0
0.2979926944769129 17.397059438844533 1.0 8.0 8.0
0.2980732066217139 17.477002511053755 1.0 8.0 8.0
0.2980646043430638 17.47869494451783 1.0 8.0 8.0
0.29802724726662466 17.478366805444374 1.0 8.0 8.0
0.29811188682903844 17.61045906604377 1.0 8.0 8.0
0.29824013610072975 17.600149572466638 1.0 8.0 8.0
0.29841978514253 17.586186724099043 1.0 8.0 8.0
0.2985525122660717 17.561126995482372 1.0 8.0 8.0
0.2986946712010494 17.53858634499249 1.0 8.0 8.0
0.29869711964356593 17.530410901791388 1.0 8.0 8.0
0.298679446761943 17.570092239998182 1.0 8.0 8.0
0.29868103500608956 17.56748444625159 1.0 8.0 8.0
0.2986961466490847 17.591646887378147 1.0 8.0 8.0
0.2986970931286942 17.59169255250697 1.0 8.0 8.0
0.2986995550891499 17.59244137616231 1.0 8.0 8.0
0.2987003448767611 17.593123929348828 1.0 8.0 8.0
U dimensions = (4971, 33)
Iteration 0 of 1
phi.shape: (10, 4971)
U.shape: (4971, 33)
phi.dot(U).T shape: (33, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741800071.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741800071_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741800071_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741800071_test_data.npy
Cleanup complete.

Simulation 7/10 score: 0.6639417607753441
Running repeat 8/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741800153.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3984295_1741800153'
Loaded dataset: downsampled_5000genes_3984295_1741800153
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3702038101233388 12.196232356649748 1.0 8.0 8.0
0.28277564202791905 22.524360832511665 1.0 8.0 8.0
0.28882042612791303 19.913575560723306 1.0 8.0 8.0
0.2977129095169968 18.304784653591692 1.0 8.0 8.0
0.29869203664620825 17.976238055101945 1.0 8.0 8.0
0.2985761435155563 17.679648102086812 1.0 8.0 8.0
0.29853280572768437 17.628990418661193 1.0 8.0 8.0
0.29843923082049617 17.53975448985058 1.0 8.0 8.0
0.2983704325104375 17.541950268449696 1.0 8.0 8.0
0.29827290369587633 17.53044214217381 1.0 8.0 8.0
0.2980948939508501 17.509708690131806 1.0 8.0 8.0
0.29786970169357907 17.583305271365443 1.0 8.0 8.0
0.2977901757234541 17.62759423372464 1.0 8.0 8.0
0.2977866205435601 17.63585682801148 1.0 8.0 8.0
0.29770662598724906 17.62809909318872 1.0 8.0 8.0
0.29753017637418244 17.661794194998105 1.0 8.0 8.0
0.2973481731753447 17.73972691237161 1.0 8.0 8.0
0.297277440548007 17.730336615640297 1.0 8.0 8.0
0.29725591416678254 17.704127345640114 1.0 8.0 8.0
0.29725295611227676 17.694168581745156 1.0 8.0 8.0
U dimensions = (4971, 33)
Iteration 0 of 1
phi.shape: (10, 4971)
U.shape: (4971, 33)
phi.dot(U).T shape: (33, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741800153.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741800153_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741800153_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741800153_test_data.npy
Cleanup complete.

Simulation 8/10 score: 0.6319313531161586
Running repeat 9/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741800299.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3984295_1741800299'
Loaded dataset: downsampled_5000genes_3984295_1741800299
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.37662329684473594 12.527044661714518 1.0 8.0 8.0
0.27456606940740225 21.542233269398604 1.0 8.0 8.0
0.28536791962098684 17.282257151878657 1.0 8.0 8.0
0.2838446242418312 16.304450191182788 1.0 8.0 8.0
0.28659800436106786 15.988100717777693 1.0 8.0 8.0
0.29270742792332605 15.899524687973852 1.0 8.0 8.0
0.29425343543020566 15.697158303191868 1.0 8.0 8.0
0.29434470238660615 15.571568210029465 1.0 8.0 8.0
0.2944803790641095 15.575602420531187 1.0 8.0 8.0
0.29466508216628096 15.55456265005151 1.0 8.0 8.0
0.2946895634711466 15.563838065261814 1.0 8.0 8.0
0.2946916353928388 15.584646830839244 1.0 8.0 8.0
0.29469319387627313 15.565488026602091 1.0 8.0 8.0
0.29469623696511893 15.54605123866999 1.0 8.0 8.0
0.29469172784913744 15.564583854659034 1.0 8.0 8.0
0.29467963422654075 15.600155957812664 1.0 8.0 8.0
0.29458194207843547 15.664503110186699 1.0 8.0 8.0
0.29454370450370526 15.694382038233698 1.0 8.0 8.0
0.29450732777471733 15.710779173865483 1.0 8.0 8.0
0.29447095317179517 15.731947829359664 1.0 8.0 8.0
U dimensions = (4971, 34)
Iteration 0 of 1
phi.shape: (10, 4971)
U.shape: (4971, 34)
phi.dot(U).T shape: (34, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741800299.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741800299_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741800299_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741800299_test_data.npy
Cleanup complete.

Simulation 9/10 score: 0.6782541098516371
Running repeat 10/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741800486.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3984295_1741800486'
Loaded dataset: downsampled_5000genes_3984295_1741800486
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.34566672639141105 9.548359821147338 1.0 8.0 8.0
0.29525394220277346 18.949680722159783 1.0 8.0 8.0
0.2983926531148503 16.58574065408313 1.0 8.0 8.0
0.29963997838952094 16.485188297964054 1.0 8.0 8.0
0.3001033559126052 16.3837729277543 1.0 8.0 8.0
0.3001027227538712 16.436912703531068 1.0 8.0 8.0
0.3001126064376439 16.434342625158894 1.0 8.0 8.0
0.3000753833082134 16.43074052275736 1.0 8.0 8.0
0.30006540829866024 16.411959827092268 1.0 8.0 8.0
0.3000533465710705 16.41207327595102 1.0 8.0 8.0
0.30002260940058234 16.4177149863085 1.0 8.0 8.0
0.30000181021567274 16.41038102440739 1.0 8.0 8.0
0.2999948633250368 16.417576624531737 1.0 8.0 8.0
0.29998834358437554 16.441949883385167 1.0 8.0 8.0
0.2999853423865043 16.4603900826972 1.0 8.0 8.0
0.29998334790973613 16.45565699432007 1.0 8.0 8.0
0.29998179066277586 16.453739960778925 1.0 8.0 8.0
0.29998076937997076 16.449423453489715 1.0 8.0 8.0
0.2999801254513119 16.449518840820158 1.0 8.0 8.0
0.2999796268997612 16.44631006975505 1.0 8.0 8.0
U dimensions = (4971, 34)
Iteration 0 of 1
phi.shape: (10, 4971)
U.shape: (4971, 34)
phi.dot(U).T shape: (34, 10)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741800486.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741800486_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741800486_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3984295_1741800486_test_data.npy
Cleanup complete.

Simulation 10/10 score: 0.6295760451809284
Results saved: results/simulation/results_optimal.csv
Running simulation with: num_measurements=75, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=500
Running repeat 1/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800172.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_281185_1741800172'
Loaded dataset: downsampled_500genes_281185_1741800172
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.184284530588669 3.4206590467255515 nan 8.0 8.0
0.06777603235190943 10.980017197778484 nan 8.0 8.0
0.06616190542139333 11.092723192284858 nan 8.0 8.0
0.06480483898087519 11.196488163830777 nan 8.0 8.0
0.06410917994538301 11.279908595662807 nan 8.0 8.0
0.06353928134496534 11.335962384271689 nan 8.0 8.0
0.0632325102124679 11.407758982653693 nan 8.0 8.0
0.06303137342164233 11.437328718248237 nan 8.0 8.0
0.06286888040520111 11.321718032006629 nan 8.0 8.0
0.06270391429508126 11.34840523541934 nan 8.0 8.0
0.06259330866580604 11.367518610826219 nan 8.0 8.0
0.06245877779329223 11.335301155508395 nan 8.0 8.0
0.062236080902122404 11.308209025780732 nan 8.0 8.0
0.062048466811845726 11.29351894202915 nan 8.0 8.0
0.061878038569641136 11.30860758469592 nan 8.0 8.0
0.06177098692561356 11.291677159787309 nan 8.0 8.0
0.06173313662331903 11.279512968786097 nan 8.0 8.0
0.06169204680370255 11.283801086351358 nan 8.0 8.0
0.06164614675755975 11.311632923268112 nan 8.0 8.0
0.06162274237030296 11.308976905700685 nan 8.0 8.0
U dimensions = (477, 35)
Iteration 0 of 1
phi.shape: (75, 477)
U.shape: (477, 35)
phi.dot(U).T shape: (35, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800172.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800172_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800172_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800172_test_data.npy
Cleanup complete.

Simulation 1/10 score: 0.8557448563741488
Running repeat 2/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800217.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_281185_1741800217'
Loaded dataset: downsampled_500genes_281185_1741800217
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.20600036488117257 3.037702628305228 nan 8.0 8.0
0.07141699005709345 10.997029089579671 nan 8.0 8.0
0.06937252413863915 10.756259499142566 nan 8.0 8.0
0.06762369677336044 10.885852301459808 nan 8.0 8.0
0.06643464248635655 11.12984993805127 nan 8.0 8.0
0.06578425320961834 11.22454455951558 nan 8.0 8.0
0.06527718869721155 11.274704321653145 nan 8.0 8.0
0.06496194673855993 11.19821537075656 nan 8.0 8.0
0.06475087054581374 11.126749678897076 nan 8.0 8.0
0.0644796918654067 11.163805143423117 nan 8.0 8.0
0.06435532526474197 11.148382268523273 nan 8.0 8.0
0.06424471104646334 11.143431364928011 nan 8.0 8.0
0.06405055612327692 11.114597451668047 nan 8.0 8.0
0.06386910993658923 11.110916356049804 nan 8.0 8.0
0.06378301614356952 11.116953455868142 nan 8.0 8.0
0.06371729229242151 11.13676637499543 nan 8.0 8.0
0.06368194775602931 11.138037698827658 nan 8.0 8.0
0.0636472889166636 11.143526277600758 nan 8.0 8.0
0.06360894277559337 11.134980519028145 nan 8.0 8.0
0.06352188926350799 11.135606758240854 nan 8.0 8.0
U dimensions = (477, 31)
Iteration 0 of 1
phi.shape: (75, 477)
U.shape: (477, 31)
phi.dot(U).T shape: (31, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800217.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800217_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800217_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800217_test_data.npy
Cleanup complete.

Simulation 2/10 score: 0.8503598779797755
Running repeat 3/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800263.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_281185_1741800263'
Loaded dataset: downsampled_500genes_281185_1741800263
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.17796209029157883 3.1400799286804926 nan 8.0 8.0
0.06741105140975112 10.888403632607735 nan 8.0 8.0
0.06554841342028717 11.109111451277531 nan 8.0 8.0
0.0643913265490691 11.166258090743188 nan 8.0 8.0
0.06364242416535193 11.231297054805346 nan 8.0 8.0
0.06290510590027942 11.363264478228707 nan 8.0 8.0
0.06230641170225015 11.394577976283962 nan 8.0 8.0
0.06170854597665898 11.507514015208189 nan 8.0 8.0
0.06119838700595914 11.571386268000971 nan 8.0 8.0
0.06102949779356315 11.57933949150132 nan 8.0 8.0
0.06093055071622966 11.570567072383684 nan 8.0 8.0
0.060860399831002776 11.574449104155587 nan 8.0 8.0
0.0607997947405714 11.521007411223971 nan 8.0 8.0
0.06075933553610202 11.510694592201686 nan 8.0 8.0
0.060734145703812525 11.49112525442394 nan 8.0 8.0
0.06070704066871224 11.470665713751117 nan 8.0 8.0
0.060697117090678154 11.457447792086763 nan 8.0 8.0
0.060697542454133724 11.44236030076961 nan 8.0 8.0
0.060693744572813735 11.432573903436825 nan 8.0 8.0
0.06070278437331489 11.424329993884784 nan 8.0 8.0
U dimensions = (477, 34)
Iteration 0 of 1
phi.shape: (75, 477)
U.shape: (477, 34)
phi.dot(U).T shape: (34, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800263.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800263_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800263_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800263_test_data.npy
Cleanup complete.

Simulation 3/10 score: 0.8788225038442873
Running repeat 4/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800312.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_281185_1741800312'
Loaded dataset: downsampled_500genes_281185_1741800312
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.19194895310973537 3.201934779116422 nan 8.0 8.0
0.07113972770060673 11.582925301301911 nan 8.0 8.0
0.06893058108528938 11.462727572373227 nan 8.0 8.0
0.067859720196494 11.369643012696901 nan 8.0 8.0
0.06635871228623846 11.189725206783166 nan 8.0 8.0
0.06554282714326398 11.156927300319849 nan 8.0 8.0
0.06524491121868992 11.143841331686433 nan 8.0 8.0
0.0650672223379879 11.163299870798284 nan 8.0 8.0
0.0647332118877757 11.11879538048923 nan 8.0 8.0
0.06452588665001391 11.111075214661971 nan 8.0 8.0
0.06426649547941254 11.095258913248125 nan 8.0 8.0
0.06407535838030576 11.068186259679766 nan 8.0 8.0
0.06388677507665264 11.062842489532557 nan 8.0 8.0
0.06364468080720997 11.043633297784211 nan 8.0 8.0
0.06344005578726075 11.03713690424697 nan 8.0 8.0
0.0630296323188233 11.028090959405322 nan 8.0 8.0
0.06285815156964447 11.004421606389023 nan 8.0 8.0
0.06278719644571251 11.09020582990361 nan 8.0 8.0
0.06275953016496272 11.104319237744097 nan 8.0 8.0
0.06274902428291385 11.126839784025947 nan 8.0 8.0
U dimensions = (477, 33)
Iteration 0 of 1
phi.shape: (75, 477)
U.shape: (477, 33)
phi.dot(U).T shape: (33, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800312.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800312_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800312_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800312_test_data.npy
Cleanup complete.

Simulation 4/10 score: 0.5528016885513309
Running repeat 5/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800359.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_281185_1741800359'
Loaded dataset: downsampled_500genes_281185_1741800359
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.18586997538704675 3.0991494349948434 nan 8.0 8.0
0.07079228020393047 11.20479181571991 nan 8.0 8.0
0.06888672912207228 11.234310305726135 nan 8.0 8.0
0.06746206901645602 11.307559113770536 nan 8.0 8.0
0.06623663516207479 11.41339896847073 nan 8.0 8.0
0.06540799630050154 11.516746193914505 nan 8.0 8.0
0.06469905705158341 11.538914395390304 nan 8.0 8.0
0.06436537209047255 11.504115875009012 nan 8.0 8.0
0.06411711500705264 11.458236205805658 nan 8.0 8.0
0.06395850082352939 11.459250895230914 nan 8.0 8.0
0.0638433903709692 11.46393858740073 nan 8.0 8.0
0.06377765053791384 11.486845098901266 nan 8.0 8.0
0.06370146206795102 11.49998306825763 nan 8.0 8.0
0.06363896244740386 11.507994498907877 nan 8.0 8.0
0.06351686748690188 11.53456543039549 nan 8.0 8.0
0.06341013605053791 11.551157730728328 nan 8.0 8.0
0.06324590014961329 11.633225219045753 nan 8.0 8.0
0.06314644415564985 11.647376384623897 nan 8.0 8.0
0.06310880476486325 11.634541504085844 nan 8.0 8.0
0.06307071971805722 11.644599693293355 nan 8.0 8.0
U dimensions = (477, 31)
Iteration 0 of 1
phi.shape: (75, 477)
U.shape: (477, 31)
phi.dot(U).T shape: (31, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800359.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800359_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800359_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800359_test_data.npy
Cleanup complete.

Simulation 5/10 score: 0.8859785229340927
Running repeat 6/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800410.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_281185_1741800410'
Loaded dataset: downsampled_500genes_281185_1741800410
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.1758997852095494 3.017362336557834 nan 8.0 8.0
0.06860018696146086 11.758238814850662 nan 8.0 8.0
0.06556104181125166 11.691899529211469 nan 8.0 8.0
0.06348615645059708 11.632354039132714 nan 8.0 8.0
0.06252619599885412 11.66525471022158 nan 8.0 8.0
0.06173656767843971 11.701679976103978 nan 8.0 8.0
0.06104670738345197 11.715798061486456 nan 8.0 8.0
0.06045577496216703 11.699923748366409 nan 8.0 8.0
0.060299280208872985 11.700950864599776 nan 8.0 8.0
0.06018848879363359 11.733060865594195 nan 8.0 8.0
0.06012670432429268 11.751384545518894 nan 8.0 8.0
0.060068929771582846 11.752922682550519 nan 8.0 8.0
0.059996000778279934 11.754680913191832 nan 8.0 8.0
0.05990343449135549 11.75590717252197 nan 8.0 8.0
0.059793756242118135 11.75975207333252 nan 8.0 8.0
0.059697858870989884 11.754420377206538 nan 8.0 8.0
0.059623905596015714 11.682798330387133 nan 8.0 8.0
0.05956862676283181 11.664815188082228 nan 8.0 8.0
0.05953793339204372 11.658216509322553 nan 8.0 8.0
0.05949403293931932 11.63677884014055 nan 8.0 8.0
U dimensions = (477, 33)
Iteration 0 of 1
phi.shape: (75, 477)
U.shape: (477, 33)
phi.dot(U).T shape: (33, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800410.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800410_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800410_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800410_test_data.npy
Cleanup complete.

Simulation 6/10 score: 0.859255972297845
Running repeat 7/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800457.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_281185_1741800457'
Loaded dataset: downsampled_500genes_281185_1741800457
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.17876841012240685 2.9969951517194287 nan 8.0 8.0
0.06793338599679677 11.084813782069483 nan 8.0 8.0
0.06423278436328561 10.628667595012294 nan 8.0 8.0
0.06259654913496426 10.826432240014116 nan 8.0 8.0
0.06151926661153584 10.889582414059333 nan 8.0 8.0
0.060861760249068864 10.876831573312078 nan 8.0 8.0
0.060458155529104385 10.891093765940631 nan 8.0 8.0
0.060210513196060855 10.897903004723132 nan 8.0 8.0
0.06000901853438234 10.902971995761172 nan 8.0 8.0
0.059860502797867365 10.940675455328217 nan 8.0 8.0
0.05975610629660044 10.953852371678295 nan 8.0 8.0
0.05967339424138596 10.98387829344059 nan 8.0 8.0
0.05957400714472827 11.038748103925586 nan 8.0 8.0
0.05947052483426518 11.051311534334493 nan 8.0 8.0
0.05934956233043609 11.05849202069608 nan 8.0 8.0
0.059253250798628865 11.07411740093822 nan 8.0 8.0
0.059213514221948316 11.08094483638828 nan 8.0 8.0
0.05919630241046314 11.079478404857785 nan 8.0 8.0
0.059171344284013605 11.068010586088656 nan 8.0 8.0
0.05915261778645309 11.055798080312707 nan 8.0 8.0
U dimensions = (477, 36)
Iteration 0 of 1
phi.shape: (75, 477)
U.shape: (477, 36)
phi.dot(U).T shape: (36, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800457.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800457_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800457_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800457_test_data.npy
Cleanup complete.

Simulation 7/10 score: 0.8870584924188266
Running repeat 8/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800508.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_281185_1741800508'
Loaded dataset: downsampled_500genes_281185_1741800508
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.19993510828793548 3.2801661596169573 nan 8.0 8.0
0.06759591226401929 11.559310620338143 nan 8.0 8.0
0.06540010954573972 11.439895000569635 nan 8.0 8.0
0.06387531271905744 11.473008495069188 nan 8.0 8.0
0.06243486323943748 11.637234691387029 nan 8.0 8.0
0.0612316639080287 11.47748470839501 nan 8.0 8.0
0.06050346937028128 11.308863640452248 nan 8.0 8.0
0.06018722988915126 11.28713210991468 nan 8.0 8.0
0.059839448672329154 11.344752007454815 nan 8.0 8.0
0.05956851140170916 11.383741100689914 nan 8.0 8.0
0.059395408686264806 11.405666014120895 nan 8.0 8.0
0.059284951102077765 11.404383004359136 nan 8.0 8.0
0.05921980124108006 11.39805993505206 nan 8.0 8.0
0.059166895631968086 11.403908547019252 nan 8.0 8.0
0.05913238610158844 11.40958026103003 nan 8.0 8.0
0.05908989480474336 11.416262906862615 nan 8.0 8.0
0.059050300532547007 11.42758733695887 nan 8.0 8.0
0.0589988201834033 11.436959915506534 nan 8.0 8.0
0.058947676913266855 11.441160015557648 nan 8.0 8.0
0.05892596607939182 11.432056016254867 nan 8.0 8.0
U dimensions = (477, 34)
Iteration 0 of 1
phi.shape: (75, 477)
U.shape: (477, 34)
phi.dot(U).T shape: (34, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800508.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800508_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800508_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800508_test_data.npy
Cleanup complete.

Simulation 8/10 score: 0.8794874006063309
Running repeat 9/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800556.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_281185_1741800556'
Loaded dataset: downsampled_500genes_281185_1741800556
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.17297752994849702 2.8141845297787973 nan 8.0 8.0
0.07007341885121343 10.262167002572086 nan 8.0 8.0
0.06677414878084509 10.180981860750137 nan 8.0 8.0
0.06475964130080969 10.246571914704154 nan 8.0 8.0
0.0637399242065112 10.362610477035721 nan 8.0 8.0
0.06295651931173563 10.47408775935593 nan 8.0 8.0
0.06222821683235624 10.547653531798318 nan 8.0 8.0
0.06189488302722068 10.611051855046128 nan 8.0 8.0
0.061696330091642104 10.67897449341584 nan 8.0 8.0
0.06127796662781715 10.772314509283902 nan 8.0 8.0
0.06089041373684112 10.773714499739233 nan 8.0 8.0
0.06077393199093939 10.787604731590847 nan 8.0 8.0
0.06070852044008923 10.793342208991108 nan 8.0 8.0
0.06069130720606475 10.791634806347162 nan 8.0 8.0
0.060660005285994356 10.79314280957761 nan 8.0 8.0
0.060625047491013606 10.790605324018742 nan 8.0 8.0
0.06060026428222931 10.788885660841332 nan 8.0 8.0
0.0605681683351581 10.789231226387718 nan 8.0 8.0
0.060547851009290055 10.774188294758337 nan 8.0 8.0
0.06054097948275694 10.771016787995189 nan 8.0 8.0
U dimensions = (477, 35)
Iteration 0 of 1
phi.shape: (75, 477)
U.shape: (477, 35)
phi.dot(U).T shape: (35, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800556.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800556_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800556_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800556_test_data.npy
Cleanup complete.

Simulation 9/10 score: 0.8509795417316157
Running repeat 10/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800605.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_281185_1741800605'
Loaded dataset: downsampled_500genes_281185_1741800605
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.17746026015746674 2.875903657856275 nan 8.0 8.0
0.06642240130939603 10.459008488116199 nan 8.0 8.0
0.06436696224523986 10.622907126109835 nan 8.0 8.0
0.06356154702249439 10.58528757374466 nan 8.0 8.0
0.06306874767723325 10.672400727836033 nan 8.0 8.0
0.0625667756929078 10.802998730438295 nan 8.0 8.0
0.06188043241139163 10.859110049422492 nan 8.0 8.0
0.06129112193522468 10.892212069891691 nan 8.0 8.0
0.06089846678226285 10.900141564240847 nan 8.0 8.0
0.06054273995557147 10.953850088723158 nan 8.0 8.0
0.06025666897837856 10.972421513630351 nan 8.0 8.0
0.0600734621204545 10.919318088980296 nan 8.0 8.0
0.05994389915700693 10.906934326280899 nan 8.0 8.0
0.059879013722790364 10.886889904815684 nan 8.0 8.0
0.059837602330795714 10.868692035532286 nan 8.0 8.0
0.0598084677903179 10.862148021767641 nan 8.0 8.0
0.05975721271266887 10.850045739346655 nan 8.0 8.0
0.05972324989946132 10.835924630401935 nan 8.0 8.0
0.059658593194738985 10.83367548115873 nan 8.0 8.0
0.059597426138213394 10.842121320639146 nan 8.0 8.0
U dimensions = (477, 33)
Iteration 0 of 1
phi.shape: (75, 477)
U.shape: (477, 33)
phi.dot(U).T shape: (33, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800605.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800605_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800605_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281185_1741800605_test_data.npy
Cleanup complete.

Simulation 10/10 score: 0.7851976992961135
Results saved: results/simulation/results_optimal.csv
Running simulation with: num_measurements=50, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=1000
Running repeat 1/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800169.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_1804158_1741800169'
Loaded dataset: downsampled_1000genes_1804158_1741800169
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.18155249565614706 6.292477812116933 1.0 8.0 8.0
0.0848358658305064 14.117597943012075 1.0 8.0 8.0
0.08282626376966473 13.154356223284896 1.0 8.0 8.0
0.08190943037638487 12.510883707081703 1.0 8.0 8.0
0.08163603794874319 12.24354429977017 1.0 8.0 8.0
0.0814893696080109 12.044833433313553 1.0 8.0 8.0
0.08143502132004155 12.075515034859292 1.0 8.0 8.0
0.08129528459475521 12.163605130500622 1.0 8.0 8.0
0.08122164063435022 12.142276662551428 1.0 8.0 8.0
0.08120444269635185 12.073243691858387 1.0 8.0 8.0
0.08122302325930231 12.02527763286944 1.0 8.0 8.0
0.08124483242971281 12.036711495837753 1.0 8.0 8.0
0.08129610223721828 12.015013839863212 1.0 8.0 8.0
0.0813448863615519 11.997074036002353 1.0 8.0 8.0
0.08139227625057288 11.975709917419726 1.0 8.0 8.0
0.08146139290320842 11.948020719651064 1.0 8.0 8.0
0.08154167249731792 11.920636819064848 1.0 8.0 8.0
0.0815294043137259 11.915630917432438 1.0 8.0 8.0
0.08159248770888172 11.893703916192296 1.0 8.0 8.0
0.08165730442659136 11.864885952672065 1.0 8.0 8.0
U dimensions = (906, 36)
Iteration 0 of 1
phi.shape: (50, 906)
U.shape: (906, 36)
phi.dot(U).T shape: (36, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800169.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800169_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800169_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800169_test_data.npy
Cleanup complete.

Simulation 1/10 score: 0.6172717806308563
Running repeat 2/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800217.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_1804158_1741800217'
Loaded dataset: downsampled_1000genes_1804158_1741800217
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.16266836691549147 5.9046022047684525 1.0 8.0 8.0
0.08426786067879233 11.010577908884613 1.0 8.0 8.0
0.08258201798934317 10.82777256242256 1.0 8.0 8.0
0.08198390037425574 10.717351155563914 1.0 8.0 8.0
0.08184262586997193 10.531047545505789 1.0 8.0 8.0
0.08160720500263774 10.530020231268484 1.0 8.0 8.0
0.08125687930047809 10.544818970716346 1.0 8.0 8.0
0.08113210742357357 10.537277668094207 1.0 8.0 8.0
0.08114287774355178 10.43465535046355 1.0 8.0 8.0
0.0811331711711315 10.36025109939075 1.0 8.0 8.0
0.08110534751332399 10.360293890442284 1.0 8.0 8.0
0.08102008278478467 10.375333606699055 1.0 8.0 8.0
0.08101703119160952 10.363787455463342 1.0 8.0 8.0
0.08104181777070774 10.341082218993291 1.0 8.0 8.0
0.08104082675818292 10.366529160544108 1.0 8.0 8.0
0.08104034595138354 10.371952252386912 1.0 8.0 8.0
0.08103976670072532 10.381271094181491 1.0 8.0 8.0
0.08103996848902162 10.381133358321808 1.0 8.0 8.0
0.08104024921968889 10.378979739908504 1.0 8.0 8.0
0.08104023876512734 10.378964149971088 1.0 8.0 8.0
U dimensions = (906, 33)
Iteration 0 of 1
phi.shape: (50, 906)
U.shape: (906, 33)
phi.dot(U).T shape: (33, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800217.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800217_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800217_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800217_test_data.npy
Cleanup complete.

Simulation 2/10 score: 0.7163910994262211
Running repeat 3/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800265.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_1804158_1741800265'
Loaded dataset: downsampled_1000genes_1804158_1741800265
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.18114567476093824 5.955512848927453 1.0 8.0 8.0
0.08981104738227375 13.428729338253117 1.0 8.0 8.0
0.08568452098871238 12.651660444298324 1.0 8.0 8.0
0.08363045193343688 12.724010969033298 1.0 8.0 8.0
0.0829813400041094 12.4778512826277 1.0 8.0 8.0
0.08289408528619613 12.287578098121388 1.0 8.0 8.0
0.08295161930411632 12.18066278391379 1.0 8.0 8.0
0.0830482744424963 12.061577948476355 1.0 8.0 8.0
0.08311287322399241 12.032081354838962 1.0 8.0 8.0
0.08315209098551735 12.03695063487102 1.0 8.0 8.0
0.08312712997089278 12.031404173043416 1.0 8.0 8.0
0.08314835548209865 12.025590262525231 1.0 8.0 8.0
0.0831734893158449 12.021658177418274 1.0 8.0 8.0
0.08317636609108248 12.021123454422044 1.0 8.0 8.0
0.0831756293836936 12.020700193699422 1.0 8.0 8.0
0.08317570234823857 12.020682373390231 1.0 8.0 8.0
0.08317570322513568 12.020681293808751 1.0 8.0 8.0
0.08317570322368728 12.020681234528835 1.0 8.0 8.0
0.0831757032230298 12.020681230750299 1.0 8.0 8.0
0.08317570322299161 12.020681230510842 1.0 8.0 8.0
U dimensions = (906, 37)
Iteration 0 of 1
phi.shape: (50, 906)
U.shape: (906, 37)
phi.dot(U).T shape: (37, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800265.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800265_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800265_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800265_test_data.npy
Cleanup complete.

Simulation 3/10 score: 0.740480944948278
Running repeat 4/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800320.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_1804158_1741800320'
Loaded dataset: downsampled_1000genes_1804158_1741800320
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.17148586436038138 6.306518040115524 1.0 8.0 8.0
0.08320537460813204 12.459844304331373 1.0 8.0 8.0
0.08206881540868027 11.705476584843392 1.0 8.0 8.0
0.08161934828304385 11.624067064663585 1.0 8.0 8.0
0.08150530701735204 11.633751009306605 1.0 8.0 8.0
0.08153232171450175 11.599254363797295 1.0 8.0 8.0
0.08145158171229261 11.612508713805656 1.0 8.0 8.0
0.08135183491473896 11.629997534478985 1.0 8.0 8.0
0.08107324135642124 11.66802509244096 1.0 8.0 8.0
0.08087528216132212 11.654035029856184 1.0 8.0 8.0
0.08083943536203719 11.647369631894474 1.0 8.0 8.0
0.08080790843334396 11.64964705167766 1.0 8.0 8.0
0.08076021643705056 11.655005566990612 1.0 8.0 8.0
0.08069503072114104 11.673482249257301 1.0 8.0 8.0
0.08067221723356599 11.676432907854934 1.0 8.0 8.0
0.08068846756738646 11.673632187521333 1.0 8.0 8.0
0.08066779187449458 11.66810959323415 1.0 8.0 8.0
0.08069057222854792 11.661667426005925 1.0 8.0 8.0
0.08070697310930053 11.629956410852769 1.0 8.0 8.0
0.08074187361935481 11.608483011127353 1.0 8.0 8.0
U dimensions = (906, 35)
Iteration 0 of 1
phi.shape: (50, 906)
U.shape: (906, 35)
phi.dot(U).T shape: (35, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800320.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800320_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800320_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800320_test_data.npy
Cleanup complete.

Simulation 4/10 score: 0.6635054615768723
Running repeat 5/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800374.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_1804158_1741800374'
Loaded dataset: downsampled_1000genes_1804158_1741800374
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.15237153828488736 5.554543726677949 1.0 8.0 8.0
0.0816646143480445 11.946958936527711 1.0 8.0 8.0
0.08008304678282185 11.070333205548215 1.0 8.0 8.0
0.07942290389523632 10.953921221050702 1.0 8.0 8.0
0.07913566695913532 10.948330089263642 1.0 8.0 8.0
0.0788281648787964 10.994686972503459 1.0 8.0 8.0
0.07841765606566731 11.05443926289463 1.0 8.0 8.0
0.07811929748911706 11.148624689062252 1.0 8.0 8.0
0.07782087587243536 11.14916156738892 1.0 8.0 8.0
0.07743003542825921 11.175483935571792 1.0 8.0 8.0
0.07731244525900427 11.133587994167817 1.0 8.0 8.0
0.077278370233549 11.184130689943698 1.0 8.0 8.0
0.07724448920148974 11.20649125417439 1.0 8.0 8.0
0.07726195439036276 11.229752928093488 1.0 8.0 8.0
0.07726958503608283 11.241019298262632 1.0 8.0 8.0
0.07728473998641883 11.239540249123191 1.0 8.0 8.0
0.07731302504580262 11.232264311703831 1.0 8.0 8.0
0.07732926490023073 11.230061805625908 1.0 8.0 8.0
0.07736432652810776 11.23033957547833 1.0 8.0 8.0
0.07742964997130142 11.207892084269881 1.0 8.0 8.0
U dimensions = (906, 34)
Iteration 0 of 1
phi.shape: (50, 906)
U.shape: (906, 34)
phi.dot(U).T shape: (34, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800374.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800374_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800374_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800374_test_data.npy
Cleanup complete.

Simulation 5/10 score: 0.6718694720649695
Running repeat 6/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800427.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_1804158_1741800427'
Loaded dataset: downsampled_1000genes_1804158_1741800427
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.1891641852792092 5.9928674657633865 1.0 8.0 8.0
0.08210510956296535 12.965412549756563 1.0 8.0 8.0
0.08193985856940045 12.59463237908214 1.0 8.0 8.0
0.08181781148505163 12.51042484851095 1.0 8.0 8.0
0.08164674803919492 12.233194166062775 1.0 8.0 8.0
0.08150972055548145 12.144738736380097 1.0 8.0 8.0
0.08144852780636691 12.116039132158305 1.0 8.0 8.0
0.08142689075253184 12.074692281948275 1.0 8.0 8.0
0.08122536352461385 12.05776074768886 1.0 8.0 8.0
0.08100144292296196 12.033062165862972 1.0 8.0 8.0
0.08088740718798171 12.005301844796072 1.0 8.0 8.0
0.08092502238123567 11.956778989930655 1.0 8.0 8.0
0.0809838461223501 11.914923323990772 1.0 8.0 8.0
0.08101202665824558 11.860385528516804 1.0 8.0 8.0
0.08090094780539614 11.87276128592942 1.0 8.0 8.0
0.08058449793111022 11.88894453366894 1.0 8.0 8.0
0.08033862360391242 11.87340583372379 1.0 8.0 8.0
0.08028228457934994 11.877597188223678 1.0 8.0 8.0
0.08025803379443364 11.878675076928658 1.0 8.0 8.0
0.0802311762450677 11.876184364462997 1.0 8.0 8.0
U dimensions = (906, 35)
Iteration 0 of 1
phi.shape: (50, 906)
U.shape: (906, 35)
phi.dot(U).T shape: (35, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800427.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800427_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800427_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800427_test_data.npy
Cleanup complete.

Simulation 6/10 score: 0.7575644718261437
Running repeat 7/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800482.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_1804158_1741800482'
Loaded dataset: downsampled_1000genes_1804158_1741800482
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.17515978419563383 6.007923505949105 1.0 8.0 8.0
0.07994117489491959 12.362624487436705 1.0 8.0 8.0
0.07906331361386743 11.881018457531445 1.0 8.0 8.0
0.07902327182345836 11.241919569120892 1.0 8.0 8.0
0.0791618050491748 11.099324037756407 1.0 8.0 8.0
0.07919951716823304 11.055870286122758 1.0 8.0 8.0
0.07911364836513957 11.00644716172981 1.0 8.0 8.0
0.07915185048064188 10.860690741252816 1.0 8.0 8.0
0.07928781165921461 10.738443799196942 1.0 8.0 8.0
0.0792168963926847 10.712656363945982 1.0 8.0 8.0
0.07915602330555915 10.735237916348899 1.0 8.0 8.0
0.0791408871372401 10.73418924223125 1.0 8.0 8.0
0.07913534907737652 10.72373516680529 1.0 8.0 8.0
0.079136513548976 10.71513642918535 1.0 8.0 8.0
0.07912687403217478 10.704127813336475 1.0 8.0 8.0
0.0791132135799647 10.7081858175814 1.0 8.0 8.0
0.07910686599860384 10.708301874311259 1.0 8.0 8.0
0.07910704168179294 10.709369521946707 1.0 8.0 8.0
0.0791070432343366 10.70950724966138 1.0 8.0 8.0
0.07910704341953811 10.709512966812923 1.0 8.0 8.0
U dimensions = (906, 38)
Iteration 0 of 1
phi.shape: (50, 906)
U.shape: (906, 38)
phi.dot(U).T shape: (38, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800482.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800482_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800482_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800482_test_data.npy
Cleanup complete.

Simulation 7/10 score: 0.7634068803710498
Running repeat 8/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800539.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_1804158_1741800539'
Loaded dataset: downsampled_1000genes_1804158_1741800539
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.1624529144266279 5.9751205766189335 1.0 8.0 8.0
0.08335248820543062 12.883144602547736 1.0 8.0 8.0
0.0823582068316947 12.417818198609476 1.0 8.0 8.0
0.08177352386486059 12.306092278719671 1.0 8.0 8.0
0.08158186359166253 12.136295844729904 1.0 8.0 8.0
0.08144528300099763 12.039498696649085 1.0 8.0 8.0
0.08122750904801923 12.001880397231188 1.0 8.0 8.0
0.08105267477090083 11.906665937117287 1.0 8.0 8.0
0.08101011679685088 11.864658045444505 1.0 8.0 8.0
0.08092584677932435 11.874060573462215 1.0 8.0 8.0
0.0808519901454946 11.890870123950622 1.0 8.0 8.0
0.08075378246972542 11.90553518418187 1.0 8.0 8.0
0.08069239731400824 11.915119114753978 1.0 8.0 8.0
0.08065128515713227 11.921104621772281 1.0 8.0 8.0
0.08064241848101361 11.92134828548181 1.0 8.0 8.0
0.08057626806548002 11.930507897201272 1.0 8.0 8.0
0.08051721589411232 11.937459795482047 1.0 8.0 8.0
0.08048874313422505 11.93893308504343 1.0 8.0 8.0
0.08047342954437176 11.93867173243894 1.0 8.0 8.0
0.08045503189421654 11.879739304602039 1.0 8.0 8.0
U dimensions = (906, 37)
Iteration 0 of 1
phi.shape: (50, 906)
U.shape: (906, 37)
phi.dot(U).T shape: (37, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800539.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800539_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800539_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800539_test_data.npy
Cleanup complete.

Simulation 8/10 score: 0.7536099883459695
Running repeat 9/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800593.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_1804158_1741800593'
Loaded dataset: downsampled_1000genes_1804158_1741800593
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.18879275257813755 5.874347601240176 1.0 8.0 8.0
0.08583913912598073 12.544142638324786 1.0 8.0 8.0
0.08347473256498161 12.368862933799374 1.0 8.0 8.0
0.08202424873039493 12.12693603258277 1.0 8.0 8.0
0.08118836951975583 12.091185563539568 1.0 8.0 8.0
0.08070673176194898 12.049100476914573 1.0 8.0 8.0
0.0802090405182243 12.037152175115066 1.0 8.0 8.0
0.08000462514398954 12.007414136492118 1.0 8.0 8.0
0.08004405356554434 11.967167570787929 1.0 8.0 8.0
0.08015582866191029 11.891523507187573 1.0 8.0 8.0
0.08024031677495047 11.86556918230202 1.0 8.0 8.0
0.08031237044974793 11.805129657408301 1.0 8.0 8.0
0.08027022978608556 11.816401966980777 1.0 8.0 8.0
0.08013756180527642 11.777409463685409 1.0 8.0 8.0
0.08005972079432733 11.78536609555771 1.0 8.0 8.0
0.07999159826166702 11.808673447039993 1.0 8.0 8.0
0.07985981680890175 11.8224177684281 1.0 8.0 8.0
0.0797826322283316 11.816187406390531 1.0 8.0 8.0
0.07976356322461653 11.803122280605045 1.0 8.0 8.0
0.07973365867896287 11.79930449650823 1.0 8.0 8.0
U dimensions = (906, 34)
Iteration 0 of 1
phi.shape: (50, 906)
U.shape: (906, 34)
phi.dot(U).T shape: (34, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800593.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800593_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800593_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800593_test_data.npy
Cleanup complete.

Simulation 9/10 score: 0.6954338125001049
Running repeat 10/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800647.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_1804158_1741800647'
Loaded dataset: downsampled_1000genes_1804158_1741800647
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.18891514493471961 6.3111794282120055 1.0 8.0 8.0
0.08548078025399553 12.709627732690956 1.0 8.0 8.0
0.08372294199173436 11.687116455738414 1.0 8.0 8.0
0.0830011986950493 11.810024484012045 1.0 8.0 8.0
0.08266865519788702 11.990521030811811 1.0 8.0 8.0
0.08273039829231044 11.851255373855833 1.0 8.0 8.0
0.08282240935042218 11.923378025382874 1.0 8.0 8.0
0.08272557142905801 11.994214945030794 1.0 8.0 8.0
0.08235297886377957 12.055195681429502 1.0 8.0 8.0
0.08216581213165086 12.085150731649076 1.0 8.0 8.0
0.0819823175800024 12.113595066180046 1.0 8.0 8.0
0.08184050160030709 12.115002374503245 1.0 8.0 8.0
0.08176543470357212 12.090905628778788 1.0 8.0 8.0
0.08166345109826278 11.944244831684651 1.0 8.0 8.0
0.08169332279869812 11.90879088343649 1.0 8.0 8.0
0.0817166801826682 11.899580967486887 1.0 8.0 8.0
0.08177556889581727 11.881470597185539 1.0 8.0 8.0
0.08183533598658999 11.845019071786702 1.0 8.0 8.0
0.0818786266255842 11.80064944672551 1.0 8.0 8.0
0.08194991623447867 11.746517520122547 1.0 8.0 8.0
U dimensions = (906, 37)
Iteration 0 of 1
phi.shape: (50, 906)
U.shape: (906, 37)
phi.dot(U).T shape: (37, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800647.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800647_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800647_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804158_1741800647_test_data.npy
Cleanup complete.

Simulation 10/10 score: 0.7446196855166638
Results saved: results/simulation/results_optimal.csv
Running simulation with: num_measurements=50, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=5000
Running repeat 1/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800165.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_125569_1741800165'
Loaded dataset: downsampled_5000genes_125569_1741800165
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.35078295219128175 11.35757033916142 1.0 8.0 8.0
0.290013370350929 19.607917550918746 1.0 8.0 8.0
0.29523384597615465 16.64118811238144 1.0 8.0 8.0
0.2971354208404051 16.543086876892048 1.0 8.0 8.0
0.29818121681890475 16.740538077539647 1.0 8.0 8.0
0.2984474681139192 16.415837041648704 1.0 8.0 8.0
0.29864157289568405 16.210300217555783 1.0 8.0 8.0
0.29886864720639117 16.210664861523576 1.0 8.0 8.0
0.29904779835542017 16.250315834332977 1.0 8.0 8.0
0.299446284970163 16.328913048955084 1.0 8.0 8.0
0.29966070303958436 16.45788450394188 1.0 8.0 8.0
0.29968947364216414 16.396973523817717 1.0 8.0 8.0
0.29969493454343754 16.39099413387219 1.0 8.0 8.0
0.2996994617976846 16.43425217793749 1.0 8.0 8.0
0.29968860422042076 16.40736361341105 1.0 8.0 8.0
0.29967115500622554 16.40848560229034 1.0 8.0 8.0
0.29965858737715956 16.41143083483932 1.0 8.0 8.0
0.2996549358149604 16.412363297719214 1.0 8.0 8.0
0.299645986737473 16.412773198284622 1.0 8.0 8.0
0.2996460144322892 16.412666061894452 1.0 8.0 8.0
U dimensions = (4971, 35)
Iteration 0 of 1
phi.shape: (50, 4971)
U.shape: (4971, 35)
phi.dot(U).T shape: (35, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800165.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800165_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800165_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800165_test_data.npy
Cleanup complete.

Simulation 1/10 score: 0.5962823681327634
Running repeat 2/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800231.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_125569_1741800231'
Loaded dataset: downsampled_5000genes_125569_1741800231
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3772431700410577 11.29862386655306 1.0 8.0 8.0
0.2804364798948217 20.496395420290032 1.0 8.0 8.0
0.29193755724663795 16.599004862682666 1.0 8.0 8.0
0.29772426959144205 16.749755719351093 1.0 8.0 8.0
0.29918232562491365 17.039768668102425 1.0 8.0 8.0
0.29948849723054083 16.79653105485666 1.0 8.0 8.0
0.2996568688208511 16.760537248667195 1.0 8.0 8.0
0.2997859353269763 16.768765790414214 1.0 8.0 8.0
0.30001228714416206 16.774746215723315 1.0 8.0 8.0
0.30014554497416235 16.69898740649855 1.0 8.0 8.0
0.3002915644834243 16.69748678174286 1.0 8.0 8.0
0.30050841402401895 16.708293437374696 1.0 8.0 8.0
0.30085844583889865 16.729813697222486 1.0 8.0 8.0
0.3009872349101149 16.640001123449963 1.0 8.0 8.0
0.3009891010574962 16.62085155699354 1.0 8.0 8.0
0.3009870524484337 16.617331263822468 1.0 8.0 8.0
0.3009865946166923 16.61240367778395 1.0 8.0 8.0
0.3009863398236514 16.614383370005008 1.0 8.0 8.0
0.30098427410981266 16.608754369282384 1.0 8.0 8.0
0.3009823080399441 16.60307966263637 1.0 8.0 8.0
U dimensions = (4971, 37)
Iteration 0 of 1
phi.shape: (50, 4971)
U.shape: (4971, 37)
phi.dot(U).T shape: (37, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800231.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800231_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800231_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800231_test_data.npy
Cleanup complete.

Simulation 2/10 score: 0.5989035198993212
Running repeat 3/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800297.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_125569_1741800297'
Loaded dataset: downsampled_5000genes_125569_1741800297
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.36143211321023894 11.471685051350518 1.0 8.0 8.0
0.2880223284317579 20.665609763554034 1.0 8.0 8.0
0.29611221337698845 18.115114194352522 1.0 8.0 8.0
0.29810345619388334 18.050761576168885 1.0 8.0 8.0
0.29849098150220965 17.7288459126465 1.0 8.0 8.0
0.2987230694145512 17.783857093704004 1.0 8.0 8.0
0.29888804964660354 17.68553880625375 1.0 8.0 8.0
0.29901676714769243 17.709955738009867 1.0 8.0 8.0
0.2991076212710829 17.63348046070135 1.0 8.0 8.0
0.2990810359789464 17.870130599571247 1.0 8.0 8.0
0.29900902805898966 17.93998305669091 1.0 8.0 8.0
0.2989635229800983 17.90379513592455 1.0 8.0 8.0
0.2988815378672518 17.935874582379036 1.0 8.0 8.0
0.2987229339789048 17.93809982241572 1.0 8.0 8.0
0.29854668232504933 18.003213418556584 1.0 8.0 8.0
0.29848761161791226 18.021699100835473 1.0 8.0 8.0
0.2984698290148309 17.99680287510418 1.0 8.0 8.0
0.2984446664215529 18.01577939674108 1.0 8.0 8.0
0.2983632199837043 18.10262705394305 1.0 8.0 8.0
0.29832555201912037 18.069104866454065 1.0 8.0 8.0
U dimensions = (4971, 31)
Iteration 0 of 1
phi.shape: (50, 4971)
U.shape: (4971, 31)
phi.dot(U).T shape: (31, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800297.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800297_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800297_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800297_test_data.npy
Cleanup complete.

Simulation 3/10 score: 0.6265948348804771
Running repeat 4/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800364.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_125569_1741800364'
Loaded dataset: downsampled_5000genes_125569_1741800364
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3549304031362016 12.136704419304234 1.0 8.0 8.0
0.287045445436386 19.381775500244448 1.0 8.0 8.0
0.2933810530019455 16.467446575015398 1.0 8.0 8.0
0.2955020070513732 16.396678613866257 1.0 8.0 8.0
0.2964669405388546 16.715066140459065 1.0 8.0 8.0
0.29736546289295007 16.64343227564369 1.0 8.0 8.0
0.2980880857292161 16.85836220897353 1.0 8.0 8.0
0.2986882067209219 16.79043952765082 1.0 8.0 8.0
0.2989549184031155 16.66141620229834 1.0 8.0 8.0
0.2991477642954865 16.590967719243118 1.0 8.0 8.0
0.2992249329769918 16.55695557031025 1.0 8.0 8.0
0.29921486491036187 16.54063731203422 1.0 8.0 8.0
0.2992126234339483 16.531294568624773 1.0 8.0 8.0
0.2992090766617207 16.535151829299547 1.0 8.0 8.0
0.2992086373850529 16.53455828477679 1.0 8.0 8.0
0.2992083134789574 16.536846042080015 1.0 8.0 8.0
0.29920825995056255 16.53743111033522 1.0 8.0 8.0
0.2992076808734302 16.534111942043126 1.0 8.0 8.0
0.29920763398480077 16.532325026926554 1.0 8.0 8.0
0.29920724195794135 16.52652857520151 1.0 8.0 8.0
U dimensions = (4971, 36)
Iteration 0 of 1
phi.shape: (50, 4971)
U.shape: (4971, 36)
phi.dot(U).T shape: (36, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800364.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800364_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800364_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800364_test_data.npy
Cleanup complete.

Simulation 4/10 score: 0.6152935163429589
Running repeat 5/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800431.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_125569_1741800431'
Loaded dataset: downsampled_5000genes_125569_1741800431
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3556007302730576 10.96883349691769 1.0 8.0 8.0
0.29034862360480385 20.41536894856705 1.0 8.0 8.0
0.296637149504801 17.886147919147643 1.0 8.0 8.0
0.29710900261235795 17.025319161226303 1.0 8.0 8.0
0.29756711190798657 16.89488534533 1.0 8.0 8.0
0.29733137362837336 16.82681898882423 1.0 8.0 8.0
0.2973958588881358 16.726297104553133 1.0 8.0 8.0
0.2975227921002638 16.678358539450933 1.0 8.0 8.0
0.2976318738786382 16.675598385901413 1.0 8.0 8.0
0.297651676349039 16.66817516478772 1.0 8.0 8.0
0.2976501144164212 16.656444634301234 1.0 8.0 8.0
0.2976482346271153 16.643155579176433 1.0 8.0 8.0
0.29764712397210036 16.641114455116853 1.0 8.0 8.0
0.2976464918901224 16.653163571134783 1.0 8.0 8.0
0.29764604681515283 16.65291388460663 1.0 8.0 8.0
0.2976452349046844 16.66850161650416 1.0 8.0 8.0
0.2976436813945321 16.684489890538966 1.0 8.0 8.0
0.29764249527118425 16.69050044950524 1.0 8.0 8.0
0.29764179449321715 16.695782759788145 1.0 8.0 8.0
0.2976365622761926 16.703578029884603 1.0 8.0 8.0
U dimensions = (4971, 35)
Iteration 0 of 1
phi.shape: (50, 4971)
U.shape: (4971, 35)
phi.dot(U).T shape: (35, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800431.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800431_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800431_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800431_test_data.npy
Cleanup complete.

Simulation 5/10 score: 0.6699653715102319
Running repeat 6/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800496.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_125569_1741800496'
Loaded dataset: downsampled_5000genes_125569_1741800496
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3528304292006593 11.142808695001003 1.0 8.0 8.0
0.2875247800924432 19.117439701899258 1.0 8.0 8.0
0.294842843748207 16.41702282005547 1.0 8.0 8.0
0.29600031891298384 16.191517188153554 1.0 8.0 8.0
0.2966785292916577 16.11148543240717 1.0 8.0 8.0
0.2971850012521462 16.16797963257419 1.0 8.0 8.0
0.29743808293821694 16.261892070431262 1.0 8.0 8.0
0.29786840270170334 16.17901444541245 1.0 8.0 8.0
0.29799219688646517 16.18669570110817 1.0 8.0 8.0
0.2981218201962609 16.066558903247977 1.0 8.0 8.0
0.29847102116394164 15.837008883564257 1.0 8.0 8.0
0.29859791804863445 15.780984985663883 1.0 8.0 8.0
0.29856631812899415 15.817191366659586 1.0 8.0 8.0
0.2985532387224713 15.82519779915311 1.0 8.0 8.0
0.29848127384324086 15.841822705936494 1.0 8.0 8.0
0.2984552006808451 15.727448211242548 1.0 8.0 8.0
0.2984467124251765 15.733951836723522 1.0 8.0 8.0
0.2984403543174684 15.740747743800526 1.0 8.0 8.0
0.29844086143294335 15.74230466152266 1.0 8.0 8.0
0.29844077972240757 15.74219621142898 1.0 8.0 8.0
U dimensions = (4971, 33)
Iteration 0 of 1
phi.shape: (50, 4971)
U.shape: (4971, 33)
phi.dot(U).T shape: (33, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800496.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800496_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800496_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800496_test_data.npy
Cleanup complete.

Simulation 6/10 score: 0.6001201410868572
Running repeat 7/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800566.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_125569_1741800566'
Loaded dataset: downsampled_5000genes_125569_1741800566
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3589028547037837 12.056725231196745 1.0 8.0 8.0
0.2865929392412574 20.060860910344008 1.0 8.0 8.0
0.29641582893652785 17.23295144745833 1.0 8.0 8.0
0.29825632041855543 16.88659499823214 1.0 8.0 8.0
0.299103136848615 16.974065794139737 1.0 8.0 8.0
0.2992280917521969 17.093688720718472 1.0 8.0 8.0
0.2988808671045635 17.253114457207385 1.0 8.0 8.0
0.2985731893917196 17.19603265478549 1.0 8.0 8.0
0.29863467971576363 17.08036340867055 1.0 8.0 8.0
0.2986238506645401 16.836114366234256 1.0 8.0 8.0
0.2985833930417633 16.864103097671066 1.0 8.0 8.0
0.2985637915295216 16.906317993782263 1.0 8.0 8.0
0.29856842240946346 16.964762811101465 1.0 8.0 8.0
0.29855730240146694 16.967263840349478 1.0 8.0 8.0
0.29855705580352865 16.96533542597979 1.0 8.0 8.0
0.29855827928949186 16.962613151351217 1.0 8.0 8.0
0.2985706038925997 16.95563344998574 1.0 8.0 8.0
0.2985815648260338 16.94575971009118 1.0 8.0 8.0
0.29860885099981704 16.905664126738852 1.0 8.0 8.0
0.2986090408718979 16.907545506384842 1.0 8.0 8.0
U dimensions = (4971, 36)
Iteration 0 of 1
phi.shape: (50, 4971)
U.shape: (4971, 36)
phi.dot(U).T shape: (36, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800566.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800566_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800566_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800566_test_data.npy
Cleanup complete.

Simulation 7/10 score: 0.5838857363092669
Running repeat 8/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800630.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_125569_1741800630'
Loaded dataset: downsampled_5000genes_125569_1741800630
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.378032691732209 11.716660349321835 1.0 8.0 8.0
0.2843876904032844 20.834177868205053 1.0 8.0 8.0
0.28910768995977 17.401769966712944 1.0 8.0 8.0
0.29538590461543424 16.540385821290375 1.0 8.0 8.0
0.29732196532963506 16.362008622819577 1.0 8.0 8.0
0.29836158075102615 16.319527422051728 1.0 8.0 8.0
0.2988224312140495 16.16749116493326 1.0 8.0 8.0
0.29905131516665484 16.014130990283956 1.0 8.0 8.0
0.2992491859743176 15.875881569918315 1.0 8.0 8.0
0.29920309435649206 15.983278536954352 1.0 8.0 8.0
0.29913391219304786 15.775498507827267 1.0 8.0 8.0
0.2990653302581123 15.953441285012438 1.0 8.0 8.0
0.29895939501722435 15.79920363810836 1.0 8.0 8.0
0.2986131757241305 15.930564076920737 1.0 8.0 8.0
0.29847289833283774 16.025186397346268 1.0 8.0 8.0
0.29841141465338583 15.963515084910897 1.0 8.0 8.0
0.29832803992567347 15.940202697056852 1.0 8.0 8.0
0.2983160230867936 15.922573643866997 1.0 8.0 8.0
0.2983151241327082 15.911626712861423 1.0 8.0 8.0
0.29832728006410814 15.897295794658753 1.0 8.0 8.0
U dimensions = (4971, 36)
Iteration 0 of 1
phi.shape: (50, 4971)
U.shape: (4971, 36)
phi.dot(U).T shape: (36, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800630.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800630_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800630_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800630_test_data.npy
Cleanup complete.

Simulation 8/10 score: 0.6441874776322412
Running repeat 9/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800693.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_125569_1741800693'
Loaded dataset: downsampled_5000genes_125569_1741800693
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3548506281458904 10.38574849152365 1.0 8.0 8.0
0.28813603047153 19.144424541916784 1.0 8.0 8.0
0.29586500689030015 17.209813172732826 1.0 8.0 8.0
0.29820229928335795 16.844489276993603 1.0 8.0 8.0
0.299474897452521 16.460803250464775 1.0 8.0 8.0
0.29975873976341905 16.46752120404708 1.0 8.0 8.0
0.29987697654850753 16.46890473982103 1.0 8.0 8.0
0.29992242839142 16.454995755221496 1.0 8.0 8.0
0.2996997880067941 16.576761319268 1.0 8.0 8.0
0.2992190822191043 16.636630449484425 1.0 8.0 8.0
0.2991649577619996 16.669868770370062 1.0 8.0 8.0
0.2991613035185591 16.682445862926773 1.0 8.0 8.0
0.29914793395977035 16.679245875298047 1.0 8.0 8.0
0.29914062791138174 16.677941679777597 1.0 8.0 8.0
0.29913724915869244 16.674057908266434 1.0 8.0 8.0
0.2991368807744854 16.67219566406556 1.0 8.0 8.0
0.2991356856659586 16.672771646488584 1.0 8.0 8.0
0.29912819945517255 16.66162861270769 1.0 8.0 8.0
0.2991231190215432 16.653747149498727 1.0 8.0 8.0
0.29912055334791554 16.648556721676986 1.0 8.0 8.0
U dimensions = (4971, 35)
Iteration 0 of 1
phi.shape: (50, 4971)
U.shape: (4971, 35)
phi.dot(U).T shape: (35, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800693.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800693_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800693_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800693_test_data.npy
Cleanup complete.

Simulation 9/10 score: 0.6618872093714971
Running repeat 10/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800757.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_125569_1741800757'
Loaded dataset: downsampled_5000genes_125569_1741800757
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.343655222168887 10.449880803918429 1.0 8.0 8.0
0.2909911281314157 17.901410836448214 1.0 8.0 8.0
0.2960369234743805 16.39008774720966 1.0 8.0 8.0
0.2972738047082756 16.6726830455528 1.0 8.0 8.0
0.29827971015915955 16.642996247656743 1.0 8.0 8.0
0.2983927504438689 16.593339889657734 1.0 8.0 8.0
0.298168539158306 16.595939559197905 1.0 8.0 8.0
0.29802802860514954 16.62433383007082 1.0 8.0 8.0
0.29783316884763456 16.615400980753854 1.0 8.0 8.0
0.29777489153951187 16.60419410827692 1.0 8.0 8.0
0.2977509418352511 16.620266257158214 1.0 8.0 8.0
0.29772831832448576 16.596216435944772 1.0 8.0 8.0
0.297611804271914 16.648862868433344 1.0 8.0 8.0
0.2975098532827527 16.715184217783257 1.0 8.0 8.0
0.29743015633576886 16.72714348255949 1.0 8.0 8.0
0.2973855571549384 16.739407491488002 1.0 8.0 8.0
0.2973617874647986 16.754930600484307 1.0 8.0 8.0
0.2973314095346139 16.75116553931975 1.0 8.0 8.0
0.29732479552968927 16.753547783212053 1.0 8.0 8.0
0.2972751463993575 16.74993735788501 1.0 8.0 8.0
U dimensions = (4971, 35)
Iteration 0 of 1
phi.shape: (50, 4971)
U.shape: (4971, 35)
phi.dot(U).T shape: (35, 50)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800757.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800757_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800757_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_125569_1741800757_test_data.npy
Cleanup complete.

Simulation 10/10 score: 0.622400572139107
Results saved: results/simulation/results_optimal.csv
Running simulation with: num_measurements=75, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=1000
Running repeat 1/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800540.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_125668_1741800540'
Loaded dataset: downsampled_1000genes_125668_1741800540
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.19573253578727567 5.288167260985973 1.0 8.0 8.0
0.08488158204320184 13.25600216606235 1.0 8.0 8.0
0.08261627191695153 12.536632723976842 1.0 8.0 8.0
0.08131089425765325 12.15603419273247 1.0 8.0 8.0
0.08100957250178609 11.971607742899321 1.0 8.0 8.0
0.08072929183477917 11.952138717978778 1.0 8.0 8.0
0.08054001660926235 11.938049983102719 1.0 8.0 8.0
0.08057178886568606 11.902721914353872 1.0 8.0 8.0
0.08053116570320151 11.895390100875707 1.0 8.0 8.0
0.08043252334621542 11.847951639166832 1.0 8.0 8.0
0.08034411641782246 11.807010170404022 1.0 8.0 8.0
0.08023587537934362 11.784337537955519 1.0 8.0 8.0
0.08031119095782946 11.745177378078258 1.0 8.0 8.0
0.08037187917897504 11.732243588329931 1.0 8.0 8.0
0.08038313330515368 11.718596854235097 1.0 8.0 8.0
0.08037441773036336 11.720783166872078 1.0 8.0 8.0
0.08037733907989142 11.72262236792091 1.0 8.0 8.0
0.08036852473401601 11.725094164890585 1.0 8.0 8.0
0.08036589462367838 11.726468133674214 1.0 8.0 8.0
0.0803630532654871 11.727036568703957 1.0 8.0 8.0
U dimensions = (906, 35)
Iteration 0 of 1
phi.shape: (75, 906)
U.shape: (906, 35)
phi.dot(U).T shape: (35, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800540.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800540_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800540_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800540_test_data.npy
Cleanup complete.

Simulation 1/10 score: 0.7968021111755911
Running repeat 2/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800578.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_125668_1741800578'
Loaded dataset: downsampled_1000genes_125668_1741800578
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.18845167060345946 5.4192896287308905 1.0 8.0 8.0
0.08746245275910614 13.817615745121046 1.0 8.0 8.0
0.08457558526499331 12.959952666749283 1.0 8.0 8.0
0.083739945626092 12.569641381249758 1.0 8.0 8.0
0.0833812829789774 12.506598668207504 1.0 8.0 8.0
0.08315773274621574 12.478770883883847 1.0 8.0 8.0
0.08302681396218436 12.498435098359337 1.0 8.0 8.0
0.08290789349763072 12.569043520857713 1.0 8.0 8.0
0.08278806036264652 12.615811740034955 1.0 8.0 8.0
0.08272073291568915 12.620725464839973 1.0 8.0 8.0
0.0826944873442691 12.625596032204331 1.0 8.0 8.0
0.08267907223972215 12.628811160991061 1.0 8.0 8.0
0.08268767741534 12.629911301116206 1.0 8.0 8.0
0.08269352563162746 12.620351424924847 1.0 8.0 8.0
0.08268066779888716 12.623587843262488 1.0 8.0 8.0
0.08268509847951122 12.62370219556583 1.0 8.0 8.0
0.08269539074242938 12.6237041323281 1.0 8.0 8.0
0.08270028720541589 12.625814492430994 1.0 8.0 8.0
0.08270583907956108 12.625641819933307 1.0 8.0 8.0
0.08271012177812231 12.625297580194164 1.0 8.0 8.0
U dimensions = (906, 35)
Iteration 0 of 1
phi.shape: (75, 906)
U.shape: (906, 35)
phi.dot(U).T shape: (35, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800578.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800578_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800578_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800578_test_data.npy
Cleanup complete.

Simulation 2/10 score: 0.8202779284957371
Running repeat 3/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800616.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_125668_1741800616'
Loaded dataset: downsampled_1000genes_125668_1741800616
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.1510303458540766 5.629133028638815 nan 8.0 8.0
0.07636591389511238 11.340660459514726 nan 8.0 8.0
0.07540876232927551 10.735570554068765 nan 8.0 8.0
0.07521869494878852 10.492509379536937 nan 8.0 8.0
0.0749144143778645 10.397513334162488 nan 8.0 8.0
0.07475513371062603 10.318876779411012 nan 8.0 8.0
0.07465788758955061 10.142486047093545 nan 8.0 8.0
0.07457484479610721 10.069221211708275 nan 8.0 8.0
0.07457831024702544 10.093597576788845 nan 8.0 8.0
0.07458302680448492 10.065660197734688 nan 8.0 8.0
0.07458654133695342 10.06572051280169 nan 8.0 8.0
0.07457045515784677 10.065830951240661 nan 8.0 8.0
0.07454349214784839 10.045651728790427 nan 8.0 8.0
0.07453782508915685 10.033120338472582 nan 8.0 8.0
0.07452150754355058 10.025416225075091 nan 8.0 8.0
0.07450541369804764 10.020114070537806 nan 8.0 8.0
0.07450394985606068 10.018233764858868 nan 8.0 8.0
0.07448884855838445 10.016060543852022 nan 8.0 8.0
0.07448813938514298 10.01759941027917 nan 8.0 8.0
0.07449545469869145 10.011784045192137 nan 8.0 8.0
U dimensions = (906, 36)
Iteration 0 of 1
phi.shape: (75, 906)
U.shape: (906, 36)
phi.dot(U).T shape: (36, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800616.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800616_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800616_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800616_test_data.npy
Cleanup complete.

Simulation 3/10 score: 0.7962118599658253
Running repeat 4/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800654.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_125668_1741800654'
Loaded dataset: downsampled_1000genes_125668_1741800654
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.10069433473770661 4.4923555884054185 1.0 8.0 8.0
0.05944217043121047 8.453108354568327 1.0 8.0 8.0
0.058643985476826255 8.572490668114222 1.0 8.0 8.0
0.05843613795473701 8.122923810051 1.0 8.0 8.0
0.05816862249781585 8.080158519981412 1.0 8.0 8.0
0.058043738766222375 7.98035088080862 1.0 8.0 8.0
0.05797799846881024 7.9031786382823945 1.0 8.0 8.0
0.057859222968222324 7.847259612671697 1.0 8.0 8.0
0.05780956371250834 7.789703921747629 1.0 8.0 8.0
0.05775966443484737 7.747366890490544 1.0 8.0 8.0
0.05767239337314267 7.724033163266205 1.0 8.0 8.0
0.05757366418211074 7.726156847381757 1.0 8.0 8.0
0.05754224649288775 7.7044050713123 1.0 8.0 8.0
0.057557210183611485 7.651908088535837 1.0 8.0 8.0
0.0576870482782168 7.6405331759321236 1.0 8.0 8.0
0.05784295026244812 7.616212032872482 1.0 8.0 8.0
0.05791813042220717 7.597997246282893 1.0 8.0 8.0
0.05786949065638869 7.606508672680959 1.0 8.0 8.0
0.05785535133052688 7.60907381148096 1.0 8.0 8.0
0.05784026249639418 7.6174226219037084 1.0 8.0 8.0
U dimensions = (906, 30)
Iteration 0 of 1
phi.shape: (75, 906)
U.shape: (906, 30)
phi.dot(U).T shape: (30, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800654.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800654_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800654_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800654_test_data.npy
Cleanup complete.

Simulation 4/10 score: 0.8234969538645934
Running repeat 5/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800695.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_125668_1741800695'
Loaded dataset: downsampled_1000genes_125668_1741800695
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.18808820833976936 5.507992367688383 1.0 8.0 8.0
0.08338571703294073 13.950613531572559 1.0 8.0 8.0
0.08213624207603298 12.927855000053533 1.0 8.0 8.0
0.08168392056966656 12.86108070742942 1.0 8.0 8.0
0.08138304717576428 12.59690223011424 1.0 8.0 8.0
0.08111539033571491 12.375697871322942 1.0 8.0 8.0
0.08087344495569548 12.227434667346712 1.0 8.0 8.0
0.08086010707693392 12.17709166570206 1.0 8.0 8.0
0.08087689641729678 12.148785064786615 1.0 8.0 8.0
0.08086850384878075 12.101146728482314 1.0 8.0 8.0
0.080811334996848 12.124695291162878 1.0 8.0 8.0
0.08079946208760302 12.133945250365665 1.0 8.0 8.0
0.08081851662066442 12.060703405230322 1.0 8.0 8.0
0.08083711461502452 12.041170432855935 1.0 8.0 8.0
0.08083543907596291 12.035466576683659 1.0 8.0 8.0
0.08084243159604643 12.021855510449134 1.0 8.0 8.0
0.0808592262208776 12.00855917341344 1.0 8.0 8.0
0.08088582465571481 11.994217059093197 1.0 8.0 8.0
0.08092939440087377 11.992548860530631 1.0 8.0 8.0
0.08094820981167683 12.049572598634548 1.0 8.0 8.0
U dimensions = (906, 38)
Iteration 0 of 1
phi.shape: (75, 906)
U.shape: (906, 38)
phi.dot(U).T shape: (38, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800695.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800695_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800695_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800695_test_data.npy
Cleanup complete.

Simulation 5/10 score: 0.7853044097999318
Running repeat 6/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800760.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_125668_1741800760'
Loaded dataset: downsampled_1000genes_125668_1741800760
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.14689068145373585 5.316832934070914 1.0 8.0 8.0
0.08126960238236902 10.606158523104646 1.0 8.0 8.0
0.07880780330135706 11.06978729027387 1.0 8.0 8.0
0.07770876028150453 11.172753374196887 1.0 8.0 8.0
0.07695195901314711 11.368352059046677 1.0 8.0 8.0
0.07662175436793328 11.206607586808309 1.0 8.0 8.0
0.07662509005580775 11.128911274222501 1.0 8.0 8.0
0.07658783729508856 11.068998872345931 1.0 8.0 8.0
0.07655750228360036 11.076729715162037 1.0 8.0 8.0
0.07647146526237347 11.028573661441015 1.0 8.0 8.0
0.07641714632423768 11.025420132668165 1.0 8.0 8.0
0.07644862969938537 11.030147799785663 1.0 8.0 8.0
0.07645472619618843 11.031652323545998 1.0 8.0 8.0
0.07642911487053605 11.044255615076745 1.0 8.0 8.0
0.07641984150204717 11.075701167201146 1.0 8.0 8.0
0.07645013490051022 11.0809355836698 1.0 8.0 8.0
0.07641796534314838 11.07212693872249 1.0 8.0 8.0
0.07641012791697666 11.067184347565505 1.0 8.0 8.0
0.07641439804937511 11.059820841524859 1.0 8.0 8.0
0.07640379395016672 11.057885882423333 1.0 8.0 8.0
U dimensions = (906, 35)
Iteration 0 of 1
phi.shape: (75, 906)
U.shape: (906, 35)
phi.dot(U).T shape: (35, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800760.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800760_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800760_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800760_test_data.npy
Cleanup complete.

Simulation 6/10 score: 0.8246315720340687
Running repeat 7/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800799.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_125668_1741800799'
Loaded dataset: downsampled_1000genes_125668_1741800799
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.15505488802033773 5.053718767987978 nan 8.0 8.0
0.08773957463782434 12.212777708543046 nan 8.0 8.0
0.08614795818407783 11.72037035168488 nan 8.0 8.0
0.0854123504257791 11.699472818758364 nan 8.0 8.0
0.08489168331431263 11.647583997106432 nan 8.0 8.0
0.08447426992270957 11.63821867384121 nan 8.0 8.0
0.08426154784276219 11.64707817045352 nan 8.0 8.0
0.08403223601981069 11.654412095386654 nan 8.0 8.0
0.08381048932761548 11.675627383717265 nan 8.0 8.0
0.08352545894479879 11.695236225538657 nan 8.0 8.0
0.08328128279285396 11.65557718515842 nan 8.0 8.0
0.0832014469504263 11.579572992959362 nan 8.0 8.0
0.08323092817568412 11.548405309122174 nan 8.0 8.0
0.08335586900728709 11.492975733984093 nan 8.0 8.0
0.08347158217793138 11.481172177030217 nan 8.0 8.0
0.08356434609212116 11.4602558176117 nan 8.0 8.0
0.0835863448103843 11.479928253209092 nan 8.0 8.0
0.08360605902683127 11.37992680546188 nan 8.0 8.0
0.08361041047388629 11.366135143404428 nan 8.0 8.0
0.08360282395957896 11.41071717334109 nan 8.0 8.0
U dimensions = (906, 37)
Iteration 0 of 1
phi.shape: (75, 906)
U.shape: (906, 37)
phi.dot(U).T shape: (37, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800799.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800799_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800799_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800799_test_data.npy
Cleanup complete.

Simulation 7/10 score: 0.811735724433575
Running repeat 8/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800851.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_125668_1741800851'
Loaded dataset: downsampled_1000genes_125668_1741800851
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.19165214247314843 5.4244507470428065 1.0 8.0 8.0
0.08338238922007934 12.709684768900628 1.0 8.0 8.0
0.08231050928057126 11.864365611867422 1.0 8.0 8.0
0.08215442289597674 11.439585454947146 1.0 8.0 8.0
0.08217408110715863 11.374158351609145 1.0 8.0 8.0
0.08215896047136817 11.295615121829606 1.0 8.0 8.0
0.08206072886828919 11.192841942966789 1.0 8.0 8.0
0.08187424702630397 11.270240493043236 1.0 8.0 8.0
0.08167754145901518 11.246353496822945 1.0 8.0 8.0
0.08152161614181697 11.206360467176712 1.0 8.0 8.0
0.0815021078337077 11.15383375725713 1.0 8.0 8.0
0.08150507180996525 11.123627573304958 1.0 8.0 8.0
0.08151964470034612 11.106459975599684 1.0 8.0 8.0
0.08152933569945164 11.090576845968 1.0 8.0 8.0
0.08156600648154355 11.06753676159266 1.0 8.0 8.0
0.08158087914492795 11.06767496476119 1.0 8.0 8.0
0.08160054351722135 11.065180428896117 1.0 8.0 8.0
0.08163455255119278 11.053721371215374 1.0 8.0 8.0
0.08168028651482107 11.040459994413322 1.0 8.0 8.0
0.08171345251978357 11.036780881491419 1.0 8.0 8.0
U dimensions = (906, 35)
Iteration 0 of 1
phi.shape: (75, 906)
U.shape: (906, 35)
phi.dot(U).T shape: (35, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800851.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800851_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800851_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800851_test_data.npy
Cleanup complete.

Simulation 8/10 score: 0.8194285638249028
Running repeat 9/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800908.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_125668_1741800908'
Loaded dataset: downsampled_1000genes_125668_1741800908
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.17248058785187137 5.534522777729554 1.0 8.0 8.0
0.08736831893893648 13.1077528325633 1.0 8.0 8.0
0.08417511758463647 12.19976367768639 1.0 8.0 8.0
0.08275895366688668 12.084801477992542 1.0 8.0 8.0
0.08198606423675625 12.238654583564688 1.0 8.0 8.0
0.08154932217676636 12.218280050233787 1.0 8.0 8.0
0.08126527817406448 12.150266213871802 1.0 8.0 8.0
0.08105146010763398 12.133582849238909 1.0 8.0 8.0
0.08088420176217748 12.201367194508716 1.0 8.0 8.0
0.08082705642192745 12.224146604102936 1.0 8.0 8.0
0.08072100214104105 12.237010796327228 1.0 8.0 8.0
0.08066694185973222 12.223046204030844 1.0 8.0 8.0
0.08059197933281315 12.23431740278307 1.0 8.0 8.0
0.0805441188269247 12.22496504749503 1.0 8.0 8.0
0.08053428049017597 12.22093085469201 1.0 8.0 8.0
0.08053484269997124 12.209285417121851 1.0 8.0 8.0
0.08053199989616844 12.206370959324492 1.0 8.0 8.0
0.08051916358586153 12.200505884888972 1.0 8.0 8.0
0.08051408301443708 12.19511629322864 1.0 8.0 8.0
0.08050594255727306 12.194994441670207 1.0 8.0 8.0
U dimensions = (906, 32)
Iteration 0 of 1
phi.shape: (75, 906)
U.shape: (906, 32)
phi.dot(U).T shape: (32, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800908.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800908_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800908_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800908_test_data.npy
Cleanup complete.

Simulation 9/10 score: 0.624001261333098
Running repeat 10/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800945.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_125668_1741800945'
Loaded dataset: downsampled_1000genes_125668_1741800945
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.18900706516488186 5.312329015419984 1.0 8.0 8.0
0.08796607569210102 12.898328835386152 1.0 8.0 8.0
0.08578288712836679 12.297192942349037 1.0 8.0 8.0
0.08491131061254642 12.248061515337946 1.0 8.0 8.0
0.08432581505742553 12.299957186483415 1.0 8.0 8.0
0.08394181124858302 12.19547680426117 1.0 8.0 8.0
0.08380057859641621 12.161217520348048 1.0 8.0 8.0
0.08371612132219419 12.082243671657762 1.0 8.0 8.0
0.0835617712891108 11.928482564705096 1.0 8.0 8.0
0.08352848548477643 11.868957980715637 1.0 8.0 8.0
0.08353813735341897 11.797863774865064 1.0 8.0 8.0
0.08355006373662288 11.79674108239671 1.0 8.0 8.0
0.08363375866805889 11.721585042100948 1.0 8.0 8.0
0.08358595401861257 11.72211246809654 1.0 8.0 8.0
0.08357686112880036 11.703430237496637 1.0 8.0 8.0
0.08360864407313873 11.678271301926056 1.0 8.0 8.0
0.08363763141375757 11.551199702874943 1.0 8.0 8.0
0.08360601928842215 11.557003620062401 1.0 8.0 8.0
0.08362617950003048 11.548000230277303 1.0 8.0 8.0
0.08363569188378162 11.480067332025477 1.0 8.0 8.0
U dimensions = (906, 31)
Iteration 0 of 1
phi.shape: (75, 906)
U.shape: (906, 31)
phi.dot(U).T shape: (31, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800945.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800945_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800945_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_125668_1741800945_test_data.npy
Cleanup complete.

Simulation 10/10 score: 0.8192536029815934
Results saved: results/simulation/results_optimal.csv
Running simulation with: num_measurements=100, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=500
Running repeat 1/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800720.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_281770_1741800720'
Loaded dataset: downsampled_500genes_281770_1741800720
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.184660706792792 2.9781893768729386 nan 8.0 8.0
0.06786418043628684 11.323989041728812 nan 8.0 8.0
0.06490027848249236 11.437729093326565 nan 8.0 8.0
0.06325302635471675 11.527511281097967 nan 8.0 8.0
0.061950046281807114 11.789127114703037 nan 8.0 8.0
0.06149355415748459 11.771868959074368 nan 8.0 8.0
0.061225044793318806 11.722290690837145 nan 8.0 8.0
0.061026881363125396 11.65172837862673 nan 8.0 8.0
0.06088272822994267 11.76461048326935 nan 8.0 8.0
0.06075214689773101 11.785997448865286 nan 8.0 8.0
0.060611261855239795 11.768543966974033 nan 8.0 8.0
0.06048383018058656 11.752002969655894 nan 8.0 8.0
0.06039117442982378 11.745708862786152 nan 8.0 8.0
0.060317530582554846 11.732475762938318 nan 8.0 8.0
0.06021349468002446 11.706158229997053 nan 8.0 8.0
0.06013762809736489 11.685126432022667 nan 8.0 8.0
0.06009210718810909 11.678729446214742 nan 8.0 8.0
0.06001129369688185 11.682689717143928 nan 8.0 8.0
0.05997358470217984 11.663112466557703 nan 8.0 8.0
0.0599003630556294 11.639426873479742 nan 8.0 8.0
U dimensions = (477, 29)
Iteration 0 of 1
phi.shape: (100, 477)
U.shape: (477, 29)
phi.dot(U).T shape: (29, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800720.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800720_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800720_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800720_test_data.npy
Cleanup complete.

Simulation 1/10 score: 0.9114707996083757
Running repeat 2/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800769.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_281770_1741800769'
Loaded dataset: downsampled_500genes_281770_1741800769
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.16960756101396413 2.774846047492706 nan 8.0 8.0
0.06620147245605423 10.615137387621816 nan 8.0 8.0
0.0643023896470537 10.22509065722977 nan 8.0 8.0
0.0629943693887971 10.424280654622125 nan 8.0 8.0
0.06230025184935084 10.502600495384232 nan 8.0 8.0
0.06188704691794367 10.628236137602904 nan 8.0 8.0
0.06126933976344806 10.685957423928503 nan 8.0 8.0
0.06065455692460342 10.69791798129162 nan 8.0 8.0
0.060231544602562415 10.557173960097076 nan 8.0 8.0
0.06006058351890442 10.531723336828314 nan 8.0 8.0
0.05994324516842808 10.540272649255263 nan 8.0 8.0
0.05978629948469938 10.552428219390663 nan 8.0 8.0
0.05966411971695318 10.555730332492145 nan 8.0 8.0
0.059591709950495675 10.55554822851002 nan 8.0 8.0
0.059542971152130364 10.56034743208233 nan 8.0 8.0
0.059506858424594244 10.568871997202406 nan 8.0 8.0
0.05949670876704083 10.567943316046483 nan 8.0 8.0
0.0594795934580743 10.564526891994745 nan 8.0 8.0
0.059468837262536045 10.560782510201399 nan 8.0 8.0
0.059457938091499574 10.560973267081673 nan 8.0 8.0
U dimensions = (477, 33)
Iteration 0 of 1
phi.shape: (100, 477)
U.shape: (477, 33)
phi.dot(U).T shape: (33, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800769.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800769_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800769_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800769_test_data.npy
Cleanup complete.

Simulation 2/10 score: 0.9141713046164424
Running repeat 3/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800822.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_281770_1741800822'
Loaded dataset: downsampled_500genes_281770_1741800822
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.17913349356715547 3.0852913687695467 nan 8.0 8.0
0.07179714795771697 11.218231651157904 nan 8.0 8.0
0.06655671234511784 11.113816215891903 nan 8.0 8.0
0.06290938066245211 11.197319218886088 nan 8.0 8.0
0.061138907593733416 11.300520178291338 nan 8.0 8.0
0.06035485074414515 11.303081075384016 nan 8.0 8.0
0.06000872820170167 11.312550379840628 nan 8.0 8.0
0.05976233493480965 11.365431031391976 nan 8.0 8.0
0.05952607321954406 11.384106661052135 nan 8.0 8.0
0.05940884198723906 11.372973051668618 nan 8.0 8.0
0.05935605601260929 11.370548172268824 nan 8.0 8.0
0.059328238779982945 11.34938844157033 nan 8.0 8.0
0.059259512258969416 11.330781424450798 nan 8.0 8.0
0.05920155114407588 11.296520085476189 nan 8.0 8.0
0.05913791610163488 11.279703893934128 nan 8.0 8.0
0.05905714716350008 11.260313680832562 nan 8.0 8.0
0.05900777411740865 11.231949301183425 nan 8.0 8.0
0.05898928418432736 11.235928965639774 nan 8.0 8.0
0.058962705066855525 11.244802023106656 nan 8.0 8.0
0.05893370236405515 11.248710594755146 nan 8.0 8.0
U dimensions = (477, 34)
Iteration 0 of 1
phi.shape: (100, 477)
U.shape: (477, 34)
phi.dot(U).T shape: (34, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800822.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800822_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800822_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800822_test_data.npy
Cleanup complete.

Simulation 3/10 score: 0.7374787287243642
Running repeat 4/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800870.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_281770_1741800870'
Loaded dataset: downsampled_500genes_281770_1741800870
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.1834785540160091 2.6403603092270416 nan 8.0 8.0
0.0718942193837947 10.237178968564118 nan 8.0 8.0
0.06766201930535687 9.878925597333966 nan 8.0 8.0
0.06553454672936565 10.039262875508811 nan 8.0 8.0
0.06441333182939235 10.114241778870381 nan 8.0 8.0
0.06378200501297282 10.310590875444197 nan 8.0 8.0
0.06330174289848944 10.397651253780282 nan 8.0 8.0
0.06299898439508744 10.407054153083854 nan 8.0 8.0
0.06284304660150386 10.418269950283577 nan 8.0 8.0
0.06272155402982915 10.440082843885857 nan 8.0 8.0
0.06264559654078095 10.454121701941252 nan 8.0 8.0
0.06254824040113827 10.492669477519184 nan 8.0 8.0
0.062436009992647534 10.510019576788114 nan 8.0 8.0
0.06236192246072725 10.527308196099126 nan 8.0 8.0
0.06229588190780466 10.52365600565967 nan 8.0 8.0
0.0622579850944458 10.518915938134136 nan 8.0 8.0
0.06222081529570622 10.516419515219475 nan 8.0 8.0
0.06219473063331993 10.528216116107421 nan 8.0 8.0
0.062185946773424816 10.526723989502711 nan 8.0 8.0
0.06217839136546888 10.528048067164594 nan 8.0 8.0
U dimensions = (477, 33)
Iteration 0 of 1
phi.shape: (100, 477)
U.shape: (477, 33)
phi.dot(U).T shape: (33, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800870.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800870_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800870_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800870_test_data.npy
Cleanup complete.

Simulation 4/10 score: 0.8963434211311181
Running repeat 5/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800919.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_281770_1741800919'
Loaded dataset: downsampled_500genes_281770_1741800919
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.19113484831506178 3.12760072394429 nan 8.0 8.0
0.06479327442885241 11.495554552754417 nan 8.0 8.0
0.061652134996388885 11.358190449095824 nan 8.0 8.0
0.060360635397721074 11.419562560147641 nan 8.0 8.0
0.05999101934705242 11.344744560691657 nan 8.0 8.0
0.059727110879603695 11.361143990480292 nan 8.0 8.0
0.05949040638677694 11.357031681503214 nan 8.0 8.0
0.05903144566438279 11.366872384114322 nan 8.0 8.0
0.05881775583626159 11.40472139671148 nan 8.0 8.0
0.0587570604355766 11.375803639846302 nan 8.0 8.0
0.05873391977397846 11.382074570802617 nan 8.0 8.0
0.05872130994159608 11.363726920707885 nan 8.0 8.0
0.058702076709397866 11.346631963012351 nan 8.0 8.0
0.05868185624573152 11.338983004758301 nan 8.0 8.0
0.058666235638939246 11.331037068783525 nan 8.0 8.0
0.05862343569113282 11.338528741585497 nan 8.0 8.0
0.05859106453017193 11.339681979193307 nan 8.0 8.0
0.0585763689463642 11.337876737153776 nan 8.0 8.0
0.05851676163936681 11.306943219386834 nan 8.0 8.0
0.05848761474134978 11.377468381393797 nan 8.0 8.0
U dimensions = (477, 34)
Iteration 0 of 1
phi.shape: (100, 477)
U.shape: (477, 34)
phi.dot(U).T shape: (34, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800919.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800919_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800919_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800919_test_data.npy
Cleanup complete.

Simulation 5/10 score: 0.9091063135427038
Running repeat 6/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800968.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_281770_1741800968'
Loaded dataset: downsampled_500genes_281770_1741800968
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.1929339384427422 3.229862817849661 nan 8.0 8.0
0.06899849791783985 11.59185008167817 nan 8.0 8.0
0.0653979644020487 11.438533965084037 nan 8.0 8.0
0.06328408932039264 11.407280338475065 nan 8.0 8.0
0.06198282889059592 11.353807240851477 nan 8.0 8.0
0.0617421757359633 11.359469677453466 nan 8.0 8.0
0.06159682586648707 11.365804642189847 nan 8.0 8.0
0.06140281643933487 11.375098427691272 nan 8.0 8.0
0.06117107718840287 11.390280896951149 nan 8.0 8.0
0.06094689123618202 11.399734548615948 nan 8.0 8.0
0.060781444874497104 11.383189713320357 nan 8.0 8.0
0.06072023934626314 11.379948551839178 nan 8.0 8.0
0.06065562974324601 11.391502769577246 nan 8.0 8.0
0.06062356111874567 11.36984113558716 nan 8.0 8.0
0.060572159836483785 11.373354799750151 nan 8.0 8.0
0.0604324769893726 11.3868093690919 nan 8.0 8.0
0.06028653366760295 11.401079320960337 nan 8.0 8.0
0.060204554268845745 11.310633936516025 nan 8.0 8.0
0.06018986221841294 11.264665678649255 nan 8.0 8.0
0.060184791695998996 11.255593319246133 nan 8.0 8.0
U dimensions = (477, 34)
Iteration 0 of 1
phi.shape: (100, 477)
U.shape: (477, 34)
phi.dot(U).T shape: (34, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800968.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800968_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800968_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741800968_test_data.npy
Cleanup complete.

Simulation 6/10 score: 0.9161926441639763
Running repeat 7/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741801015.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_281770_1741801015'
Loaded dataset: downsampled_500genes_281770_1741801015
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.16460100678567147 3.089852734747649 nan 8.0 8.0
0.06930651498102702 11.0054833117179 nan 8.0 8.0
0.06659204666339691 10.989876690496548 nan 8.0 8.0
0.0648645876419397 11.18406032623823 nan 8.0 8.0
0.06342601946740867 11.403978872473207 nan 8.0 8.0
0.06251816791036025 11.57193459248685 nan 8.0 8.0
0.06199032765039425 11.57719142611685 nan 8.0 8.0
0.06170821611039601 11.539403217656004 nan 8.0 8.0
0.06142135764221568 11.581920982092669 nan 8.0 8.0
0.06115872613036377 11.465828996671656 nan 8.0 8.0
0.060850932095240284 11.439440909543297 nan 8.0 8.0
0.06064167166880097 11.419620529156305 nan 8.0 8.0
0.060472516477137916 11.417619282588742 nan 8.0 8.0
0.060391355291895765 11.409857631656958 nan 8.0 8.0
0.06033435342675575 11.399262921559624 nan 8.0 8.0
0.060265327595627194 11.398953707128431 nan 8.0 8.0
0.06020946904228497 11.412141440896042 nan 8.0 8.0
0.0601903838260055 11.417680971407941 nan 8.0 8.0
0.060176948384236484 11.4083547771769 nan 8.0 8.0
0.060165128102195764 11.410494430094372 nan 8.0 8.0
U dimensions = (477, 30)
Iteration 0 of 1
phi.shape: (100, 477)
U.shape: (477, 30)
phi.dot(U).T shape: (30, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741801015.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741801015_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741801015_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741801015_test_data.npy
Cleanup complete.

Simulation 7/10 score: 0.916678825512056
Running repeat 8/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741801059.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_281770_1741801059'
Loaded dataset: downsampled_500genes_281770_1741801059
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.19700531129879117 3.1054600611182095 nan 8.0 8.0
0.07098053560406048 11.221347842208996 nan 8.0 8.0
0.06883204606405147 11.2975956806992 nan 8.0 8.0
0.06763500133049127 11.4020231914269 nan 8.0 8.0
0.06672722349553506 11.620533965071063 nan 8.0 8.0
0.0655669477641817 11.528433044641028 nan 8.0 8.0
0.06487866606500747 11.517141317427981 nan 8.0 8.0
0.0643627320699035 11.501481824368135 nan 8.0 8.0
0.06394247891219529 11.500253949656374 nan 8.0 8.0
0.06367695352360936 11.466776403682257 nan 8.0 8.0
0.06348041274312166 11.439388113763494 nan 8.0 8.0
0.06335753360853114 11.4341739485108 nan 8.0 8.0
0.06328906495904407 11.447224460675308 nan 8.0 8.0
0.06325546729960185 11.496687430768532 nan 8.0 8.0
0.06322647925172842 11.541316540342164 nan 8.0 8.0
0.06319825900908915 11.570422544829631 nan 8.0 8.0
0.06318643381534439 11.569684843129288 nan 8.0 8.0
0.06316663042681725 11.566975193347714 nan 8.0 8.0
0.0631542853756708 11.568238154410984 nan 8.0 8.0
0.06312040599825197 11.573688947697123 nan 8.0 8.0
U dimensions = (477, 32)
Iteration 0 of 1
phi.shape: (100, 477)
U.shape: (477, 32)
phi.dot(U).T shape: (32, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741801059.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741801059_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741801059_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741801059_test_data.npy
Cleanup complete.

Simulation 8/10 score: 0.9081103410938501
Running repeat 9/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741801120.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_281770_1741801120'
Loaded dataset: downsampled_500genes_281770_1741801120
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.1902050867763817 3.0029401129303777 nan 8.0 8.0
0.06891385432997077 11.158502970302097 nan 8.0 8.0
0.06629285080280312 10.95355753539561 nan 8.0 8.0
0.064631584553697 11.017818054692414 nan 8.0 8.0
0.06379534780021401 11.054758791305131 nan 8.0 8.0
0.06287971457740604 11.200234313878665 nan 8.0 8.0
0.06206717474420487 11.21124519549902 nan 8.0 8.0
0.06169267377710874 11.245809629009736 nan 8.0 8.0
0.061511850680705304 11.182098507501566 nan 8.0 8.0
0.0614117356538354 11.21276054864628 nan 8.0 8.0
0.06135868726191296 11.208054133663925 nan 8.0 8.0
0.06131674622999328 11.19188832335078 nan 8.0 8.0
0.06125482898419499 11.202651040222696 nan 8.0 8.0
0.06122416947686704 11.217129015106789 nan 8.0 8.0
0.06119785143099121 11.222746633102316 nan 8.0 8.0
0.06117433453805443 11.218029537175918 nan 8.0 8.0
0.061141516771253235 11.228767577626506 nan 8.0 8.0
0.06110406209759989 11.231438816512291 nan 8.0 8.0
0.061080885715713684 11.243648689059885 nan 8.0 8.0
0.06106630882361874 11.247229473671323 nan 8.0 8.0
U dimensions = (477, 34)
Iteration 0 of 1
phi.shape: (100, 477)
U.shape: (477, 34)
phi.dot(U).T shape: (34, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741801120.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741801120_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741801120_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741801120_test_data.npy
Cleanup complete.

Simulation 9/10 score: 0.9146350907075823
Running repeat 10/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741801171.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_281770_1741801171'
Loaded dataset: downsampled_500genes_281770_1741801171
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.17261929579174673 3.2003846215419505 nan 8.0 8.0
0.06610427209628622 10.744012473183725 nan 8.0 8.0
0.06371930855838237 10.65270923795947 nan 8.0 8.0
0.061982599591069554 10.827509610336156 nan 8.0 8.0
0.06094982422813522 10.910768261602634 nan 8.0 8.0
0.06042860634609404 10.959696978623994 nan 8.0 8.0
0.060156970945081656 10.995632333950594 nan 8.0 8.0
0.059918951054613645 11.009812122168132 nan 8.0 8.0
0.05972863465257661 11.026495436165442 nan 8.0 8.0
0.05957622366333437 11.043058097774109 nan 8.0 8.0
0.05942517844613393 10.954101825668879 nan 8.0 8.0
0.059270161221603 11.048299302967896 nan 8.0 8.0
0.05918247815225297 11.041828196529261 nan 8.0 8.0
0.059107529885294996 11.043767261336148 nan 8.0 8.0
0.059041997455052564 11.078901109840057 nan 8.0 8.0
0.05896436380544512 11.101394863675102 nan 8.0 8.0
0.0588175570916718 11.12178958136472 nan 8.0 8.0
0.058712326452317165 11.109740596721783 nan 8.0 8.0
0.05863916196635088 11.031600738048033 nan 8.0 8.0
0.05858960792015355 11.119607491459549 nan 8.0 8.0
U dimensions = (477, 35)
Iteration 0 of 1
phi.shape: (100, 477)
U.shape: (477, 35)
phi.dot(U).T shape: (35, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741801171.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741801171_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741801171_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_281770_1741801171_test_data.npy
Cleanup complete.

Simulation 10/10 score: 0.8912631131702284
Results saved: results/simulation/results_optimal.csv
Running simulation with: num_measurements=100, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=1000
Running repeat 1/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741800920.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_1804920_1741800920'
Loaded dataset: downsampled_1000genes_1804920_1741800920
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.19320277521080242 5.992020569528815 1.0 8.0 8.0
0.08338936955402299 13.232644360519384 1.0 8.0 8.0
0.08134430672091475 12.862062580043002 1.0 8.0 8.0
0.08059549970502311 12.4150748424944 1.0 8.0 8.0
0.08028957330211228 12.25493643440871 1.0 8.0 8.0
0.08018652156963002 12.193539200357288 1.0 8.0 8.0
0.08012642243614077 12.13324663488085 1.0 8.0 8.0
0.08017885261294677 12.098530103800169 1.0 8.0 8.0
0.08010067355652006 12.074474609351617 1.0 8.0 8.0
0.08003445449981772 12.040867555715485 1.0 8.0 8.0
0.07990286974580252 12.03107962861741 1.0 8.0 8.0
0.07994014109251868 12.039600336317452 1.0 8.0 8.0
0.08003533784592998 12.008810730648786 1.0 8.0 8.0
0.08009543443698175 11.978132966197444 1.0 8.0 8.0
0.08010854920378596 11.959772299790759 1.0 8.0 8.0
0.08011497026749892 11.957989636292725 1.0 8.0 8.0
0.08012255294488901 11.955193473469052 1.0 8.0 8.0
0.08012564957020496 11.954749203063342 1.0 8.0 8.0
0.08012867129291601 11.954557536343355 1.0 8.0 8.0
0.08013771796924185 11.954447416147671 1.0 8.0 8.0
U dimensions = (906, 35)
Iteration 0 of 1
phi.shape: (100, 906)
U.shape: (906, 35)
phi.dot(U).T shape: (35, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741800920.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741800920_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741800920_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741800920_test_data.npy
Cleanup complete.

Simulation 1/10 score: 0.8361634168164892
Running repeat 2/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741800968.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_1804920_1741800968'
Loaded dataset: downsampled_1000genes_1804920_1741800968
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.17162059571706256 5.883966374721578 1.0 8.0 8.0
0.08472735658456676 12.964903389833665 1.0 8.0 8.0
0.08217671780857116 12.441204738803624 1.0 8.0 8.0
0.08072491407650739 12.329180448620987 1.0 8.0 8.0
0.08014875540467381 11.904008086059093 1.0 8.0 8.0
0.08001532900929276 11.70316787613078 1.0 8.0 8.0
0.08007402183057699 11.5407964804223 1.0 8.0 8.0
0.08005366856742235 11.44553677259626 1.0 8.0 8.0
0.0800066376165327 11.369608152152034 1.0 8.0 8.0
0.07998908182634534 11.334302429758887 1.0 8.0 8.0
0.08002115384709818 11.277779697747764 1.0 8.0 8.0
0.08005027792906672 11.206177134161766 1.0 8.0 8.0
0.08002867612500397 11.210610320331659 1.0 8.0 8.0
0.08003598562819247 11.212287301756572 1.0 8.0 8.0
0.08006481101831564 11.197343771398648 1.0 8.0 8.0
0.08006598206002735 11.19600444056518 1.0 8.0 8.0
0.08006553157103169 11.193612944843432 1.0 8.0 8.0
0.08006537927165425 11.193047639631867 1.0 8.0 8.0
0.08006542595995692 11.192564474084959 1.0 8.0 8.0
0.0800651761970882 11.19255599530022 1.0 8.0 8.0
U dimensions = (906, 37)
Iteration 0 of 1
phi.shape: (100, 906)
U.shape: (906, 37)
phi.dot(U).T shape: (37, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741800968.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741800968_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741800968_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741800968_test_data.npy
Cleanup complete.

Simulation 2/10 score: 0.8439994292359992
Running repeat 3/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801015.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_1804920_1741801015'
Loaded dataset: downsampled_1000genes_1804920_1741801015
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.1660147050799181 5.93325046730362 1.0 8.0 8.0
0.08318063637190432 12.789936950437207 1.0 8.0 8.0
0.08257526166276119 11.57961070702836 1.0 8.0 8.0
0.0823622762873003 11.081565657761386 1.0 8.0 8.0
0.0822495923368356 10.86981011095042 1.0 8.0 8.0
0.081845310481507 10.976519632638878 1.0 8.0 8.0
0.0815350023042315 11.050229237675739 1.0 8.0 8.0
0.08128889418616436 10.97379481766468 1.0 8.0 8.0
0.08107820668572607 10.96707901119008 1.0 8.0 8.0
0.08093568124304884 10.967085115166782 1.0 8.0 8.0
0.08083566953699628 10.963745806711655 1.0 8.0 8.0
0.08081992132172688 10.96109000399542 1.0 8.0 8.0
0.0807351629561871 10.970830414974136 1.0 8.0 8.0
0.08071269375243229 10.972940041024534 1.0 8.0 8.0
0.08070649544327146 10.96725026709774 1.0 8.0 8.0
0.08066796075592719 10.974642517960364 1.0 8.0 8.0
0.08062791901904987 10.979656201169462 1.0 8.0 8.0
0.08064752318591362 10.965465620899336 1.0 8.0 8.0
0.08062334341787925 10.953040030401006 1.0 8.0 8.0
0.08065966174627437 10.932826013157307 1.0 8.0 8.0
U dimensions = (906, 37)
Iteration 0 of 1
phi.shape: (100, 906)
U.shape: (906, 37)
phi.dot(U).T shape: (37, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801015.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801015_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801015_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801015_test_data.npy
Cleanup complete.

Simulation 3/10 score: 0.8227073276800583
Running repeat 4/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801068.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_1804920_1741801068'
Loaded dataset: downsampled_1000genes_1804920_1741801068
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.16519457522182723 6.180420392788307 1.0 8.0 8.0
0.08516441316180656 11.990710372889984 1.0 8.0 8.0
0.08377631679671438 12.058673506317483 1.0 8.0 8.0
0.08349721677678679 11.877281920454204 1.0 8.0 8.0
0.08327041969352322 11.635218847474372 1.0 8.0 8.0
0.08326986305138762 11.653767786908416 1.0 8.0 8.0
0.08315705792614914 11.689103150028815 1.0 8.0 8.0
0.08311606860872034 11.69973761815362 1.0 8.0 8.0
0.08314269142490116 11.71964079177535 1.0 8.0 8.0
0.08320945937798263 11.669557227456918 1.0 8.0 8.0
0.08317031647140849 11.605309645125327 1.0 8.0 8.0
0.08316757954759524 11.570798126008132 1.0 8.0 8.0
0.08315027885760651 11.581465671134827 1.0 8.0 8.0
0.08305612893450298 11.54770523818843 1.0 8.0 8.0
0.08299588948306313 11.526301466939634 1.0 8.0 8.0
0.08299042841117243 11.533872010503142 1.0 8.0 8.0
0.08299220329961832 11.535374745920016 1.0 8.0 8.0
0.08299218174914114 11.53540724147136 1.0 8.0 8.0
0.08299217725199359 11.535414662356317 1.0 8.0 8.0
0.08299217824876193 11.53541450249055 1.0 8.0 8.0
U dimensions = (906, 37)
Iteration 0 of 1
phi.shape: (100, 906)
U.shape: (906, 37)
phi.dot(U).T shape: (37, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801068.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801068_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801068_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801068_test_data.npy
Cleanup complete.

Simulation 4/10 score: 0.8446474261175867
Running repeat 5/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801119.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_1804920_1741801119'
Loaded dataset: downsampled_1000genes_1804920_1741801119
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.10622596600843714 4.633174087409602 nan 8.0 8.0
0.06577205847407275 9.08263251752822 nan 8.0 8.0
0.0643836060165145 8.622822652593642 nan 8.0 8.0
0.06378380588445864 8.290952012042052 nan 8.0 8.0
0.06357917656351175 8.221075718151049 nan 8.0 8.0
0.06353529792896051 8.148285090843245 nan 8.0 8.0
0.06360656671292386 8.157901798878767 nan 8.0 8.0
0.06372982630490065 8.123323079091715 nan 8.0 8.0
0.06388592941372584 8.077386344864095 nan 8.0 8.0
0.06414598852129183 7.993589871327037 nan 8.0 8.0
0.06449270528283502 7.911110558221077 nan 8.0 8.0
0.06470625134121566 7.824351040471627 nan 8.0 8.0
0.06479329048443239 7.805685971515996 nan 8.0 8.0
0.0647975509757196 7.808097500441339 nan 8.0 8.0
0.064788692747759 7.826337556926732 nan 8.0 8.0
0.06478055603110144 7.826138848528544 nan 8.0 8.0
0.06478129575118474 7.826155954279537 nan 8.0 8.0
0.06478334975714717 7.823124614455636 nan 8.0 8.0
0.064776160752963 7.823977175387383 nan 8.0 8.0
0.06476805974945377 7.83181222100312 nan 8.0 8.0
U dimensions = (906, 32)
Iteration 0 of 1
phi.shape: (100, 906)
U.shape: (906, 32)
phi.dot(U).T shape: (32, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801119.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801119_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801119_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801119_test_data.npy
Cleanup complete.

Simulation 5/10 score: 0.8373500601337052
Running repeat 6/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801175.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_1804920_1741801175'
Loaded dataset: downsampled_1000genes_1804920_1741801175
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.1765303220894039 6.338642240999815 1.0 8.0 8.0
0.08363433444067825 13.008613071146895 1.0 8.0 8.0
0.08266332994558767 12.195427622296219 1.0 8.0 8.0
0.0822784622418059 11.923078833049496 1.0 8.0 8.0
0.08235439062819871 11.740186113115842 1.0 8.0 8.0
0.08241781902280243 11.733491005943469 1.0 8.0 8.0
0.08242368737133299 11.706083675549351 1.0 8.0 8.0
0.0823707285777775 11.65503737781523 1.0 8.0 8.0
0.08227194326143239 11.615024967421672 1.0 8.0 8.0
0.08218693548046707 11.571673513323464 1.0 8.0 8.0
0.08211009890366405 11.545228494538348 1.0 8.0 8.0
0.0820593350676544 11.541634111690213 1.0 8.0 8.0
0.0820357395639949 11.489611395104061 1.0 8.0 8.0
0.08202415152199782 11.345341248598372 1.0 8.0 8.0
0.08202214155385501 11.312501171393812 1.0 8.0 8.0
0.08203000329140953 11.278821798421868 1.0 8.0 8.0
0.08201077442785654 11.32795081496482 1.0 8.0 8.0
0.08196592379494749 11.257359651846903 1.0 8.0 8.0
0.08197411758267958 11.19462073443465 1.0 8.0 8.0
0.08195290425293422 11.182271619519492 1.0 8.0 8.0
U dimensions = (906, 36)
Iteration 0 of 1
phi.shape: (100, 906)
U.shape: (906, 36)
phi.dot(U).T shape: (36, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801175.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801175_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801175_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801175_test_data.npy
Cleanup complete.

Simulation 6/10 score: 0.8427828352455442
Running repeat 7/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801229.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_1804920_1741801229'
Loaded dataset: downsampled_1000genes_1804920_1741801229
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.1631331414838315 5.435789427813049 nan 8.0 8.0
0.08605633992213657 12.098694384441979 nan 8.0 8.0
0.08378395944066974 11.632387372889683 nan 8.0 8.0
0.08306378748930221 11.716301405805986 nan 8.0 8.0
0.082448403851482 11.790751812981279 nan 8.0 8.0
0.08191012727705793 11.907112840292507 nan 8.0 8.0
0.08152750261779773 11.882898576870128 nan 8.0 8.0
0.0813939489089276 11.833647268346454 nan 8.0 8.0
0.08117324530940251 11.81901134763625 nan 8.0 8.0
0.08082519963344781 11.601216819884687 nan 8.0 8.0
0.08055573717797149 11.64445296855312 nan 8.0 8.0
0.08040837475127127 11.661064885725944 nan 8.0 8.0
0.08035348431820366 11.628785620212847 nan 8.0 8.0
0.08037333701257832 11.442780692984147 nan 8.0 8.0
0.08037238851915551 11.444595318919731 nan 8.0 8.0
0.08036556165325415 11.436671767692406 nan 8.0 8.0
0.08038795439483881 11.531825793913445 nan 8.0 8.0
0.08041220358210732 11.523624102927235 nan 8.0 8.0
0.08041707402490939 11.523634612490927 nan 8.0 8.0
0.08042547341257811 11.515160361514829 nan 8.0 8.0
U dimensions = (906, 36)
Iteration 0 of 1
phi.shape: (100, 906)
U.shape: (906, 36)
phi.dot(U).T shape: (36, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801229.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801229_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801229_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801229_test_data.npy
Cleanup complete.

Simulation 7/10 score: 0.8265329535267917
Running repeat 8/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801280.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_1804920_1741801280'
Loaded dataset: downsampled_1000genes_1804920_1741801280
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.17492760469195334 5.481668692457121 1.0 8.0 8.0
0.08495849833547064 12.268317418919393 1.0 8.0 8.0
0.08237034786885822 12.238549824393838 1.0 8.0 8.0
0.08144884276313025 12.312805027703826 1.0 8.0 8.0
0.08090600554136429 12.39873366100209 1.0 8.0 8.0
0.08042087925667751 12.353361491566318 1.0 8.0 8.0
0.0800486810047829 12.364908043586315 1.0 8.0 8.0
0.07992246086382493 12.37889152601894 1.0 8.0 8.0
0.07983358027614051 12.397930801400205 1.0 8.0 8.0
0.07974211693136979 12.275574064203218 1.0 8.0 8.0
0.07967603927275735 12.171270623637007 1.0 8.0 8.0
0.07958138096726108 12.115810190510627 1.0 8.0 8.0
0.07964575904606463 12.07808578858503 1.0 8.0 8.0
0.07968849677422252 12.062560082231501 1.0 8.0 8.0
0.07973742101668024 12.03855785780675 1.0 8.0 8.0
0.07971975037037238 12.035009978242726 1.0 8.0 8.0
0.0796989529744565 12.03175213565963 1.0 8.0 8.0
0.0796948505555557 12.03103409240467 1.0 8.0 8.0
0.07970282838096654 12.028734980342016 1.0 8.0 8.0
0.07971363770228779 12.025967065987107 1.0 8.0 8.0
U dimensions = (906, 35)
Iteration 0 of 1
phi.shape: (100, 906)
U.shape: (906, 35)
phi.dot(U).T shape: (35, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801280.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801280_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801280_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801280_test_data.npy
Cleanup complete.

Simulation 8/10 score: 0.835015194742829
Running repeat 9/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801333.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_1804920_1741801333'
Loaded dataset: downsampled_1000genes_1804920_1741801333
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.17831367943334708 5.481506121191258 1.0 8.0 8.0
0.08782434782570048 11.859085513670081 1.0 8.0 8.0
0.08411092862972014 11.720035766157215 1.0 8.0 8.0
0.08346421968363871 11.759561210206108 1.0 8.0 8.0
0.08331800805462353 11.7332609104552 1.0 8.0 8.0
0.08318475506607748 11.719221537153429 1.0 8.0 8.0
0.08315353181285479 11.765803414327674 1.0 8.0 8.0
0.08307835697459942 11.816729095802751 1.0 8.0 8.0
0.08307015854671274 11.824463114738716 1.0 8.0 8.0
0.08308500274462205 11.818460984070066 1.0 8.0 8.0
0.08308198754337881 11.82332816414615 1.0 8.0 8.0
0.08310660009448256 11.814146317587994 1.0 8.0 8.0
0.0831575349324174 11.763358583939867 1.0 8.0 8.0
0.08320852560253333 11.745672939536119 1.0 8.0 8.0
0.08322078239990771 11.74581257023867 1.0 8.0 8.0
0.08323954153439428 11.74042285991437 1.0 8.0 8.0
0.08324921353049519 11.738420058267533 1.0 8.0 8.0
0.08326183111561736 11.723572726470975 1.0 8.0 8.0
0.08328072733513747 11.715225720541552 1.0 8.0 8.0
0.08327281652990592 11.715983738777163 1.0 8.0 8.0
U dimensions = (906, 34)
Iteration 0 of 1
phi.shape: (100, 906)
U.shape: (906, 34)
phi.dot(U).T shape: (34, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801333.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801333_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801333_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801333_test_data.npy
Cleanup complete.

Simulation 9/10 score: 0.8222021748685354
Running repeat 10/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801383.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_1804920_1741801383'
Loaded dataset: downsampled_1000genes_1804920_1741801383
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.12992372342271796 4.915783925905934 nan 8.0 8.0
0.08075195279557112 9.879569294851086 nan 8.0 8.0
0.07898312793591045 9.802955252973467 nan 8.0 8.0
0.07824082795209164 9.633022799242465 nan 8.0 8.0
0.07768651009021765 9.608817945011316 nan 8.0 8.0
0.07681157734857647 9.669968560495281 nan 8.0 8.0
0.07595245203707335 9.694570391689252 nan 8.0 8.0
0.07565768286778563 9.725437950426205 nan 8.0 8.0
0.0754727328240129 9.630570697816527 nan 8.0 8.0
0.07538170200998862 9.603051725064708 nan 8.0 8.0
0.07530908918267887 9.623768782872034 nan 8.0 8.0
0.0752839432314647 9.653889147793734 nan 8.0 8.0
0.07525215672004393 9.639358504301608 nan 8.0 8.0
0.07522003661679078 9.62561557515037 nan 8.0 8.0
0.07526168070171835 9.632335410493413 nan 8.0 8.0
0.0752412836770272 9.634603362550383 nan 8.0 8.0
0.07521665709535197 9.726734133009316 nan 8.0 8.0
0.07525901942858826 9.746841510596203 nan 8.0 8.0
0.07535320386793054 9.75926029148543 nan 8.0 8.0
0.0753888164608717 9.778316075747002 nan 8.0 8.0
U dimensions = (906, 33)
Iteration 0 of 1
phi.shape: (100, 906)
U.shape: (906, 33)
phi.dot(U).T shape: (33, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801383.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801383_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801383_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_1804920_1741801383_test_data.npy
Cleanup complete.

Simulation 10/10 score: 0.8344333593010146
Results saved: results/simulation/results_optimal.csv
Running simulation with: num_measurements=200, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=500
Running repeat 1/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801067.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_132705_1741801067'
Loaded dataset: downsampled_500genes_132705_1741801067
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.20648481010217845 2.735797610436702 nan 8.0 8.0
0.06676170749945542 11.464449517562375 nan 8.0 8.0
0.06397793199557888 11.198925390012757 nan 8.0 8.0
0.062429167123597806 11.080551584821904 nan 8.0 8.0
0.06183560417016054 11.066844677526387 nan 8.0 8.0
0.06147498178790478 11.110949683668787 nan 8.0 8.0
0.06124629736351839 11.119178276051649 nan 8.0 8.0
0.06105512969766391 11.124290267569322 nan 8.0 8.0
0.06090105388196132 11.110884472616197 nan 8.0 8.0
0.06076102224406377 11.105414470395493 nan 8.0 8.0
0.06064196702556457 11.081762426785414 nan 8.0 8.0
0.060574038338198966 11.074333322188911 nan 8.0 8.0
0.0605152716290942 11.078725364111747 nan 8.0 8.0
0.06044882891837644 11.087050606245704 nan 8.0 8.0
0.06038566255652322 11.086256394064721 nan 8.0 8.0
0.06034829327958546 11.081092440180264 nan 8.0 8.0
0.06030090996180626 11.081707526742814 nan 8.0 8.0
0.06022700065325137 10.976362874146393 nan 8.0 8.0
0.060164819824897964 10.97814120892933 nan 8.0 8.0
0.060104242408452135 10.975892167147116 nan 8.0 8.0
U dimensions = (477, 38)
Iteration 0 of 1
phi.shape: (200, 477)
U.shape: (477, 38)
phi.dot(U).T shape: (38, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801067.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801067_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801067_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801067_test_data.npy
Cleanup complete.

Simulation 1/10 score: 0.9398526746804783
Running repeat 2/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801125.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_132705_1741801125'
Loaded dataset: downsampled_500genes_132705_1741801125
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.19393616825127635 2.606824309604376 nan 8.0 8.0
0.06762102077139731 10.42131233685408 nan 8.0 8.0
0.06625647447695227 10.551977671110743 nan 8.0 8.0
0.06498243465717102 10.752559491360284 nan 8.0 8.0
0.06415746291180469 10.795777540846192 nan 8.0 8.0
0.06364605040162596 10.832015300664871 nan 8.0 8.0
0.06283256358826128 10.864791908146643 nan 8.0 8.0
0.0621488000065441 10.905540539862159 nan 8.0 8.0
0.061715601689067645 10.94371101045834 nan 8.0 8.0
0.06155394964231131 10.965989342910634 nan 8.0 8.0
0.06142912005000356 10.975399757165956 nan 8.0 8.0
0.06134413939880057 10.982259992001593 nan 8.0 8.0
0.061288305259763476 10.970952505807348 nan 8.0 8.0
0.061245392791992925 10.9561113465525 nan 8.0 8.0
0.061173755131855634 10.958624520751748 nan 8.0 8.0
0.061126144560536666 10.963007461512392 nan 8.0 8.0
0.061073484435139824 10.967065015912882 nan 8.0 8.0
0.061019498648037795 10.958653307641569 nan 8.0 8.0
0.06097612237245331 10.960895407042422 nan 8.0 8.0
0.06093803163039446 10.959407117856607 nan 8.0 8.0
U dimensions = (477, 29)
Iteration 0 of 1
phi.shape: (200, 477)
U.shape: (477, 29)
phi.dot(U).T shape: (29, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801125.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801125_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801125_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801125_test_data.npy
Cleanup complete.

Simulation 2/10 score: 0.9479530188065339
Running repeat 3/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801165.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_132705_1741801165'
Loaded dataset: downsampled_500genes_132705_1741801165
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.19921563215147076 2.9386889745092066 nan 8.0 8.0
0.06730106604185893 11.097406360544436 nan 8.0 8.0
0.06377947093534164 11.123812118122022 nan 8.0 8.0
0.06226930252289076 11.106577635371504 nan 8.0 8.0
0.060789194273681235 11.167751526888832 nan 8.0 8.0
0.0601349299923547 11.165234841445104 nan 8.0 8.0
0.05974779717054657 11.120655187909907 nan 8.0 8.0
0.05945981370389797 11.130247619215467 nan 8.0 8.0
0.05925515865682962 11.141861024040322 nan 8.0 8.0
0.05908560871851487 11.155595794585544 nan 8.0 8.0
0.05900370819541312 11.110073022644535 nan 8.0 8.0
0.05893182653093865 11.092298621881481 nan 8.0 8.0
0.05885098686152068 11.076214036218905 nan 8.0 8.0
0.0587947437339954 11.063862605794435 nan 8.0 8.0
0.05873644636769271 11.07632882057381 nan 8.0 8.0
0.05871614412302728 11.051630187353698 nan 8.0 8.0
0.05870537628805339 11.037881650922454 nan 8.0 8.0
0.05869353382449727 11.028599574918985 nan 8.0 8.0
0.05866977534225282 11.021132114600428 nan 8.0 8.0
0.05861655792314402 11.029465895256338 nan 8.0 8.0
U dimensions = (477, 34)
Iteration 0 of 1
phi.shape: (200, 477)
U.shape: (477, 34)
phi.dot(U).T shape: (34, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801165.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801165_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801165_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801165_test_data.npy
Cleanup complete.

Simulation 3/10 score: 0.9521410469077919
Running repeat 4/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801200.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_132705_1741801200'
Loaded dataset: downsampled_500genes_132705_1741801200
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.18240405051682018 2.9498696842889216 nan 8.0 8.0
0.07142711290156423 10.61156143426172 nan 8.0 8.0
0.06825763696139708 10.716396116428312 nan 8.0 8.0
0.06662890773447061 10.88829019845608 nan 8.0 8.0
0.06511145294206211 11.088257727163533 nan 8.0 8.0
0.06426674964597356 11.278896291149275 nan 8.0 8.0
0.06340668972575725 11.144352276911262 nan 8.0 8.0
0.06294131735906805 11.105581433167181 nan 8.0 8.0
0.06276070039652693 11.111696539598642 nan 8.0 8.0
0.06257779915105999 11.141932757030446 nan 8.0 8.0
0.06247505549623711 11.044927498663471 nan 8.0 8.0
0.06239188880623647 11.032102234166 nan 8.0 8.0
0.06233381724978859 11.023741545923508 nan 8.0 8.0
0.06225785499570602 11.041704126115008 nan 8.0 8.0
0.06210824658141689 11.03421423404899 nan 8.0 8.0
0.061992328989620704 11.048604437272777 nan 8.0 8.0
0.06189292883466779 11.071945102144992 nan 8.0 8.0
0.0618317412094348 11.08344570481356 nan 8.0 8.0
0.06178409241498872 11.09511533005075 nan 8.0 8.0
0.06174727590027773 11.090706224560021 nan 8.0 8.0
U dimensions = (477, 30)
Iteration 0 of 1
phi.shape: (200, 477)
U.shape: (477, 30)
phi.dot(U).T shape: (30, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801200.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801200_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801200_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801200_test_data.npy
Cleanup complete.

Simulation 4/10 score: 0.9484802082609188
Running repeat 5/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801244.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_132705_1741801244'
Loaded dataset: downsampled_500genes_132705_1741801244
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.2003560057497995 2.80671319419003 nan 8.0 8.0
0.06953225710651245 10.59913823788031 nan 8.0 8.0
0.0663966624484289 10.49152784841977 nan 8.0 8.0
0.06502490720395404 10.658126803689559 nan 8.0 8.0
0.06434304068061525 10.683633136308845 nan 8.0 8.0
0.06398599199044985 10.749095905831826 nan 8.0 8.0
0.06379872893632144 10.78572883364777 nan 8.0 8.0
0.06358682482548328 10.813265658290124 nan 8.0 8.0
0.06339766843617878 10.835217816208436 nan 8.0 8.0
0.06324037012420758 10.884945008397393 nan 8.0 8.0
0.06311053302244707 10.920036045081208 nan 8.0 8.0
0.06264829772295777 11.057518558791974 nan 8.0 8.0
0.06242847473229163 11.115146797295113 nan 8.0 8.0
0.06237242601452675 11.135941098892733 nan 8.0 8.0
0.06234189560580605 11.147694597383024 nan 8.0 8.0
0.062284212613462286 11.153572508152953 nan 8.0 8.0
0.062238580616370776 11.148526934774043 nan 8.0 8.0
0.062206791905418224 11.153214235163144 nan 8.0 8.0
0.06218100814191663 11.15409946192835 nan 8.0 8.0
0.06213314811081039 11.168654088134241 nan 8.0 8.0
U dimensions = (477, 30)
Iteration 0 of 1
phi.shape: (200, 477)
U.shape: (477, 30)
phi.dot(U).T shape: (30, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801244.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801244_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801244_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801244_test_data.npy
Cleanup complete.

Simulation 5/10 score: 0.9539877889451469
Running repeat 6/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801278.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_132705_1741801278'
Loaded dataset: downsampled_500genes_132705_1741801278
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.2268699505281071 2.8066083466170015 nan 8.0 8.0
0.07194602120532045 11.87925887380804 nan 8.0 8.0
0.06878431014138564 11.519385098898459 nan 8.0 8.0
0.06672254262757693 11.852117356718088 nan 8.0 8.0
0.06553788524412618 11.951281599345908 nan 8.0 8.0
0.06500495871327372 12.022334279144728 nan 8.0 8.0
0.06467529027650554 12.039854459942502 nan 8.0 8.0
0.06442611483622807 12.065053033159641 nan 8.0 8.0
0.06413773787240284 12.073809114380948 nan 8.0 8.0
0.06379459214735639 12.058937430529573 nan 8.0 8.0
0.06358651737855692 12.049362211435236 nan 8.0 8.0
0.06341281038249902 12.036361500530544 nan 8.0 8.0
0.06333624751959888 12.042625759887127 nan 8.0 8.0
0.06329892026244566 12.035696242987225 nan 8.0 8.0
0.06326685843189994 12.022382356248134 nan 8.0 8.0
0.0632457199735722 12.016488988038729 nan 8.0 8.0
0.06324078285927281 12.015770339316523 nan 8.0 8.0
0.06323631185054424 12.01050388164234 nan 8.0 8.0
0.06322611187997895 12.001096292852173 nan 8.0 8.0
0.06322218551902326 12.001630868379669 nan 8.0 8.0
U dimensions = (477, 30)
Iteration 0 of 1
phi.shape: (200, 477)
U.shape: (477, 30)
phi.dot(U).T shape: (30, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801278.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801278_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801278_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801278_test_data.npy
Cleanup complete.

Simulation 6/10 score: 0.940073034082123
Running repeat 7/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801313.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_132705_1741801313'
Loaded dataset: downsampled_500genes_132705_1741801313
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.20582209305920018 2.5927501084232163 nan 8.0 8.0
0.0724878853363713 10.556155902441146 nan 8.0 8.0
0.06799330479325028 10.86597614314207 nan 8.0 8.0
0.06561228693034493 11.23824173395673 nan 8.0 8.0
0.06421173853101947 11.300219436252444 nan 8.0 8.0
0.06323868052042392 11.41711619612353 nan 8.0 8.0
0.06271144518078586 11.461972108622554 nan 8.0 8.0
0.062173986611896326 11.538055116889474 nan 8.0 8.0
0.061820624428589155 11.64183208111607 nan 8.0 8.0
0.06157112898060324 11.722105903993015 nan 8.0 8.0
0.06134689284003303 11.724112833545771 nan 8.0 8.0
0.061139874652399784 11.738063792917593 nan 8.0 8.0
0.06106909412166761 11.750215219814898 nan 8.0 8.0
0.06103766056191906 11.69899127489667 nan 8.0 8.0
0.06101880601341969 11.668582740564304 nan 8.0 8.0
0.06098665865160913 11.670241293416286 nan 8.0 8.0
0.06096976260251341 11.669923824698856 nan 8.0 8.0
0.060949902986814464 11.67869764940102 nan 8.0 8.0
0.06095077929985904 11.675686825820822 nan 8.0 8.0
0.060949917471380566 11.678427218358557 nan 8.0 8.0
U dimensions = (477, 32)
Iteration 0 of 1
phi.shape: (200, 477)
U.shape: (477, 32)
phi.dot(U).T shape: (32, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801313.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801313_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801313_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801313_test_data.npy
Cleanup complete.

Simulation 7/10 score: 0.948649794063125
Running repeat 8/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801349.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_132705_1741801349'
Loaded dataset: downsampled_500genes_132705_1741801349
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.20347679306497035 2.7188992407846397 nan 8.0 8.0
0.07114686765977196 11.001890978670042 nan 8.0 8.0
0.06790628444945213 10.924022965434304 nan 8.0 8.0
0.06598022133807346 11.198459909536698 nan 8.0 8.0
0.06433459853965406 11.445910413652868 nan 8.0 8.0
0.06349409275818418 11.548168173974798 nan 8.0 8.0
0.06303469595490374 11.606016947805152 nan 8.0 8.0
0.06257160414679963 11.644069204717608 nan 8.0 8.0
0.06232950472020182 11.653520979944956 nan 8.0 8.0
0.062172716686817786 11.647856318696002 nan 8.0 8.0
0.06210087496751837 11.643440968750838 nan 8.0 8.0
0.06204963604364 11.630265484825069 nan 8.0 8.0
0.062025132438035424 11.618010386737135 nan 8.0 8.0
0.06197699790207467 11.613951449303517 nan 8.0 8.0
0.061905121210276026 11.617001475395707 nan 8.0 8.0
0.06185655012002722 11.588017394800024 nan 8.0 8.0
0.06179650873286846 11.598597606638984 nan 8.0 8.0
0.06173689477667521 11.573556964098056 nan 8.0 8.0
0.061690892611514725 11.568151492033605 nan 8.0 8.0
0.061658805124731986 11.549908412008502 nan 8.0 8.0
U dimensions = (477, 31)
Iteration 0 of 1
phi.shape: (200, 477)
U.shape: (477, 31)
phi.dot(U).T shape: (31, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801349.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801349_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801349_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801349_test_data.npy
Cleanup complete.

Simulation 8/10 score: 0.940598257173266
Running repeat 9/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801398.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_132705_1741801398'
Loaded dataset: downsampled_500genes_132705_1741801398
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.1869439945435587 2.7585537750523943 nan 8.0 8.0
0.06667972985377812 10.481088995029598 nan 8.0 8.0
0.06399683874282136 10.709583731733524 nan 8.0 8.0
0.06248952193545931 10.874460087506794 nan 8.0 8.0
0.061482646851390155 10.920620311944228 nan 8.0 8.0
0.06071274589354425 11.024287899076246 nan 8.0 8.0
0.060277992107705125 11.062813890378637 nan 8.0 8.0
0.06000056737819204 11.061208939866937 nan 8.0 8.0
0.059848287709717285 11.059902050610944 nan 8.0 8.0
0.05976711188532913 11.071999273610649 nan 8.0 8.0
0.05968223158204644 11.111007727859748 nan 8.0 8.0
0.059594190974484484 11.155386101639372 nan 8.0 8.0
0.05951447416975841 11.183798445868284 nan 8.0 8.0
0.059467403712618494 11.218189242295885 nan 8.0 8.0
0.05945136216326308 11.225713953316218 nan 8.0 8.0
0.059433923388712895 11.231268032801934 nan 8.0 8.0
0.05940399598651136 11.237967877990073 nan 8.0 8.0
0.05939026776325329 11.240744117123882 nan 8.0 8.0
0.05937954583530114 11.238568489869893 nan 8.0 8.0
0.05937803755111215 11.237860060845739 nan 8.0 8.0
U dimensions = (477, 31)
Iteration 0 of 1
phi.shape: (200, 477)
U.shape: (477, 31)
phi.dot(U).T shape: (31, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801398.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801398_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801398_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801398_test_data.npy
Cleanup complete.

Simulation 9/10 score: 0.9481365901963363
Running repeat 10/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801453.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_132705_1741801453'
Loaded dataset: downsampled_500genes_132705_1741801453
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.19640664865981394 2.8245913472206365 nan 8.0 8.0
0.07079616303711467 11.019519861060775 nan 8.0 8.0
0.06647375753374984 10.91353265749252 nan 8.0 8.0
0.06453941462657242 11.046014831393974 nan 8.0 8.0
0.06373788011047721 11.18285307989625 nan 8.0 8.0
0.06329422839303223 11.286464907795256 nan 8.0 8.0
0.06291970079235998 11.272779182679459 nan 8.0 8.0
0.06263226150982393 11.242524626280757 nan 8.0 8.0
0.06237636721746742 11.22930239908424 nan 8.0 8.0
0.06218639841852869 11.27279830368987 nan 8.0 8.0
0.062107633582056065 11.29339747541891 nan 8.0 8.0
0.062063860412305494 11.270117718765265 nan 8.0 8.0
0.06202591541293445 11.2615599014953 nan 8.0 8.0
0.06199179197531113 11.280492011047224 nan 8.0 8.0
0.061970410692792854 11.276145631279425 nan 8.0 8.0
0.06195303614773817 11.279805211775729 nan 8.0 8.0
0.061945250380677774 11.282578707807907 nan 8.0 8.0
0.06194515023998781 11.286001473300528 nan 8.0 8.0
0.061927023154275895 11.294575047130893 nan 8.0 8.0
0.06190414216786355 11.30500190466389 nan 8.0 8.0
U dimensions = (477, 30)
Iteration 0 of 1
phi.shape: (200, 477)
U.shape: (477, 30)
phi.dot(U).T shape: (30, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801453.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801453_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801453_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_132705_1741801453_test_data.npy
Cleanup complete.

Simulation 10/10 score: 0.9480652025288746
Results saved: results/simulation/results_optimal.csv
Running simulation with: num_measurements=100, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=5000
Running repeat 1/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741800915.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_132707_1741800915'
Loaded dataset: downsampled_5000genes_132707_1741800915
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.34825980113128274 10.79563600457566 1.0 8.0 8.0
0.28937548984094996 19.94299458353292 1.0 8.0 8.0
0.29321417787174275 17.335350482016974 1.0 8.0 8.0
0.2948535945745683 16.549500779493982 1.0 8.0 8.0
0.2958597536524581 16.617118933360423 1.0 8.0 8.0
0.2962851255202811 16.49576675814441 1.0 8.0 8.0
0.296216036986938 16.360903049267943 1.0 8.0 8.0
0.2962171296383572 16.30491720472255 1.0 8.0 8.0
0.29622062599652166 16.2651818158314 1.0 8.0 8.0
0.29622802999301634 16.251736866413502 1.0 8.0 8.0
0.296224710135077 16.246714055163338 1.0 8.0 8.0
0.29621834968972083 16.243103239566654 1.0 8.0 8.0
0.29621749357625005 16.24541707891188 1.0 8.0 8.0
0.29621671797194304 16.242855287081877 1.0 8.0 8.0
0.2962149597492285 16.240991770575903 1.0 8.0 8.0
0.2962135845924363 16.237477964737895 1.0 8.0 8.0
0.2962131740882157 16.243862121750013 1.0 8.0 8.0
0.29621307128171614 16.23449981055499 1.0 8.0 8.0
0.2962130156301078 16.238899510660772 1.0 8.0 8.0
0.2962131597637315 16.23839684811449 1.0 8.0 8.0
U dimensions = (4971, 32)
Iteration 0 of 1
phi.shape: (100, 4971)
U.shape: (4971, 32)
phi.dot(U).T shape: (32, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741800915.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741800915_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741800915_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741800915_test_data.npy
Cleanup complete.

Simulation 1/10 score: 0.7189620725809744
Running repeat 2/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741800982.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_132707_1741800982'
Loaded dataset: downsampled_5000genes_132707_1741800982
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3349023596589259 9.873183831057627 1.0 8.0 8.0
0.2889794368070887 17.656816180816143 1.0 8.0 8.0
0.2929177820511427 16.55489643960636 1.0 8.0 8.0
0.2937127324442994 16.76226856320441 1.0 8.0 8.0
0.2943907003918965 16.836913235022866 1.0 8.0 8.0
0.29441408891750576 16.86742099490772 1.0 8.0 8.0
0.29442173263423177 16.882975564087225 1.0 8.0 8.0
0.29446632882712775 16.932325530420467 1.0 8.0 8.0
0.29454657901359715 16.96552443138817 1.0 8.0 8.0
0.29459169667074314 16.967697908299133 1.0 8.0 8.0
0.2946557620253737 17.027532267332276 1.0 8.0 8.0
0.2949185241459036 17.225308679998957 1.0 8.0 8.0
0.29506095151059053 17.08508482758989 1.0 8.0 8.0
0.29528725429935776 17.022881332233066 1.0 8.0 8.0
0.295309770327004 16.994990172325906 1.0 8.0 8.0
0.2952935011691372 16.984170761668324 1.0 8.0 8.0
0.2952822856552332 16.976881919000867 1.0 8.0 8.0
0.295276224850605 16.96568412317306 1.0 8.0 8.0
0.2952682007398415 16.939025928022037 1.0 8.0 8.0
0.29526177993037306 16.938983796894732 1.0 8.0 8.0
U dimensions = (4971, 30)
Iteration 0 of 1
phi.shape: (100, 4971)
U.shape: (4971, 30)
phi.dot(U).T shape: (30, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741800982.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741800982_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741800982_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741800982_test_data.npy
Cleanup complete.

Simulation 2/10 score: 0.7360499127664525
Running repeat 3/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801047.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_132707_1741801047'
Loaded dataset: downsampled_5000genes_132707_1741801047
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3419815121601981 9.954343051018657 1.0 8.0 8.0
0.28513835777050944 17.795534223823463 1.0 8.0 8.0
0.29373094405330735 15.543109547533467 1.0 8.0 8.0
0.2957176254087972 15.130966419869894 1.0 8.0 8.0
0.2963190318347131 15.125955221771079 1.0 8.0 8.0
0.29711168313476244 15.080846887254502 1.0 8.0 8.0
0.2973182677204592 15.141801073441847 1.0 8.0 8.0
0.2974869564090813 15.172486227578869 1.0 8.0 8.0
0.2974707284094764 15.221244643373922 1.0 8.0 8.0
0.2970347651459817 15.282211011297907 1.0 8.0 8.0
0.29654427882710965 15.31303128786508 1.0 8.0 8.0
0.2965063499722974 15.304910090336875 1.0 8.0 8.0
0.2965672484155447 15.309227329081144 1.0 8.0 8.0
0.2965810008796216 15.298189109974778 1.0 8.0 8.0
0.2965811263375462 15.29865942899172 1.0 8.0 8.0
0.29658113286190757 15.298625723946344 1.0 8.0 8.0
0.2965811352540727 15.298658840445995 1.0 8.0 8.0
0.2965811355845769 15.298663539093294 1.0 8.0 8.0
0.29658113563152777 15.298664207394133 1.0 8.0 8.0
0.29658113563796595 15.298664301836356 1.0 8.0 8.0
U dimensions = (4971, 36)
Iteration 0 of 1
phi.shape: (100, 4971)
U.shape: (4971, 36)
phi.dot(U).T shape: (36, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801047.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801047_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801047_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801047_test_data.npy
Cleanup complete.

Simulation 3/10 score: 0.7187550937425575
Running repeat 4/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801112.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_132707_1741801112'
Loaded dataset: downsampled_5000genes_132707_1741801112
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3606289199367504 11.670227300385775 1.0 8.0 8.0
0.2893328459071818 19.083619195054453 1.0 8.0 8.0
0.2950607701350363 16.526582669139568 1.0 8.0 8.0
0.2962921730065332 16.128243974128505 1.0 8.0 8.0
0.2969787013454839 16.000778688667133 1.0 8.0 8.0
0.29735922353899125 15.859362261388258 1.0 8.0 8.0
0.29736310199589777 15.868959889097656 1.0 8.0 8.0
0.29734033104592394 15.844207673877785 1.0 8.0 8.0
0.2973054041148895 15.828845937027662 1.0 8.0 8.0
0.29730357667405616 15.825953748638815 1.0 8.0 8.0
0.2973036633422498 15.827640717354718 1.0 8.0 8.0
0.29730332146848426 15.82680124920714 1.0 8.0 8.0
0.29730334553676585 15.82625388161961 1.0 8.0 8.0
0.2973024316870879 15.824378517062904 1.0 8.0 8.0
0.2973002076574244 15.818312337029276 1.0 8.0 8.0
0.29729784992141384 15.812831365141259 1.0 8.0 8.0
0.2972973403929414 15.803406162840847 1.0 8.0 8.0
0.29729839489245136 15.797989792663579 1.0 8.0 8.0
0.2972885229912673 15.784419581846695 1.0 8.0 8.0
0.29727546452875053 15.777214707111163 1.0 8.0 8.0
U dimensions = (4971, 36)
Iteration 0 of 1
phi.shape: (100, 4971)
U.shape: (4971, 36)
phi.dot(U).T shape: (36, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801112.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801112_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801112_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801112_test_data.npy
Cleanup complete.

Simulation 4/10 score: 0.7004616890680703
Running repeat 5/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801177.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_132707_1741801177'
Loaded dataset: downsampled_5000genes_132707_1741801177
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.35781364499867263 10.852101140358705 1.0 8.0 8.0
0.29396823451754206 19.21874832233143 1.0 8.0 8.0
0.29689955105804244 17.50552333953469 1.0 8.0 8.0
0.29782816484696606 17.92501676854289 1.0 8.0 8.0
0.29801114837032017 17.873142585853717 1.0 8.0 8.0
0.2981098369584202 17.831328913644743 1.0 8.0 8.0
0.2981340570654285 17.850496008065285 1.0 8.0 8.0
0.29827870955806834 17.95221621231029 1.0 8.0 8.0
0.29856249600670226 17.955376265655122 1.0 8.0 8.0
0.29870522125480947 18.011461501705178 1.0 8.0 8.0
0.2986939754224185 17.958107771900607 1.0 8.0 8.0
0.2986774787321512 17.966861384475113 1.0 8.0 8.0
0.2986497347683086 17.947172978171547 1.0 8.0 8.0
0.2986304845064891 17.942018167284402 1.0 8.0 8.0
0.2986286936863519 17.96259595188472 1.0 8.0 8.0
0.298621857223345 17.97665761862342 1.0 8.0 8.0
0.29861908630291134 17.98891514195241 1.0 8.0 8.0
0.298617342628543 18.034965269746635 1.0 8.0 8.0
0.2986176529338318 18.041292498216404 1.0 8.0 8.0
0.2986171715258793 18.04179141442535 1.0 8.0 8.0
U dimensions = (4971, 35)
Iteration 0 of 1
phi.shape: (100, 4971)
U.shape: (4971, 35)
phi.dot(U).T shape: (35, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801177.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801177_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801177_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801177_test_data.npy
Cleanup complete.

Simulation 5/10 score: 0.7287974595062706
Running repeat 6/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801240.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_132707_1741801240'
Loaded dataset: downsampled_5000genes_132707_1741801240
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3582064056184928 11.674474432815137 1.0 8.0 8.0
0.282961618676823 20.3634439942082 1.0 8.0 8.0
0.288242588269638 17.45585415578606 1.0 8.0 8.0
0.2959281482528291 16.388382976177756 1.0 8.0 8.0
0.29711518080457555 16.444424883491205 1.0 8.0 8.0
0.29773126811724726 16.62356081085797 1.0 8.0 8.0
0.2982842158482637 16.735715500285206 1.0 8.0 8.0
0.2983735921811149 16.681959657088683 1.0 8.0 8.0
0.2983685798326976 16.63763277440638 1.0 8.0 8.0
0.2984570290854419 16.61576530790109 1.0 8.0 8.0
0.29844950972705053 16.610559152530328 1.0 8.0 8.0
0.29842945203582116 16.583660540184706 1.0 8.0 8.0
0.29841906890549463 16.5671503063447 1.0 8.0 8.0
0.29837814186917977 16.61470113894 1.0 8.0 8.0
0.2983357931475705 16.693826428255512 1.0 8.0 8.0
0.2982734824662314 16.72920364227771 1.0 8.0 8.0
0.2982848405510212 16.726704133822697 1.0 8.0 8.0
0.2982866510776224 16.731223767430087 1.0 8.0 8.0
0.2982891550399417 16.72951283134744 1.0 8.0 8.0
0.2982837976661227 16.71708986485493 1.0 8.0 8.0
U dimensions = (4971, 33)
Iteration 0 of 1
phi.shape: (100, 4971)
U.shape: (4971, 33)
phi.dot(U).T shape: (33, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801240.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801240_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801240_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801240_test_data.npy
Cleanup complete.

Simulation 6/10 score: 0.716182652677837
Running repeat 7/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801308.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_132707_1741801308'
Loaded dataset: downsampled_5000genes_132707_1741801308
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3522122743057834 10.859954848066364 1.0 8.0 8.0
0.2906094422089902 19.230535377016743 1.0 8.0 8.0
0.29628033453234004 17.182498565840106 1.0 8.0 8.0
0.29787114271454884 16.787619854993544 1.0 8.0 8.0
0.29811171784049717 16.97078998158571 1.0 8.0 8.0
0.2982921507092394 17.004441901483123 1.0 8.0 8.0
0.2981338416720828 16.800523609591835 1.0 8.0 8.0
0.2980573431711907 16.742947823142906 1.0 8.0 8.0
0.2980778397417674 16.80122927990473 1.0 8.0 8.0
0.298075653854737 16.757652240636535 1.0 8.0 8.0
0.2980718414839685 16.74884290009704 1.0 8.0 8.0
0.2980696016425268 16.834491858553786 1.0 8.0 8.0
0.29806753100014405 16.829154499791613 1.0 8.0 8.0
0.29806328200876 16.82473225257941 1.0 8.0 8.0
0.29806128795772824 16.82281846317518 1.0 8.0 8.0
0.2980591978115187 16.818070705436256 1.0 8.0 8.0
0.29805481703843806 16.815382476814747 1.0 8.0 8.0
0.2980526563608248 16.8124365615626 1.0 8.0 8.0
0.29805010108703445 16.806969889825098 1.0 8.0 8.0
0.2980462797844098 16.807096448501905 1.0 8.0 8.0
U dimensions = (4971, 36)
Iteration 0 of 1
phi.shape: (100, 4971)
U.shape: (4971, 36)
phi.dot(U).T shape: (36, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801308.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801308_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801308_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801308_test_data.npy
Cleanup complete.

Simulation 7/10 score: 0.7012887132278026
Running repeat 8/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801371.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_132707_1741801371'
Loaded dataset: downsampled_5000genes_132707_1741801371
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3627225053150467 10.421262729086848 1.0 8.0 8.0
0.28755505590008246 19.67568401607063 1.0 8.0 8.0
0.29330161187011705 17.03878305694732 1.0 8.0 8.0
0.2937911523009126 16.507814924618035 1.0 8.0 8.0
0.2941120892937791 16.322225722729275 1.0 8.0 8.0
0.2940928429519861 16.288348366226064 1.0 8.0 8.0
0.2941437340145422 16.211728716194727 1.0 8.0 8.0
0.29413040104248633 16.188508544615914 1.0 8.0 8.0
0.29412564805557984 16.21160599802797 1.0 8.0 8.0
0.2941231126401791 16.20814358283958 1.0 8.0 8.0
0.29412221555242835 16.204989076031165 1.0 8.0 8.0
0.29412134138029644 16.207140336556943 1.0 8.0 8.0
0.2941204460549791 16.209161269727236 1.0 8.0 8.0
0.29411858538420343 16.211216654278758 1.0 8.0 8.0
0.2941181452311552 16.210471993276098 1.0 8.0 8.0
0.294118058922623 16.21080149305611 1.0 8.0 8.0
0.29411806092271164 16.210799698747184 1.0 8.0 8.0
0.29411806107710625 16.210799694635345 1.0 8.0 8.0
0.2941180610791425 16.21079969604605 1.0 8.0 8.0
0.2941180610803654 16.210799697993657 1.0 8.0 8.0
U dimensions = (4971, 37)
Iteration 0 of 1
phi.shape: (100, 4971)
U.shape: (4971, 37)
phi.dot(U).T shape: (37, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801371.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801371_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801371_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801371_test_data.npy
Cleanup complete.

Simulation 8/10 score: 0.7049816222218797
Running repeat 9/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801439.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_132707_1741801439'
Loaded dataset: downsampled_5000genes_132707_1741801439
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.37059590798574416 12.156040700035872 1.0 8.0 8.0
0.28384189620318534 20.909350436639343 1.0 8.0 8.0
0.2923935973166303 18.418510906516765 1.0 8.0 8.0
0.29721719141879466 17.561309075054822 1.0 8.0 8.0
0.2986252898965961 17.252470697123574 1.0 8.0 8.0
0.2985422898837531 17.234478521798813 1.0 8.0 8.0
0.2984093053616743 17.161953547643293 1.0 8.0 8.0
0.29839912824873605 17.171128602575 1.0 8.0 8.0
0.29836948889700265 17.16431044082826 1.0 8.0 8.0
0.2983368264976256 17.13336547198731 1.0 8.0 8.0
0.2983370993999812 17.120542730810662 1.0 8.0 8.0
0.2983357121504481 17.119711246540263 1.0 8.0 8.0
0.2983341883276316 17.118427189202166 1.0 8.0 8.0
0.2983324207929873 17.116937865771284 1.0 8.0 8.0
0.29833098177907325 17.115194696276617 1.0 8.0 8.0
0.2983284936142522 17.111103034857074 1.0 8.0 8.0
0.2983282341939423 17.10729099438632 1.0 8.0 8.0
0.29832819445137837 17.105438389238785 1.0 8.0 8.0
0.29832807356629254 17.10453490473901 1.0 8.0 8.0
0.29832782942661284 17.103273045215822 1.0 8.0 8.0
U dimensions = (4971, 32)
Iteration 0 of 1
phi.shape: (100, 4971)
U.shape: (4971, 32)
phi.dot(U).T shape: (32, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801439.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801439_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801439_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801439_test_data.npy
Cleanup complete.

Simulation 9/10 score: 0.7146582838179536
Running repeat 10/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801504.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_132707_1741801504'
Loaded dataset: downsampled_5000genes_132707_1741801504
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.34378612589909296 10.547980509664121 1.0 8.0 8.0
0.28817281769044467 18.650429504416547 1.0 8.0 8.0
0.2923486353012842 17.41259640611028 1.0 8.0 8.0
0.29308085710845944 16.93292897181759 1.0 8.0 8.0
0.29360651984967034 16.89051917386747 1.0 8.0 8.0
0.29369153279021165 16.7575242971503 1.0 8.0 8.0
0.29372570906779516 16.653492995850726 1.0 8.0 8.0
0.29374867626785983 16.60725706820508 1.0 8.0 8.0
0.2937488668392604 16.590236379633964 1.0 8.0 8.0
0.29374660627066307 16.62348634102017 1.0 8.0 8.0
0.29374428196016955 16.651937243144907 1.0 8.0 8.0
0.2937379419052414 16.67327491071093 1.0 8.0 8.0
0.2937310521398685 16.68403963580242 1.0 8.0 8.0
0.2937237460729447 16.65222242264354 1.0 8.0 8.0
0.293722393899412 16.685824412106214 1.0 8.0 8.0
0.29372243416505617 16.684186525405675 1.0 8.0 8.0
0.2937222392498502 16.68409712495801 1.0 8.0 8.0
0.2937205251855126 16.693668699846988 1.0 8.0 8.0
0.2937208541890275 16.69495358524323 1.0 8.0 8.0
0.293720758105637 16.692726765450395 1.0 8.0 8.0
U dimensions = (4971, 36)
Iteration 0 of 1
phi.shape: (100, 4971)
U.shape: (4971, 36)
phi.dot(U).T shape: (36, 100)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801504.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801504_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801504_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_132707_1741801504_test_data.npy
Cleanup complete.

Simulation 10/10 score: 0.6957228307636543
Results saved: results/simulation/results_optimal.csv
Running simulation with: num_measurements=25, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=5000
Running repeat 1/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741799966.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3990217_1741799966'
Loaded dataset: downsampled_5000genes_3990217_1741799966
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.34796830275549195 12.4654257781269 1.0 8.0 8.0
0.2821471048455034 19.837624530267504 1.0 8.0 8.0
0.2887062605799149 17.385958654114784 1.0 8.0 8.0
0.29405984272174013 16.329749258247833 1.0 8.0 8.0
0.29852089268275217 15.758459702661236 1.0 8.0 8.0
0.29950643824142265 15.851116576604708 1.0 8.0 8.0
0.2998674442750511 15.942369395381634 1.0 8.0 8.0
0.30010970393629643 16.12257807253283 1.0 8.0 8.0
0.29993895648904445 15.937028667491896 1.0 8.0 8.0
0.29978125949754 15.969077402989884 1.0 8.0 8.0
0.2995655767798999 15.971096376755682 1.0 8.0 8.0
0.29927420053058373 16.047800324643156 1.0 8.0 8.0
0.2991787657821787 16.107279719423556 1.0 8.0 8.0
0.29916651204095634 16.130770870809855 1.0 8.0 8.0
0.29915969560948585 16.115210177222878 1.0 8.0 8.0
0.2991577918074866 16.124721800008718 1.0 8.0 8.0
0.2991571240739378 16.12377602960389 1.0 8.0 8.0
0.299156303354021 16.124934387881346 1.0 8.0 8.0
0.2991563320608067 16.12261585448177 1.0 8.0 8.0
0.2991556482901694 16.12266744533156 1.0 8.0 8.0
U dimensions = (4971, 34)
Iteration 0 of 1
phi.shape: (25, 4971)
U.shape: (4971, 34)
phi.dot(U).T shape: (34, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741799966.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741799966_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741799966_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741799966_test_data.npy
Cleanup complete.

Simulation 1/10 score: 0.6432332442444931
Running repeat 2/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800053.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3990217_1741800053'
Loaded dataset: downsampled_5000genes_3990217_1741800053
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3527390052642859 11.666346892914829 1.0 8.0 8.0
0.28581722787383756 19.52897090334151 1.0 8.0 8.0
0.2909648441867938 17.272433439873826 1.0 8.0 8.0
0.2931196377769639 16.801138627342574 1.0 8.0 8.0
0.2942770903932811 16.58609619546453 1.0 8.0 8.0
0.29478801380082464 16.494084556038985 1.0 8.0 8.0
0.2952006484420747 16.637196425685318 1.0 8.0 8.0
0.2951265864945555 16.838709574015635 1.0 8.0 8.0
0.2951525169570153 16.960536532822523 1.0 8.0 8.0
0.295256142727943 16.880894172459257 1.0 8.0 8.0
0.29514781311498217 16.851078842914113 1.0 8.0 8.0
0.295092569552718 16.8549675231227 1.0 8.0 8.0
0.2950523605499571 16.86758693071141 1.0 8.0 8.0
0.29505125672235055 16.887923971420264 1.0 8.0 8.0
0.2950510134910733 16.887051298231402 1.0 8.0 8.0
0.29505091827795216 16.886957145154966 1.0 8.0 8.0
0.29505093231239554 16.886904376154966 1.0 8.0 8.0
0.29505092613405626 16.886925060768682 1.0 8.0 8.0
0.2950509285074322 16.886917282318468 1.0 8.0 8.0
0.29505092757858875 16.886920355718257 1.0 8.0 8.0
U dimensions = (4971, 33)
Iteration 0 of 1
phi.shape: (25, 4971)
U.shape: (4971, 33)
phi.dot(U).T shape: (33, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800053.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800053_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800053_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800053_test_data.npy
Cleanup complete.

Simulation 2/10 score: 0.6852541481061821
Running repeat 3/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800138.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3990217_1741800138'
Loaded dataset: downsampled_5000genes_3990217_1741800138
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.37409048521467136 12.81954059521125 1.0 8.0 8.0
0.2716202443936948 22.77238930212261 1.0 8.0 8.0
0.2836394450642049 17.720602711292944 1.0 8.0 8.0
0.2914074539982512 16.615187084123576 1.0 8.0 8.0
0.2928719628174117 16.512683330027496 1.0 8.0 8.0
0.29438416899865105 16.342009560040996 1.0 8.0 8.0
0.2953655691886464 16.45766058997968 1.0 8.0 8.0
0.29573232349358614 16.513978701848018 1.0 8.0 8.0
0.2958247363311408 16.54883214819275 1.0 8.0 8.0
0.29607188510027105 16.6634243684204 1.0 8.0 8.0
0.2961424752245301 16.537712935011907 1.0 8.0 8.0
0.29623313552506103 16.652717555456675 1.0 8.0 8.0
0.2962345878001277 16.798013226434783 1.0 8.0 8.0
0.2962058167631004 16.815668286456308 1.0 8.0 8.0
0.29617865200548166 16.83357548619439 1.0 8.0 8.0
0.2961625654270704 16.85066532306849 1.0 8.0 8.0
0.29613812281052776 16.871197622581146 1.0 8.0 8.0
0.29613776290087934 16.873053365968754 1.0 8.0 8.0
0.2961377424018966 16.87573874085738 1.0 8.0 8.0
0.2961387610898025 16.894546696768383 1.0 8.0 8.0
U dimensions = (4971, 32)
Iteration 0 of 1
phi.shape: (25, 4971)
U.shape: (4971, 32)
phi.dot(U).T shape: (32, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800138.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800138_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800138_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800138_test_data.npy
Cleanup complete.

Simulation 3/10 score: 0.6771002241241119
Running repeat 4/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800299.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3990217_1741800299'
Loaded dataset: downsampled_5000genes_3990217_1741800299
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.33633859942173816 11.872248909656633 1.0 8.0 8.0
0.2849347214494008 20.329899227542473 1.0 8.0 8.0
0.2935526227458659 17.661386626535492 1.0 8.0 8.0
0.29462637991511187 16.885669423380698 1.0 8.0 8.0
0.29473422875607647 16.970969553917513 1.0 8.0 8.0
0.29494432501372303 16.904833105700536 1.0 8.0 8.0
0.29508385080811417 16.754571775537464 1.0 8.0 8.0
0.2951679009119885 16.59837661780342 1.0 8.0 8.0
0.295178928576702 16.532610308934167 1.0 8.0 8.0
0.2951848507219784 16.48052781820696 1.0 8.0 8.0
0.2951840795647479 16.4188066407139 1.0 8.0 8.0
0.2951798795853692 16.41428347546305 1.0 8.0 8.0
0.2951738728252259 16.418673162932446 1.0 8.0 8.0
0.29516788708297537 16.431157637170486 1.0 8.0 8.0
0.29516437514156235 16.456943362533103 1.0 8.0 8.0
0.2951638891137719 16.45771957484263 1.0 8.0 8.0
0.29516362824454767 16.457135594763635 1.0 8.0 8.0
0.2951620574322361 16.447566537471232 1.0 8.0 8.0
0.2951609275327295 16.44291545107346 1.0 8.0 8.0
0.2951524936191202 16.436172980121512 1.0 8.0 8.0
U dimensions = (4971, 32)
Iteration 0 of 1
phi.shape: (25, 4971)
U.shape: (4971, 32)
phi.dot(U).T shape: (32, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800299.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800299_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800299_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800299_test_data.npy
Cleanup complete.

Simulation 4/10 score: 0.6604905387931901
Running repeat 5/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800486.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3990217_1741800486'
Loaded dataset: downsampled_5000genes_3990217_1741800486
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.362590563997217 12.22699957435712 1.0 8.0 8.0
0.28682436732398353 20.49820410742622 1.0 8.0 8.0
0.2960951502809255 16.266961369850797 1.0 8.0 8.0
0.29779556901366844 16.346457008283682 1.0 8.0 8.0
0.29860542925091604 16.15809497266196 1.0 8.0 8.0
0.29937967790720243 16.117813964910773 1.0 8.0 8.0
0.30015563186050587 16.438597505162033 1.0 8.0 8.0
0.3006101680796214 16.56052409590272 1.0 8.0 8.0
0.3007711164336059 16.524941382739183 1.0 8.0 8.0
0.30077224116953094 16.502649397715157 1.0 8.0 8.0
0.3007711848365221 16.515512419399144 1.0 8.0 8.0
0.30077073623983697 16.54103380021721 1.0 8.0 8.0
0.30076816011195395 16.55984782130256 1.0 8.0 8.0
0.3007661428850025 16.556396166758066 1.0 8.0 8.0
0.3007653698344763 16.550523584543534 1.0 8.0 8.0
0.30076304478086247 16.603907924982074 1.0 8.0 8.0
0.3007633633547956 16.617013209225224 1.0 8.0 8.0
0.30076472393320364 16.615122027700277 1.0 8.0 8.0
0.3007648298442325 16.610028167307885 1.0 8.0 8.0
0.30076530607932184 16.60560239750874 1.0 8.0 8.0
U dimensions = (4971, 35)
Iteration 0 of 1
phi.shape: (25, 4971)
U.shape: (4971, 35)
phi.dot(U).T shape: (35, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800486.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800486_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800486_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800486_test_data.npy
Cleanup complete.

Simulation 5/10 score: 0.5706608987745407
Running repeat 6/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800671.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3990217_1741800671'
Loaded dataset: downsampled_5000genes_3990217_1741800671
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.33831317262588645 10.23766701629087 1.0 8.0 8.0
0.2869983412462678 18.598945882805396 1.0 8.0 8.0
0.2945952256357648 16.66520465056809 1.0 8.0 8.0
0.29610627562941416 16.674579444433483 1.0 8.0 8.0
0.2963774191281979 16.799221644876106 1.0 8.0 8.0
0.29685572713402075 17.00591857570125 1.0 8.0 8.0
0.29740466465460735 17.013479118113406 1.0 8.0 8.0
0.2977930878905142 16.99977246952614 1.0 8.0 8.0
0.2978800644982895 16.995525423107868 1.0 8.0 8.0
0.297958644095376 16.98127572974756 1.0 8.0 8.0
0.29795713491663256 16.985679724115187 1.0 8.0 8.0
0.2979556369627624 16.980875859123767 1.0 8.0 8.0
0.29795192022504746 16.97996638371859 1.0 8.0 8.0
0.29794703187719807 16.97485987283963 1.0 8.0 8.0
0.2979051418281051 16.95518331439691 1.0 8.0 8.0
0.29790357446855065 16.94394545952518 1.0 8.0 8.0
0.2979029032113988 16.94460041417821 1.0 8.0 8.0
0.2979025821797494 16.939748329621732 1.0 8.0 8.0
0.2978999485320376 16.9361218795865 1.0 8.0 8.0
0.29789760575377544 16.97436558604302 1.0 8.0 8.0
U dimensions = (4971, 35)
Iteration 0 of 1
phi.shape: (25, 4971)
U.shape: (4971, 35)
phi.dot(U).T shape: (35, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800671.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800671_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800671_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800671_test_data.npy
Cleanup complete.

Simulation 6/10 score: 0.657483793033114
Running repeat 7/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800881.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3990217_1741800881'
Loaded dataset: downsampled_5000genes_3990217_1741800881
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3563146403579087 11.212208103122626 1.0 8.0 8.0
0.28649696633515653 19.20524175771464 1.0 8.0 8.0
0.2954081396408308 17.138439004527534 1.0 8.0 8.0
0.2971937516304368 16.695874831637816 1.0 8.0 8.0
0.2980792433687667 16.551421300025545 1.0 8.0 8.0
0.29894793745869774 16.438411226554745 1.0 8.0 8.0
0.29899959501886264 16.45710510367598 1.0 8.0 8.0
0.2988023309104033 16.494112080958836 1.0 8.0 8.0
0.29866166251372683 16.50701419679645 1.0 8.0 8.0
0.2986270533920288 16.51962496321409 1.0 8.0 8.0
0.298616893713039 16.523274950399493 1.0 8.0 8.0
0.2986085596309519 16.51009443654973 1.0 8.0 8.0
0.2985999953442886 16.503244246893335 1.0 8.0 8.0
0.2985951489288017 16.50262739182155 1.0 8.0 8.0
0.2985913524697098 16.499051422119837 1.0 8.0 8.0
0.2985891399142916 16.496506420174622 1.0 8.0 8.0
0.29858840204388704 16.490249813593092 1.0 8.0 8.0
0.2985874783877267 16.488753994383373 1.0 8.0 8.0
0.2985874352786001 16.489899316330796 1.0 8.0 8.0
0.29858743450467906 16.48990507389377 1.0 8.0 8.0
U dimensions = (4971, 33)
Iteration 0 of 1
phi.shape: (25, 4971)
U.shape: (4971, 33)
phi.dot(U).T shape: (33, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800881.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800881_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800881_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741800881_test_data.npy
Cleanup complete.

Simulation 7/10 score: 0.6566471954651203
Running repeat 8/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741801144.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3990217_1741801144'
Loaded dataset: downsampled_5000genes_3990217_1741801144
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3388987156078528 10.794338828486838 1.0 8.0 8.0
0.28560365449587366 17.737785549075113 1.0 8.0 8.0
0.2929446233720232 15.66120018246636 1.0 8.0 8.0
0.2944908049271334 15.745207941442958 1.0 8.0 8.0
0.2961444449680427 15.910830541472727 1.0 8.0 8.0
0.29732816662394024 16.168949956926326 1.0 8.0 8.0
0.298141955941143 16.34736652187025 1.0 8.0 8.0
0.29833976835420084 16.32344380337386 1.0 8.0 8.0
0.29844915009788975 16.10569375328821 1.0 8.0 8.0
0.2986322013848436 16.065418227060192 1.0 8.0 8.0
0.29862486464586624 16.132650752528487 1.0 8.0 8.0
0.29860967587500586 16.12479916077846 1.0 8.0 8.0
0.29860726895227674 16.124136305035915 1.0 8.0 8.0
0.29860632948034216 16.125601780290566 1.0 8.0 8.0
0.29860625296504617 16.120628135780343 1.0 8.0 8.0
0.2986061180624392 16.118811704958304 1.0 8.0 8.0
0.2986060474462484 16.117868967290203 1.0 8.0 8.0
0.2986060459642884 16.11784564383274 1.0 8.0 8.0
0.29860604591741713 16.117844939945556 1.0 8.0 8.0
0.29860604591571827 16.11784491215574 1.0 8.0 8.0
U dimensions = (4971, 36)
Iteration 0 of 1
phi.shape: (25, 4971)
U.shape: (4971, 36)
phi.dot(U).T shape: (36, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741801144.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741801144_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741801144_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741801144_test_data.npy
Cleanup complete.

Simulation 8/10 score: 0.6329911855135938
Running repeat 9/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741801340.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3990217_1741801340'
Loaded dataset: downsampled_5000genes_3990217_1741801340
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3445836801802258 11.57205787533652 1.0 8.0 8.0
0.28736269547607596 18.760816916361627 1.0 8.0 8.0
0.2930821926048369 16.74751049577562 1.0 8.0 8.0
0.2953174607351102 16.133255821392417 1.0 8.0 8.0
0.29573804013152505 16.336243601391704 1.0 8.0 8.0
0.295655583233124 16.359516836690847 1.0 8.0 8.0
0.2957441832220753 16.35905409339961 1.0 8.0 8.0
0.29577704221728196 16.35857438652459 1.0 8.0 8.0
0.2957573831490051 16.37544961719609 1.0 8.0 8.0
0.29574845529258376 16.385080598120982 1.0 8.0 8.0
0.29574409195977236 16.383361993519834 1.0 8.0 8.0
0.2957485140151398 16.39916707394247 1.0 8.0 8.0
0.2957477184915216 16.41035205505329 1.0 8.0 8.0
0.2957502512516219 16.40783157369313 1.0 8.0 8.0
0.29575412947870605 16.38588493008413 1.0 8.0 8.0
0.29575489372628094 16.381702599360636 1.0 8.0 8.0
0.29575511475714955 16.383283349495002 1.0 8.0 8.0
0.2957550951881325 16.38484198283095 1.0 8.0 8.0
0.2957551108735237 16.388281682892504 1.0 8.0 8.0
0.2957551196561179 16.38978785941022 1.0 8.0 8.0
U dimensions = (4971, 34)
Iteration 0 of 1
phi.shape: (25, 4971)
U.shape: (4971, 34)
phi.dot(U).T shape: (34, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741801340.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741801340_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741801340_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741801340_test_data.npy
Cleanup complete.

Simulation 9/10 score: 0.6395870579447271
Running repeat 10/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741801592.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3990217_1741801592'
Loaded dataset: downsampled_5000genes_3990217_1741801592
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3940483423536958 11.883729083847953 1.0 8.0 8.0
0.27832032207433366 23.283845385343827 1.0 8.0 8.0
0.28621065330603124 19.34743572195263 1.0 8.0 8.0
0.2923654656448442 17.815283020884095 1.0 8.0 8.0
0.2995856211656458 17.436966276129876 1.0 8.0 8.0
0.30036411345156977 17.103080214028843 1.0 8.0 8.0
0.3006192594078344 17.10125549623162 1.0 8.0 8.0
0.3008013556423943 17.132388241865158 1.0 8.0 8.0
0.3008815480662532 17.214854547412422 1.0 8.0 8.0
0.3009601714211433 17.183123965523436 1.0 8.0 8.0
0.3009528332657331 17.246956354070726 1.0 8.0 8.0
0.3009495564690491 17.242916906338444 1.0 8.0 8.0
0.3009487536132507 17.249061861617204 1.0 8.0 8.0
0.3009484862246399 17.250467695404318 1.0 8.0 8.0
0.3009474793406356 17.251926139698607 1.0 8.0 8.0
0.30094555229078435 17.25228264515622 1.0 8.0 8.0
0.30094538354340006 17.252150304642317 1.0 8.0 8.0
0.30094538831974926 17.252140763806306 1.0 8.0 8.0
0.3009453886082133 17.25214044754073 1.0 8.0 8.0
0.30094538862091635 17.25214041121773 1.0 8.0 8.0
U dimensions = (4971, 35)
Iteration 0 of 1
phi.shape: (25, 4971)
U.shape: (4971, 35)
phi.dot(U).T shape: (35, 25)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741801592.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741801592_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741801592_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3990217_1741801592_test_data.npy
Cleanup complete.

Simulation 10/10 score: 0.6600936456678898
Results saved: results/simulation/results_optimal.csv
Running simulation with: num_measurements=200, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=1000
Running repeat 1/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801439.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_282385_1741801439'
Loaded dataset: downsampled_1000genes_282385_1741801439
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.17978582873587134 6.1968658181443415 1.0 8.0 8.0
0.08229555290102741 13.045749723038533 1.0 8.0 8.0
0.08066147102127685 12.69876711937749 1.0 8.0 8.0
0.07943758199103923 12.34277992606724 1.0 8.0 8.0
0.07916276921402043 11.98090664104828 1.0 8.0 8.0
0.07930705921291281 11.59287634210513 1.0 8.0 8.0
0.07967756327913622 11.208726582797045 1.0 8.0 8.0
0.07994773113846665 11.03281533505274 1.0 8.0 8.0
0.07992497699511592 10.973277720608374 1.0 8.0 8.0
0.07994438330698905 10.916606820739892 1.0 8.0 8.0
0.07987794950775517 10.939156894495268 1.0 8.0 8.0
0.07981369217660217 10.954624791816718 1.0 8.0 8.0
0.0798237277494831 10.942904356845796 1.0 8.0 8.0
0.07983212401278261 10.972423389928409 1.0 8.0 8.0
0.07983587211561627 10.957391648916744 1.0 8.0 8.0
0.07982673801302254 10.969013081634886 1.0 8.0 8.0
0.079828349210048 10.895676585196368 1.0 8.0 8.0
0.07984562128831107 10.855238548387524 1.0 8.0 8.0
0.07985185059182776 10.868548482468029 1.0 8.0 8.0
0.07983378980929501 10.867664722979784 1.0 8.0 8.0
U dimensions = (906, 38)
Iteration 0 of 1
phi.shape: (200, 906)
U.shape: (906, 38)
phi.dot(U).T shape: (38, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801439.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801439_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801439_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801439_test_data.npy
Cleanup complete.

Simulation 1/10 score: 0.8663913468020339
Running repeat 2/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801491.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_282385_1741801491'
Loaded dataset: downsampled_1000genes_282385_1741801491
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.18133370143898186 5.805673670344381 nan 8.0 8.0
0.08385709234049021 13.118903979722718 nan 8.0 8.0
0.08175910291041077 12.01427521019199 nan 8.0 8.0
0.08065712090884647 11.666769734246195 nan 8.0 8.0
0.08042255437964407 11.578563560104483 nan 8.0 8.0
0.08021995857117692 11.598005985751369 nan 8.0 8.0
0.07999367365374177 11.665746198311922 nan 8.0 8.0
0.0799195710149877 11.571970918124727 nan 8.0 8.0
0.07989306920716133 11.409916259921536 nan 8.0 8.0
0.07979325715611618 11.37960646618007 nan 8.0 8.0
0.07971658875015708 11.38391122491494 nan 8.0 8.0
0.07971759723041638 11.367144406238086 nan 8.0 8.0
0.07972193186062526 11.35344540142223 nan 8.0 8.0
0.07972101977372903 11.335928755448357 nan 8.0 8.0
0.07972176992955893 11.34374404836173 nan 8.0 8.0
0.07972179669209412 11.355527705906644 nan 8.0 8.0
0.07972173875642818 11.357584724317887 nan 8.0 8.0
0.07972178792789553 11.35758584980255 nan 8.0 8.0
0.07972170663551248 11.357247957556133 nan 8.0 8.0
0.0797217246278531 11.356779903489207 nan 8.0 8.0
U dimensions = (906, 35)
Iteration 0 of 1
phi.shape: (200, 906)
U.shape: (906, 35)
phi.dot(U).T shape: (35, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801491.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801491_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801491_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801491_test_data.npy
Cleanup complete.

Simulation 2/10 score: 0.8417008933389093
Running repeat 3/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801545.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_282385_1741801545'
Loaded dataset: downsampled_1000genes_282385_1741801545
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.16396266821504113 5.297938192424652 1.0 8.0 8.0
0.08362449523408688 12.129858292700217 1.0 8.0 8.0
0.08140549194399616 11.639944739575515 1.0 8.0 8.0
0.08062684194882241 11.313796388887402 1.0 8.0 8.0
0.0804751616282704 11.137425454959864 1.0 8.0 8.0
0.08047106898579937 11.01983068690377 1.0 8.0 8.0
0.08037959846943454 10.95025946267171 1.0 8.0 8.0
0.08042418209788749 10.912959469832906 1.0 8.0 8.0
0.08040962692291465 10.873545259479465 1.0 8.0 8.0
0.08038227108332596 10.88325925055662 1.0 8.0 8.0
0.08042632915302117 10.864383569640651 1.0 8.0 8.0
0.08049036207566795 10.902283218283436 1.0 8.0 8.0
0.08050675505139915 10.891630985625923 1.0 8.0 8.0
0.08052235727175039 10.885612549072292 1.0 8.0 8.0
0.08052698501877409 10.88689701340472 1.0 8.0 8.0
0.08052758702825225 10.888910946719378 1.0 8.0 8.0
0.08052752078510261 10.888874103425742 1.0 8.0 8.0
0.08052751952693804 10.888874647353092 1.0 8.0 8.0
0.08052751951756609 10.888874627011692 1.0 8.0 8.0
0.08052751951731163 10.888874626679938 1.0 8.0 8.0
U dimensions = (906, 34)
Iteration 0 of 1
phi.shape: (200, 906)
U.shape: (906, 34)
phi.dot(U).T shape: (34, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801545.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801545_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801545_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801545_test_data.npy
Cleanup complete.

Simulation 3/10 score: 0.8380074925721829
Running repeat 4/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801603.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_282385_1741801603'
Loaded dataset: downsampled_1000genes_282385_1741801603
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.1592204039213142 5.804703976395675 1.0 8.0 8.0
0.0854799525174843 12.880320429179806 1.0 8.0 8.0
0.08234210588388513 12.161733324211205 1.0 8.0 8.0
0.08153620242622128 12.003609350696713 1.0 8.0 8.0
0.08118476431056687 11.86799135421772 1.0 8.0 8.0
0.08092797535959817 11.883008353025817 1.0 8.0 8.0
0.0807167256800202 11.886044263529868 1.0 8.0 8.0
0.08066300224177692 11.863860810534694 1.0 8.0 8.0
0.08075328749771604 11.815837874274905 1.0 8.0 8.0
0.08081627174414385 11.784054112605578 1.0 8.0 8.0
0.08087593752074118 11.754099505831062 1.0 8.0 8.0
0.08090484473621484 11.747816472999672 1.0 8.0 8.0
0.08093357165549275 11.73470405839877 1.0 8.0 8.0
0.08099500658683412 11.71111642730812 1.0 8.0 8.0
0.08104972932481191 11.671677676224087 1.0 8.0 8.0
0.08107795956300134 11.662339390812582 1.0 8.0 8.0
0.08111011666223655 11.655129006349117 1.0 8.0 8.0
0.08113913531906813 11.646728006256112 1.0 8.0 8.0
0.08117685860933721 11.635034428119658 1.0 8.0 8.0
0.0812191451430051 11.623338167575593 1.0 8.0 8.0
U dimensions = (906, 36)
Iteration 0 of 1
phi.shape: (200, 906)
U.shape: (906, 36)
phi.dot(U).T shape: (36, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801603.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801603_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801603_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801603_test_data.npy
Cleanup complete.

Simulation 4/10 score: 0.873351001655374
Running repeat 5/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801665.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_282385_1741801665'
Loaded dataset: downsampled_1000genes_282385_1741801665
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.1586660202384076 5.649555098216933 1.0 8.0 8.0
0.08630788166615999 14.221791992857586 1.0 8.0 8.0
0.08344470772880175 13.370462810513324 1.0 8.0 8.0
0.0827263777746653 13.164510281364443 1.0 8.0 8.0
0.08232860022600119 13.122026696400143 1.0 8.0 8.0
0.08189675275867891 12.962480074996662 1.0 8.0 8.0
0.08165555424968918 12.859328615467309 1.0 8.0 8.0
0.08141924289900038 12.851447862971314 1.0 8.0 8.0
0.08120910138352133 12.74861487171364 1.0 8.0 8.0
0.08109299907427892 12.735099975301345 1.0 8.0 8.0
0.08099959340038998 12.736581001119884 1.0 8.0 8.0
0.08107593775467192 12.688911310352866 1.0 8.0 8.0
0.08105360119901261 12.669458351284948 1.0 8.0 8.0
0.08095817636460867 12.670488190974913 1.0 8.0 8.0
0.0808541447599076 12.674025026383811 1.0 8.0 8.0
0.08080857391421337 12.671574784545438 1.0 8.0 8.0
0.08079473532324555 12.669121849958431 1.0 8.0 8.0
0.08075526633755181 12.673706174980218 1.0 8.0 8.0
0.0807354522819923 12.67857173388818 1.0 8.0 8.0
0.08072178485057113 12.68151956994513 1.0 8.0 8.0
U dimensions = (906, 34)
Iteration 0 of 1
phi.shape: (200, 906)
U.shape: (906, 34)
phi.dot(U).T shape: (34, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801665.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801665_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801665_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801665_test_data.npy
Cleanup complete.

Simulation 5/10 score: 0.8780222934395708
Running repeat 6/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801715.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_282385_1741801715'
Loaded dataset: downsampled_1000genes_282385_1741801715
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.14301647689401087 5.909995133269649 1.0 8.0 8.0
0.0764586563704277 10.86242312349813 1.0 8.0 8.0
0.07567681190771636 10.61772676519616 1.0 8.0 8.0
0.07551794241649334 10.408154584225517 1.0 8.0 8.0
0.07544012414514567 10.338183610286322 1.0 8.0 8.0
0.07543901008569609 10.294714764408205 1.0 8.0 8.0
0.07552196103582154 10.220840939166788 1.0 8.0 8.0
0.07561147883837338 10.150286191632622 1.0 8.0 8.0
0.07560718516797238 10.267383220424168 1.0 8.0 8.0
0.07550693028852418 10.22724397921811 1.0 8.0 8.0
0.0753781437854173 10.25331680461303 1.0 8.0 8.0
0.07533981520504451 10.251982546819969 1.0 8.0 8.0
0.07536130257370954 10.237252515360009 1.0 8.0 8.0
0.07536957570684122 10.155556598646989 1.0 8.0 8.0
0.07539508585413057 10.145505742724472 1.0 8.0 8.0
0.07545117201142781 10.128303991342312 1.0 8.0 8.0
0.07546693276906102 10.11542745166066 1.0 8.0 8.0
0.07547424015512405 10.110245792632302 1.0 8.0 8.0
0.07547685871101717 10.108830044336097 1.0 8.0 8.0
0.07548006242068162 10.106318674433135 1.0 8.0 8.0
U dimensions = (906, 38)
Iteration 0 of 1
phi.shape: (200, 906)
U.shape: (906, 38)
phi.dot(U).T shape: (38, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801715.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801715_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801715_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801715_test_data.npy
Cleanup complete.

Simulation 6/10 score: 0.8687341291755069
Running repeat 7/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801764.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_282385_1741801764'
Loaded dataset: downsampled_1000genes_282385_1741801764
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.17544703619871038 5.800286059979608 1.0 8.0 8.0
0.08392827971571959 12.449333437795492 1.0 8.0 8.0
0.08299866887069096 12.195032963222012 1.0 8.0 8.0
0.08264153749384584 12.001599653962304 1.0 8.0 8.0
0.08261141569196018 11.947108573092166 1.0 8.0 8.0
0.08266312208519089 11.864543803929813 1.0 8.0 8.0
0.08266921157988749 11.770752153642755 1.0 8.0 8.0
0.08272692838490203 11.722284158855725 1.0 8.0 8.0
0.08273936406979432 11.689183160003035 1.0 8.0 8.0
0.08278117025486209 11.638612536343134 1.0 8.0 8.0
0.08287226072761444 11.59723249535281 1.0 8.0 8.0
0.08287886798913724 11.558538949660953 1.0 8.0 8.0
0.08282719662214788 11.542641104630116 1.0 8.0 8.0
0.08278284144901193 11.544619856777384 1.0 8.0 8.0
0.08282698847759529 11.529561208561534 1.0 8.0 8.0
0.08283889523049603 11.52365204448526 1.0 8.0 8.0
0.08285082127780863 11.520387307311955 1.0 8.0 8.0
0.08287789502512855 11.5161455835279 1.0 8.0 8.0
0.08289756729358488 11.512715482676787 1.0 8.0 8.0
0.08290296957511634 11.511118256772983 1.0 8.0 8.0
U dimensions = (906, 35)
Iteration 0 of 1
phi.shape: (200, 906)
U.shape: (906, 35)
phi.dot(U).T shape: (35, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801764.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801764_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801764_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801764_test_data.npy
Cleanup complete.

Simulation 7/10 score: 0.8719498587403617
Running repeat 8/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801819.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_282385_1741801819'
Loaded dataset: downsampled_1000genes_282385_1741801819
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.1733746883970101 6.3519032028067235 1.0 8.0 8.0
0.08307175050967819 13.104335501090222 1.0 8.0 8.0
0.08186698667708592 12.011078578722367 1.0 8.0 8.0
0.08154251018614489 11.563920814932185 1.0 8.0 8.0
0.08143706807501228 11.494178869388282 1.0 8.0 8.0
0.08138707901137376 11.313406275072724 1.0 8.0 8.0
0.08136147475382827 11.319725525685287 1.0 8.0 8.0
0.08131170082010375 11.333041677846738 1.0 8.0 8.0
0.08132995525744835 11.236056984438141 1.0 8.0 8.0
0.08133952220564866 11.207103613090815 1.0 8.0 8.0
0.0813600641701746 11.168485909483936 1.0 8.0 8.0
0.08137891172368428 11.144769882335988 1.0 8.0 8.0
0.08138104428572757 11.142365055290096 1.0 8.0 8.0
0.08138553487979727 11.13594427115486 1.0 8.0 8.0
0.08137876755946016 11.129085135758737 1.0 8.0 8.0
0.08137954985807017 11.12563985428247 1.0 8.0 8.0
0.08136235748225584 11.132278919131158 1.0 8.0 8.0
0.08133762701452107 11.147077980746088 1.0 8.0 8.0
0.08132319617518802 11.157652463287054 1.0 8.0 8.0
0.0813235240067115 11.159415361061399 1.0 8.0 8.0
U dimensions = (906, 38)
Iteration 0 of 1
phi.shape: (200, 906)
U.shape: (906, 38)
phi.dot(U).T shape: (38, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801819.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801819_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801819_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801819_test_data.npy
Cleanup complete.

Simulation 8/10 score: 0.8635699669582865
Running repeat 9/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801872.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_282385_1741801872'
Loaded dataset: downsampled_1000genes_282385_1741801872
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.16079817152381937 5.148927512106938 1.0 8.0 8.0
0.08585790010832661 11.137167762613482 1.0 8.0 8.0
0.08425801257361076 10.974643139463765 1.0 8.0 8.0
0.0835585031969559 10.811995722376711 1.0 8.0 8.0
0.08336610109653009 10.773334449186727 1.0 8.0 8.0
0.08318442735995923 10.833617914055992 1.0 8.0 8.0
0.08315221622078595 10.858419280753182 1.0 8.0 8.0
0.08302164179301152 10.849110276461095 1.0 8.0 8.0
0.08281648387512475 10.860384367118934 1.0 8.0 8.0
0.08253791471910599 10.78103771816031 1.0 8.0 8.0
0.08235546309025388 10.73085398455691 1.0 8.0 8.0
0.08228306273218289 10.72523844054577 1.0 8.0 8.0
0.08211380244887867 10.738910485764904 1.0 8.0 8.0
0.082025679732324 10.771395436484108 1.0 8.0 8.0
0.0818508264969422 10.792760763195233 1.0 8.0 8.0
0.08172678314482396 10.823451757192693 1.0 8.0 8.0
0.08167628104116997 10.77365097604611 1.0 8.0 8.0
0.08164172225149191 10.762435333423015 1.0 8.0 8.0
0.08160857765474172 10.780656936541819 1.0 8.0 8.0
0.08158294682859979 10.792346552937078 1.0 8.0 8.0
U dimensions = (906, 38)
Iteration 0 of 1
phi.shape: (200, 906)
U.shape: (906, 38)
phi.dot(U).T shape: (38, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801872.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801872_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801872_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801872_test_data.npy
Cleanup complete.

Simulation 9/10 score: 0.8778829411876795
Running repeat 10/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801924.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_282385_1741801924'
Loaded dataset: downsampled_1000genes_282385_1741801924
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.16767965135048568 5.81124196360731 1.0 8.0 8.0
0.08476506599003397 12.057589158546238 1.0 8.0 8.0
0.08278235279462087 11.892079097714166 1.0 8.0 8.0
0.08176034984965685 11.608451287740438 1.0 8.0 8.0
0.0812992265396475 11.589773639950193 1.0 8.0 8.0
0.08116592103660192 11.55983818052548 1.0 8.0 8.0
0.0811319652200333 11.499819774534618 1.0 8.0 8.0
0.08108534298861292 11.468059079268588 1.0 8.0 8.0
0.08108117604286735 11.44272975100024 1.0 8.0 8.0
0.08103558961638146 11.406122342561453 1.0 8.0 8.0
0.08103796074787406 11.37150179931247 1.0 8.0 8.0
0.08099311663650655 11.450708679283046 1.0 8.0 8.0
0.08098766659161794 11.419117855974747 1.0 8.0 8.0
0.08095492145503047 11.418285247560071 1.0 8.0 8.0
0.08095590764669247 11.385114849369463 1.0 8.0 8.0
0.0809365779047806 11.409838108607342 1.0 8.0 8.0
0.08093764492096955 11.419069591334228 1.0 8.0 8.0
0.08096675003494402 11.464570902136103 1.0 8.0 8.0
0.08097628426135339 11.465716485070283 1.0 8.0 8.0
0.08097134167727293 11.46306311710384 1.0 8.0 8.0
U dimensions = (906, 36)
Iteration 0 of 1
phi.shape: (200, 906)
U.shape: (906, 36)
phi.dot(U).T shape: (36, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801924.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801924_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801924_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_282385_1741801924_test_data.npy
Cleanup complete.

Simulation 10/10 score: 0.8521309930120144
Results saved: results/simulation/results_optimal.csv
Running simulation with: num_measurements=350, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=500
Running repeat 1/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801631.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_139849_1741801631'
Loaded dataset: downsampled_500genes_139849_1741801631
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.19673590257565599 2.9080378253676664 nan 8.0 8.0
0.06981749744042243 11.821662368469578 nan 8.0 8.0
0.06613574963645552 11.738082070680512 nan 8.0 8.0
0.06473157726207945 11.699904268717528 nan 8.0 8.0
0.06351885126503953 11.730425379512983 nan 8.0 8.0
0.06284107203101141 11.772489771920407 nan 8.0 8.0
0.06245251823081377 11.771729561076999 nan 8.0 8.0
0.062303166949184585 11.73596084794421 nan 8.0 8.0
0.062210366516728954 11.718334822200173 nan 8.0 8.0
0.06212359994779304 11.69227896311095 nan 8.0 8.0
0.062046985164559865 11.68675889125934 nan 8.0 8.0
0.06200762127963455 11.720525794356675 nan 8.0 8.0
0.06196826576152814 11.719422799875034 nan 8.0 8.0
0.06188370511122976 11.706600650399576 nan 8.0 8.0
0.06177474076408318 11.715495033601094 nan 8.0 8.0
0.06168430239948697 11.694754862263423 nan 8.0 8.0
0.06154185876542517 11.697368357737105 nan 8.0 8.0
0.06148328544265602 11.698756087843611 nan 8.0 8.0
0.06143992177763091 11.698364720876024 nan 8.0 8.0
0.06140803341960388 11.696345647928451 nan 8.0 8.0
U dimensions = (477, 34)
Iteration 0 of 1
phi.shape: (350, 477)
U.shape: (477, 34)
phi.dot(U).T shape: (34, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801631.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801631_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801631_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801631_test_data.npy
Cleanup complete.

Simulation 1/10 score: 0.9571985021270981
Running repeat 2/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801666.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_139849_1741801666'
Loaded dataset: downsampled_500genes_139849_1741801666
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.18196032736222245 3.011529442777414 nan 8.0 8.0
0.0696765211683481 11.185686402194536 nan 8.0 8.0
0.0670607283814898 11.06487380605014 nan 8.0 8.0
0.06521594930266883 11.236009709465316 nan 8.0 8.0
0.0641571064469122 11.388084978043537 nan 8.0 8.0
0.06306265615696516 11.619352655252136 nan 8.0 8.0
0.06234899125370774 11.666175308499227 nan 8.0 8.0
0.06197037787696558 11.709873012371693 nan 8.0 8.0
0.0617636627076007 11.614732408127121 nan 8.0 8.0
0.06166302829032644 11.64472012949207 nan 8.0 8.0
0.0615933106082267 11.635330981599067 nan 8.0 8.0
0.06150997053478424 11.641981093261226 nan 8.0 8.0
0.06143175800175982 11.642917687465994 nan 8.0 8.0
0.06137608563011332 11.634915895342324 nan 8.0 8.0
0.061317902764973176 11.640927846289431 nan 8.0 8.0
0.06127719222419614 11.582522792941784 nan 8.0 8.0
0.06122557150572294 11.613410077887064 nan 8.0 8.0
0.06113131753224743 11.413296895343672 nan 8.0 8.0
0.06107321834338253 11.223174542952789 nan 8.0 8.0
0.06106622956623575 11.16114298196486 nan 8.0 8.0
U dimensions = (477, 30)
Iteration 0 of 1
phi.shape: (350, 477)
U.shape: (477, 30)
phi.dot(U).T shape: (30, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801666.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801666_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801666_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801666_test_data.npy
Cleanup complete.

Simulation 2/10 score: 0.9670362698560433
Running repeat 3/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801702.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_139849_1741801702'
Loaded dataset: downsampled_500genes_139849_1741801702
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.21048244117416326 2.8253701368319493 nan 8.0 8.0
0.07311295007367713 10.860977503801784 nan 8.0 8.0
0.0704733562161215 10.662076029654092 nan 8.0 8.0
0.06916261111897659 10.682044304692594 nan 8.0 8.0
0.06819540941411062 10.87934881701938 nan 8.0 8.0
0.06720574937181367 10.860103881836867 nan 8.0 8.0
0.06639170340125544 10.834350463897426 nan 8.0 8.0
0.06589641730044715 10.808774218381403 nan 8.0 8.0
0.06572434348427447 10.800695554713268 nan 8.0 8.0
0.0656334793965786 10.804616950006354 nan 8.0 8.0
0.06560843735234645 10.797134990877288 nan 8.0 8.0
0.06555308935456305 10.777061659411622 nan 8.0 8.0
0.06546240889208543 10.762306305771588 nan 8.0 8.0
0.06541315665230918 10.732684731033574 nan 8.0 8.0
0.06539741569257063 10.718884693267057 nan 8.0 8.0
0.06538252231303898 10.692345896315574 nan 8.0 8.0
0.06537558409214106 10.672390228007158 nan 8.0 8.0
0.06535669344606332 10.652955013661188 nan 8.0 8.0
0.06534878772084651 10.629706021426493 nan 8.0 8.0
0.06533125147102448 10.603783028725907 nan 8.0 8.0
U dimensions = (477, 31)
Iteration 0 of 1
phi.shape: (350, 477)
U.shape: (477, 31)
phi.dot(U).T shape: (31, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801702.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801702_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801702_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801702_test_data.npy
Cleanup complete.

Simulation 3/10 score: 0.9587528911840124
Running repeat 4/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801745.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_139849_1741801745'
Loaded dataset: downsampled_500genes_139849_1741801745
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.18309722341208112 2.7837347199250173 nan 8.0 8.0
0.07165013331592052 11.100667906905754 nan 8.0 8.0
0.06705065930844856 11.108124849746126 nan 8.0 8.0
0.06498936256743926 11.413581494561118 nan 8.0 8.0
0.06366687410893901 11.59549836161162 nan 8.0 8.0
0.06294486688457601 11.953667935212803 nan 8.0 8.0
0.06265345347191831 12.076066668334619 nan 8.0 8.0
0.06244793574746821 12.081506440864977 nan 8.0 8.0
0.06223872814531617 12.090488838697443 nan 8.0 8.0
0.06210432095726304 12.135151273919742 nan 8.0 8.0
0.061984623845818154 12.154546049324228 nan 8.0 8.0
0.06188223082845701 12.161403431753346 nan 8.0 8.0
0.06175842213799221 12.180493493253886 nan 8.0 8.0
0.06163264238162858 12.18352531458939 nan 8.0 8.0
0.06151684620581688 12.211512941480603 nan 8.0 8.0
0.06143044933580799 12.189298359022056 nan 8.0 8.0
0.06132774545138853 12.199946485588507 nan 8.0 8.0
0.06128308396485571 12.196684221828091 nan 8.0 8.0
0.061243259005856254 12.197719304915436 nan 8.0 8.0
0.06118861528537989 12.204010346219876 nan 8.0 8.0
U dimensions = (477, 33)
Iteration 0 of 1
phi.shape: (350, 477)
U.shape: (477, 33)
phi.dot(U).T shape: (33, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801745.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801745_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801745_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801745_test_data.npy
Cleanup complete.

Simulation 4/10 score: 0.9546845329400886
Running repeat 5/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801795.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_139849_1741801795'
Loaded dataset: downsampled_500genes_139849_1741801795
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.19438874465399658 2.8449217488295426 nan 8.0 8.0
0.06908227257208166 10.967118742792948 nan 8.0 8.0
0.06580856995957718 10.831255529558447 nan 8.0 8.0
0.06425973238537142 10.956306444318992 nan 8.0 8.0
0.06355667796421716 10.867975820027798 nan 8.0 8.0
0.06322700995164454 10.886032461852453 nan 8.0 8.0
0.06295502971103462 10.921406411104991 nan 8.0 8.0
0.06274045805604067 10.9465173205669 nan 8.0 8.0
0.06258134795699166 10.95542020010328 nan 8.0 8.0
0.06242521776800014 10.965831444333036 nan 8.0 8.0
0.06222674612735657 10.974658122821316 nan 8.0 8.0
0.06210574194206808 11.07020832161111 nan 8.0 8.0
0.06198403272084829 11.083978469071884 nan 8.0 8.0
0.0618743119783467 11.070984590149314 nan 8.0 8.0
0.061796673128513335 11.057486987226458 nan 8.0 8.0
0.06171736236095582 11.057984156354193 nan 8.0 8.0
0.061674795421490125 11.054588882550027 nan 8.0 8.0
0.061661002194182024 11.05650063949045 nan 8.0 8.0
0.06165841673724082 11.039392493499244 nan 8.0 8.0
0.061653568619008614 11.021707116252546 nan 8.0 8.0
U dimensions = (477, 35)
Iteration 0 of 1
phi.shape: (350, 477)
U.shape: (477, 35)
phi.dot(U).T shape: (35, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801795.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801795_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801795_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801795_test_data.npy
Cleanup complete.

Simulation 5/10 score: 0.9628969256647834
Running repeat 6/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801841.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_139849_1741801841'
Loaded dataset: downsampled_500genes_139849_1741801841
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.1942293397935878 2.745670080324601 nan 8.0 8.0
0.07404440965044501 10.417816095037182 nan 8.0 8.0
0.06901829445018648 10.50676253824222 nan 8.0 8.0
0.06716022146696665 10.457618234030667 nan 8.0 8.0
0.06642725735604249 10.777817220211542 nan 8.0 8.0
0.06589841857075562 10.995313292603454 nan 8.0 8.0
0.06551604808831613 11.08433498157919 nan 8.0 8.0
0.06518875764361998 11.258268330633118 nan 8.0 8.0
0.06482575264564283 11.407627801213527 nan 8.0 8.0
0.06468776523303144 11.343728103293504 nan 8.0 8.0
0.06457256556752289 11.22407740292727 nan 8.0 8.0
0.06445497982999182 11.136525489413623 nan 8.0 8.0
0.06437399108679831 11.042739804497886 nan 8.0 8.0
0.06425981650412205 10.941364191219055 nan 8.0 8.0
0.06415779171240021 10.903337474457015 nan 8.0 8.0
0.06408019210431104 10.87370056698008 nan 8.0 8.0
0.06403474483692329 10.863200562981358 nan 8.0 8.0
0.0639476242582282 10.790141723406686 nan 8.0 8.0
0.06392455698988853 10.723074868911478 nan 8.0 8.0
0.06388379714209558 10.70062870133562 nan 8.0 8.0
U dimensions = (477, 30)
Iteration 0 of 1
phi.shape: (350, 477)
U.shape: (477, 30)
phi.dot(U).T shape: (30, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801841.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801841_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801841_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801841_test_data.npy
Cleanup complete.

Simulation 6/10 score: 0.9294018046336584
Running repeat 7/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801878.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_139849_1741801878'
Loaded dataset: downsampled_500genes_139849_1741801878
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.19028681674301295 3.137547934877523 nan 8.0 8.0
0.07058879336733126 11.862240959246897 nan 8.0 8.0
0.0677406298282307 11.229854161917336 nan 8.0 8.0
0.06615381793753006 11.262987058428092 nan 8.0 8.0
0.06530374296335684 11.312343792917218 nan 8.0 8.0
0.06463555651670216 11.347282001883828 nan 8.0 8.0
0.0640592373276303 11.453304923842532 nan 8.0 8.0
0.06364255336216218 11.489195922698958 nan 8.0 8.0
0.0632514668848565 11.511867831321187 nan 8.0 8.0
0.06310783862513103 11.521124450016298 nan 8.0 8.0
0.06293615769515337 11.509061521740382 nan 8.0 8.0
0.06275950144645348 11.509290084020439 nan 8.0 8.0
0.0625911749165734 11.495945953352363 nan 8.0 8.0
0.0624172025418579 11.481632562393367 nan 8.0 8.0
0.06227512667082413 11.474334594837163 nan 8.0 8.0
0.06214694880373062 11.482825176625116 nan 8.0 8.0
0.06207103945344916 11.483725990033598 nan 8.0 8.0
0.06202310836137992 11.487122411987956 nan 8.0 8.0
0.061955233407057886 11.492133850770275 nan 8.0 8.0
0.061747544180416836 11.485805943193755 nan 8.0 8.0
U dimensions = (477, 33)
Iteration 0 of 1
phi.shape: (350, 477)
U.shape: (477, 33)
phi.dot(U).T shape: (33, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801878.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801878_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801878_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801878_test_data.npy
Cleanup complete.

Simulation 7/10 score: 0.9657254605313379
Running repeat 8/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801927.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_139849_1741801927'
Loaded dataset: downsampled_500genes_139849_1741801927
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.2011806639798872 2.980359126555914 nan 8.0 8.0
0.07326521407275155 10.66148325994268 nan 8.0 8.0
0.0700140359763568 10.538568054234387 nan 8.0 8.0
0.06909354132803491 10.609438149523113 nan 8.0 8.0
0.06841794160608705 10.706202037967284 nan 8.0 8.0
0.06753611548006944 10.834292563496797 nan 8.0 8.0
0.06692427551100255 10.947185831869078 nan 8.0 8.0
0.06630808031963431 10.9894752680598 nan 8.0 8.0
0.06529246903514496 11.060789804796123 nan 8.0 8.0
0.0647872104207311 11.053011215240485 nan 8.0 8.0
0.06445393811885136 11.040863741340953 nan 8.0 8.0
0.06417330452626036 11.037231227040314 nan 8.0 8.0
0.06392032733112596 11.03546012990634 nan 8.0 8.0
0.0636177167815134 11.028368789187702 nan 8.0 8.0
0.06344186931651552 11.018433346163924 nan 8.0 8.0
0.0632917211175773 11.020404247132658 nan 8.0 8.0
0.06321729693091449 11.032003069413127 nan 8.0 8.0
0.0631950393176971 11.035717635954477 nan 8.0 8.0
0.06318722472226379 11.035573896327536 nan 8.0 8.0
0.06317193811134547 11.03213645081037 nan 8.0 8.0
U dimensions = (477, 33)
Iteration 0 of 1
phi.shape: (350, 477)
U.shape: (477, 33)
phi.dot(U).T shape: (33, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801927.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801927_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801927_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801927_test_data.npy
Cleanup complete.

Simulation 8/10 score: 0.9718024742925772
Running repeat 9/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801978.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_139849_1741801978'
Loaded dataset: downsampled_500genes_139849_1741801978
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.19387831996699234 2.6641804371453195 nan 8.0 8.0
0.07061279101578011 10.09904428647192 nan 8.0 8.0
0.06727104846974519 10.329624312590195 nan 8.0 8.0
0.06557572576899484 10.421034227670564 nan 8.0 8.0
0.06437011724499342 10.541706346362416 nan 8.0 8.0
0.06368879340633538 10.632845964384186 nan 8.0 8.0
0.06330792637119775 10.700081401075174 nan 8.0 8.0
0.0629214621777322 10.685548918528966 nan 8.0 8.0
0.06272782732353588 10.635860922918825 nan 8.0 8.0
0.06259643458411757 10.684102278921191 nan 8.0 8.0
0.06243094120880077 10.709064396816267 nan 8.0 8.0
0.062315659586948735 10.616504473576828 nan 8.0 8.0
0.06223341805220117 10.613244292125207 nan 8.0 8.0
0.06217986739139658 10.605317882685473 nan 8.0 8.0
0.06214550707091471 10.583594957479775 nan 8.0 8.0
0.062146084590579354 10.55853637631229 nan 8.0 8.0
0.062145074061766614 10.531540769639541 nan 8.0 8.0
0.06213683713816032 10.524622843784785 nan 8.0 8.0
0.062129838610971655 10.521444354674141 nan 8.0 8.0
0.06213242955337739 10.517099903036236 nan 8.0 8.0
U dimensions = (477, 32)
Iteration 0 of 1
phi.shape: (350, 477)
U.shape: (477, 32)
phi.dot(U).T shape: (32, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801978.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801978_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801978_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741801978_test_data.npy
Cleanup complete.

Simulation 9/10 score: 0.9698970606407229
Running repeat 10/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741802035.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_139849_1741802035'
Loaded dataset: downsampled_500genes_139849_1741802035
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.2054904519211529 3.0888740067234455 nan 8.0 8.0
0.06765550280196808 11.654578561321395 nan 8.0 8.0
0.0654753161821583 11.415860186995834 nan 8.0 8.0
0.06399261796953248 11.361920072635108 nan 8.0 8.0
0.06287562714748984 11.412679364549465 nan 8.0 8.0
0.062223750672042666 11.479330076501869 nan 8.0 8.0
0.06189353796859898 11.45991062573353 nan 8.0 8.0
0.061637333736356936 11.426279742410632 nan 8.0 8.0
0.061421632287801065 11.428801679021952 nan 8.0 8.0
0.061280274104678734 11.412276482273207 nan 8.0 8.0
0.06119185107446368 11.381914402667865 nan 8.0 8.0
0.06110271801317291 11.372163335902657 nan 8.0 8.0
0.06106920999026555 11.356747592579575 nan 8.0 8.0
0.06105171909291618 11.350847039239332 nan 8.0 8.0
0.061032581832123234 11.36009998626508 nan 8.0 8.0
0.06101370073699597 11.370428639914806 nan 8.0 8.0
0.06100710222109895 11.364711255524274 nan 8.0 8.0
0.06099408258643879 11.366531403850331 nan 8.0 8.0
0.060989911706771927 11.363956332706213 nan 8.0 8.0
0.060984808829980475 11.358603899287349 nan 8.0 8.0
U dimensions = (477, 32)
Iteration 0 of 1
phi.shape: (350, 477)
U.shape: (477, 32)
phi.dot(U).T shape: (32, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741802035.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741802035_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741802035_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_139849_1741802035_test_data.npy
Cleanup complete.

Simulation 10/10 score: 0.9408167026559927
Results saved: results/simulation/results_optimal.csv
Running simulation with: num_measurements=500, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=500
Running repeat 1/10...
Matched genes for 500 set: 477
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_283028_1741802128.h5ad
Train data shape: (5000, 477)
Validation data shape: (2500, 477)
Test data shape: (2500, 477)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_500genes_283028_1741802128'
Loaded dataset: downsampled_500genes_283028_1741802128
Train data shape: (477, 5000)
Validation data shape: (477, 2500)
Test data shape: (477, 2500)
0.19283831926603312 3.140917791510111 nan 8.0 8.0
0.06898212483571442 11.073935477049144 nan 8.0 8.0
0.06663340082908542 11.026592460790829 nan 8.0 8.0
0.06450175040303907 11.027024657446534 nan 8.0 8.0
0.06304613321758767 11.063675267428007 nan 8.0 8.0
0.062487638731035466 11.059563910423238 nan 8.0 8.0
0.06216443017584994 10.985300562227263 nan 8.0 8.0
0.06180517626097526 10.976550119103099 nan 8.0 8.0
0.06158546016217503 10.975081523141547 nan 8.0 8.0
0.0614025011391347 10.961533486279086 nan 8.0 8.0
0.06116577071606355 10.941794145569482 nan 8.0 8.0
0.060957843674461 10.915682445347166 nan 8.0 8.0
0.06086379037026901 10.902152208150454 nan 8.0 8.0
0.06083080794885265 10.895976402879764 nan 8.0 8.0
0.060800814283486826 10.906537154367438 nan 8.0 8.0
0.060783944808462165 10.906676558251762 nan 8.0 8.0
0.06077530503697237 10.904911434192053 nan 8.0 8.0
0.06076746941437172 10.904356702474514 nan 8.0 8.0
0.06076850938146683 10.901447181330704 nan 8.0 8.0
0.06076728396145448 10.900155181509737 nan 8.0 8.0
U dimensions = (477, 34)
Iteration 0 of 1
phi.shape: (500, 477)
U.shape: (477, 34)
phi.dot(U).T shape: (34, 500)
Skipping iteration: Distance matrix is empty or contains NaN values.

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_283028_1741802128.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_283028_1741802128_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_283028_1741802128_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_500genes_283028_1741802128_test_data.npy
Cleanup complete.

Running simulation with: num_measurements=350, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=5000
Running repeat 1/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741801814.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_139933_1741801814'
Loaded dataset: downsampled_5000genes_139933_1741801814
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3542470520082397 10.74695575219415 1.0 8.0 8.0
0.2910228378664621 19.576132953439767 1.0 8.0 8.0
0.2971129752127891 17.77644022301657 1.0 8.0 8.0
0.29813671620541504 17.569660347623916 1.0 8.0 8.0
0.298289282309653 17.270833153432257 1.0 8.0 8.0
0.29860768389133885 17.180884488769323 1.0 8.0 8.0
0.2987691679811194 17.12892167476074 1.0 8.0 8.0
0.2987876587607641 16.99106544450829 1.0 8.0 8.0
0.2988793210246562 16.97624491307555 1.0 8.0 8.0
0.2986941842316042 17.125822931761242 1.0 8.0 8.0
0.29856150295874384 17.284792703427257 1.0 8.0 8.0
0.2984788043303964 17.392497217805673 1.0 8.0 8.0
0.29843613202114205 17.43793538541179 1.0 8.0 8.0
0.2984141945716343 17.347651838423275 1.0 8.0 8.0
0.2984100989484961 17.194272477788413 1.0 8.0 8.0
0.29840577576053406 17.254556189574547 1.0 8.0 8.0
0.2983968820791698 17.089853359565936 1.0 8.0 8.0
0.2983878414677803 17.007495943856497 1.0 8.0 8.0
0.29838203678488917 17.02062183810299 1.0 8.0 8.0
0.29837917514786394 17.121563644882357 1.0 8.0 8.0
U dimensions = (4971, 34)
Iteration 0 of 1
phi.shape: (350, 4971)
U.shape: (4971, 34)
phi.dot(U).T shape: (34, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741801814.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741801814_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741801814_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741801814_test_data.npy
Cleanup complete.

Simulation 1/10 score: 0.7720267762343886
Running repeat 2/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741801880.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_139933_1741801880'
Loaded dataset: downsampled_5000genes_139933_1741801880
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3344708969108007 9.410011347546568 1.0 8.0 8.0
0.29306523374685467 18.34736963739323 1.0 8.0 8.0
0.29591338130077194 16.612139342700935 1.0 8.0 8.0
0.2959694618960437 16.685801089632992 1.0 8.0 8.0
0.29577306032003414 16.754268544125477 1.0 8.0 8.0
0.2957240850629633 16.679554442491607 1.0 8.0 8.0
0.29557184724938834 16.732121160348385 1.0 8.0 8.0
0.29552407093589583 16.786552018092788 1.0 8.0 8.0
0.2954620778587582 16.893391229078368 1.0 8.0 8.0
0.2954561228304473 16.88076212470085 1.0 8.0 8.0
0.29545394124209046 16.86863581453239 1.0 8.0 8.0
0.2954489766080167 16.853797916464043 1.0 8.0 8.0
0.2954429121096337 16.844195643260946 1.0 8.0 8.0
0.29544181965771665 16.85573939969841 1.0 8.0 8.0
0.2954411032543002 16.854617864217676 1.0 8.0 8.0
0.29543557426548694 16.854543944048732 1.0 8.0 8.0
0.29543169328310126 16.855423741102467 1.0 8.0 8.0
0.2954315832889972 16.85543115039542 1.0 8.0 8.0
0.29543124729742054 16.855782139056977 1.0 8.0 8.0
0.2954306288126971 16.858409134978437 1.0 8.0 8.0
U dimensions = (4971, 37)
Iteration 0 of 1
phi.shape: (350, 4971)
U.shape: (4971, 37)
phi.dot(U).T shape: (37, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741801880.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741801880_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741801880_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741801880_test_data.npy
Cleanup complete.

Simulation 2/10 score: 0.777098711734096
Running repeat 3/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741801945.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_139933_1741801945'
Loaded dataset: downsampled_5000genes_139933_1741801945
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3509715259377887 11.622559182119671 1.0 8.0 8.0
0.28884257586300266 19.086120309818575 1.0 8.0 8.0
0.29474684723851596 16.545512373506607 1.0 8.0 8.0
0.2972319491226413 15.766914508430542 1.0 8.0 8.0
0.29819996257389836 15.746944221935951 1.0 8.0 8.0
0.2990763866496844 15.807874562871183 1.0 8.0 8.0
0.2995436939389696 15.97251246183616 1.0 8.0 8.0
0.29974256534222266 15.980917001591232 1.0 8.0 8.0
0.29984344257280837 15.980555361804889 1.0 8.0 8.0
0.29984889134572934 15.996685323411851 1.0 8.0 8.0
0.2999035308236745 15.986591837277771 1.0 8.0 8.0
0.30005446019611615 15.973596782035026 1.0 8.0 8.0
0.3002404416126453 15.949567151037371 1.0 8.0 8.0
0.3004772134454071 15.847471599194806 1.0 8.0 8.0
0.30048902222519946 15.838381970562539 1.0 8.0 8.0
0.30048936871908705 15.836869202319784 1.0 8.0 8.0
0.30048930000423413 15.837327819726582 1.0 8.0 8.0
0.30048912805944894 15.83793439814317 1.0 8.0 8.0
0.30048908099256944 15.838427308655936 1.0 8.0 8.0
0.3004891028107439 15.83875765000298 1.0 8.0 8.0
U dimensions = (4971, 35)
Iteration 0 of 1
phi.shape: (350, 4971)
U.shape: (4971, 35)
phi.dot(U).T shape: (35, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741801945.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741801945_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741801945_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741801945_test_data.npy
Cleanup complete.

Simulation 3/10 score: 0.7773063268250585
Running repeat 4/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802013.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_139933_1741802013'
Loaded dataset: downsampled_5000genes_139933_1741802013
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3282957091529798 11.145384746946224 1.0 8.0 8.0
0.2811508206460456 17.390946143706024 1.0 8.0 8.0
0.2874282681288399 16.10532082500461 1.0 8.0 8.0
0.2893955855415423 15.816598613818346 1.0 8.0 8.0
0.29030028396996854 15.881050723141705 1.0 8.0 8.0
0.2903538010986789 16.006002162602737 1.0 8.0 8.0
0.2904527725965175 15.992405487006662 1.0 8.0 8.0
0.290592067572485 15.994529630547234 1.0 8.0 8.0
0.2906844202136426 15.95930633441871 1.0 8.0 8.0
0.29064468189045534 15.911156238258156 1.0 8.0 8.0
0.2906341879429911 15.35879467923961 1.0 8.0 8.0
0.29068098214999416 15.298885989020992 1.0 8.0 8.0
0.2906820926785545 15.28850019769888 1.0 8.0 8.0
0.29068881365704713 15.284678496136479 1.0 8.0 8.0
0.2906891251275787 15.284594925616355 1.0 8.0 8.0
0.2906891299325597 15.284591446886566 1.0 8.0 8.0
0.29068913080254655 15.28459139713424 1.0 8.0 8.0
0.2906891308285743 15.284591387058072 1.0 8.0 8.0
0.2906891308323519 15.284591385815101 1.0 8.0 8.0
0.2906891308325037 15.284591385517826 1.0 8.0 8.0
U dimensions = (4971, 35)
Iteration 0 of 1
phi.shape: (350, 4971)
U.shape: (4971, 35)
phi.dot(U).T shape: (35, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802013.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802013_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802013_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802013_test_data.npy
Cleanup complete.

Simulation 4/10 score: 0.7792439803257872
Running repeat 5/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802080.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_139933_1741802080'
Loaded dataset: downsampled_5000genes_139933_1741802080
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3433257625541595 11.035774965456632 1.0 8.0 8.0
0.28779465889255684 19.579659550865657 1.0 8.0 8.0
0.2921297780243487 17.62260673925956 1.0 8.0 8.0
0.2934365494387393 17.203134357045165 1.0 8.0 8.0
0.2945094447759279 17.202073907968384 1.0 8.0 8.0
0.29507691272485526 17.10177857854354 1.0 8.0 8.0
0.29527779438831936 17.113551561126908 1.0 8.0 8.0
0.29560321924497746 17.17624995854316 1.0 8.0 8.0
0.29565507146086767 17.26430719787676 1.0 8.0 8.0
0.2957938513100711 17.32139401318175 1.0 8.0 8.0
0.2961958754865347 17.385072024412942 1.0 8.0 8.0
0.2965017359607136 17.654516879777972 1.0 8.0 8.0
0.2966714568093026 17.641171067190633 1.0 8.0 8.0
0.29675417079748734 17.599472668371078 1.0 8.0 8.0
0.2966797658160625 17.624625064422403 1.0 8.0 8.0
0.2966416819674238 17.61826334519473 1.0 8.0 8.0
0.29660242989750596 17.624710598030813 1.0 8.0 8.0
0.29653819366066025 17.413753519919627 1.0 8.0 8.0
0.2965489084948122 17.382247196739495 1.0 8.0 8.0
0.2965144599380245 17.364994147538045 1.0 8.0 8.0
U dimensions = (4971, 36)
Iteration 0 of 1
phi.shape: (350, 4971)
U.shape: (4971, 36)
phi.dot(U).T shape: (36, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802080.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802080_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802080_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802080_test_data.npy
Cleanup complete.

Simulation 5/10 score: 0.7760259661656622
Running repeat 6/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802144.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_139933_1741802144'
Loaded dataset: downsampled_5000genes_139933_1741802144
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3375307793242487 12.416057270596397 1.0 8.0 8.0
0.2860815746457427 18.34693287928612 1.0 8.0 8.0
0.2886650997449661 17.321269140780668 1.0 8.0 8.0
0.2947498352047968 16.93955158903668 1.0 8.0 8.0
0.2996166454564624 16.551364921087032 1.0 8.0 8.0
0.3004622966835282 16.390181966663633 1.0 8.0 8.0
0.3004590377062746 16.04243800239154 1.0 8.0 8.0
0.30017313811231794 15.934557266105825 1.0 8.0 8.0
0.3000904836992172 16.029083747815758 1.0 8.0 8.0
0.3001143449217003 16.043107738188443 1.0 8.0 8.0
0.30010171825309817 16.041803842158455 1.0 8.0 8.0
0.3000967041951338 16.043016119996466 1.0 8.0 8.0
0.300092485835454 16.045107488868027 1.0 8.0 8.0
0.30008958351385684 16.042354253976576 1.0 8.0 8.0
0.3000839796607683 16.041015907713962 1.0 8.0 8.0
0.3000811556663445 16.044433549071638 1.0 8.0 8.0
0.3000796876595784 16.036299473650057 1.0 8.0 8.0
0.3000787122079278 16.02729417497066 1.0 8.0 8.0
0.3000782867368581 16.027875051575585 1.0 8.0 8.0
0.30007805373773566 16.029899330680156 1.0 8.0 8.0
U dimensions = (4971, 35)
Iteration 0 of 1
phi.shape: (350, 4971)
U.shape: (4971, 35)
phi.dot(U).T shape: (35, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802144.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802144_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802144_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802144_test_data.npy
Cleanup complete.

Simulation 6/10 score: 0.7808200615226113
Running repeat 7/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802212.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_139933_1741802212'
Loaded dataset: downsampled_5000genes_139933_1741802212
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3563562284630407 9.92358786115726 1.0 8.0 8.0
0.2917383239623159 19.812261516189587 1.0 8.0 8.0
0.29805460302939313 17.655879002723715 1.0 8.0 8.0
0.29807317206874007 16.992565564668727 1.0 8.0 8.0
0.2980955794428176 16.917230005301246 1.0 8.0 8.0
0.29807071831806287 16.861960948917954 1.0 8.0 8.0
0.2980587012651569 16.84476161872261 1.0 8.0 8.0
0.29795601344333633 16.83347747298892 1.0 8.0 8.0
0.2979469554381573 16.81947337516656 1.0 8.0 8.0
0.297940917383855 16.840233537956703 1.0 8.0 8.0
0.2979344998700404 16.830068757991693 1.0 8.0 8.0
0.29792730837357584 16.81377156788275 1.0 8.0 8.0
0.2979260003194074 16.80671059605097 1.0 8.0 8.0
0.29792496097077104 16.819345886754594 1.0 8.0 8.0
0.29792344533210013 16.82051838907308 1.0 8.0 8.0
0.2979232167240682 16.820625368869287 1.0 8.0 8.0
0.2979227358727372 16.820929863418524 1.0 8.0 8.0
0.2979223535034219 16.816522931164787 1.0 8.0 8.0
0.2979220625070922 16.818316372439586 1.0 8.0 8.0
0.2979218105110527 16.823695012516247 1.0 8.0 8.0
U dimensions = (4971, 37)
Iteration 0 of 1
phi.shape: (350, 4971)
U.shape: (4971, 37)
phi.dot(U).T shape: (37, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802212.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802212_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802212_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802212_test_data.npy
Cleanup complete.

Simulation 7/10 score: 0.7737852333317582
Running repeat 8/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802282.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_139933_1741802282'
Loaded dataset: downsampled_5000genes_139933_1741802282
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.38314812793251796 12.477880859915041 1.0 8.0 8.0
0.27464905477879764 22.357153956432672 1.0 8.0 8.0
0.2882564274725744 17.363602838566695 1.0 8.0 8.0
0.2919926823190985 17.1180865675636 1.0 8.0 8.0
0.29316876961363525 16.871640582724456 1.0 8.0 8.0
0.2938012592766097 16.79774207747809 1.0 8.0 8.0
0.2939968790845735 16.782054167851324 1.0 8.0 8.0
0.29400227867293593 16.820211530873536 1.0 8.0 8.0
0.2940670066931893 16.833832970668425 1.0 8.0 8.0
0.29409428920370484 16.84291763460227 1.0 8.0 8.0
0.2941533692395649 16.829452314315507 1.0 8.0 8.0
0.2941482829344493 16.833681967917606 1.0 8.0 8.0
0.2941457291007261 16.821571781134217 1.0 8.0 8.0
0.29414501202088883 16.81704746874044 1.0 8.0 8.0
0.29414472902601796 16.814257916378242 1.0 8.0 8.0
0.29414463338817465 16.811313047457553 1.0 8.0 8.0
0.29414473952484343 16.809350981936827 1.0 8.0 8.0
0.29414473204791913 16.80900715583092 1.0 8.0 8.0
0.2941447722985219 16.808790769280243 1.0 8.0 8.0
0.2941446937989113 16.80735094391986 1.0 8.0 8.0
U dimensions = (4971, 37)
Iteration 0 of 1
phi.shape: (350, 4971)
U.shape: (4971, 37)
phi.dot(U).T shape: (37, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802282.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802282_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802282_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802282_test_data.npy
Cleanup complete.

Simulation 8/10 score: 0.7831689083821493
Running repeat 9/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802345.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_139933_1741802345'
Loaded dataset: downsampled_5000genes_139933_1741802345
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3568284955501835 10.530847549027257 1.0 8.0 8.0
0.2889855150204661 19.22511286800157 1.0 8.0 8.0
0.29474062261253064 17.08944054252317 1.0 8.0 8.0
0.2965575415487167 17.826392146765517 1.0 8.0 8.0
0.2973170387229329 17.84322689465842 1.0 8.0 8.0
0.29789633400477866 17.8437128599176 1.0 8.0 8.0
0.29797149940002676 17.87027520040395 1.0 8.0 8.0
0.29814456121491373 17.66521783748247 1.0 8.0 8.0
0.2985276848400834 17.566162507722748 1.0 8.0 8.0
0.298706427247623 17.55406853975883 1.0 8.0 8.0
0.29877688397190294 17.54528294209994 1.0 8.0 8.0
0.2987264603683122 17.596421539754733 1.0 8.0 8.0
0.29874377978357614 17.555144684031177 1.0 8.0 8.0
0.29874524537835223 17.265943242192034 1.0 8.0 8.0
0.29874612968196146 17.265273892176662 1.0 8.0 8.0
0.2987438243921672 17.267263731932964 1.0 8.0 8.0
0.29874132411831356 17.27118899074837 1.0 8.0 8.0
0.29873946037771737 17.2719304008556 1.0 8.0 8.0
0.298738432690001 17.27032448039523 1.0 8.0 8.0
0.29873669243525725 17.258161231552478 1.0 8.0 8.0
U dimensions = (4971, 35)
Iteration 0 of 1
phi.shape: (350, 4971)
U.shape: (4971, 35)
phi.dot(U).T shape: (35, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802345.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802345_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802345_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802345_test_data.npy
Cleanup complete.

Simulation 9/10 score: 0.7757309606224659
Running repeat 10/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802408.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_139933_1741802408'
Loaded dataset: downsampled_5000genes_139933_1741802408
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3786974230571778 11.401813250065919 1.0 8.0 8.0
0.27920794119460335 22.352204190868598 1.0 8.0 8.0
0.2816784555049364 18.95559654391358 1.0 8.0 8.0
0.2851362199316575 17.9601593966737 1.0 8.0 8.0
0.2919582675110922 17.11741081405541 1.0 8.0 8.0
0.29535834553855345 17.240767628473535 1.0 8.0 8.0
0.2958482535323498 17.17519547211603 1.0 8.0 8.0
0.2957968578256185 17.102411807219266 1.0 8.0 8.0
0.29582147487590427 17.001658612919396 1.0 8.0 8.0
0.29586736995997287 16.929548209200984 1.0 8.0 8.0
0.2959979440181091 16.821073460036313 1.0 8.0 8.0
0.29603288843322717 16.823523586090833 1.0 8.0 8.0
0.29605647013410064 16.818140430429338 1.0 8.0 8.0
0.2960676596752191 16.818673609977733 1.0 8.0 8.0
0.2960673208845501 16.818908575840393 1.0 8.0 8.0
0.2960673103075677 16.818917165922855 1.0 8.0 8.0
0.29606730988787844 16.81891842438656 1.0 8.0 8.0
0.29606730988493735 16.81891866283312 1.0 8.0 8.0
0.2960673098791008 16.8189187306876 1.0 8.0 8.0
0.2960673098794998 16.81891874737595 1.0 8.0 8.0
U dimensions = (4971, 34)
Iteration 0 of 1
phi.shape: (350, 4971)
U.shape: (4971, 34)
phi.dot(U).T shape: (34, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802408.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802408_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802408_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_139933_1741802408_test_data.npy
Cleanup complete.

Simulation 10/10 score: 0.7715419842448645
Results saved: results/simulation/results_optimal.csv
Running simulation with: num_measurements=200, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=5000
Running repeat 1/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741801633.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_1805582_1741801633'
Loaded dataset: downsampled_5000genes_1805582_1741801633
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.36497783777445514 13.039150470049897 1.0 8.0 8.0
0.28339861118156073 21.817754804919318 1.0 8.0 8.0
0.29335965588197654 18.269803705533178 1.0 8.0 8.0
0.29613187772626526 17.356217916503333 1.0 8.0 8.0
0.2970361618621674 17.307782752031443 1.0 8.0 8.0
0.297226634332323 17.06938711055861 1.0 8.0 8.0
0.2975463093134052 16.69224050864056 1.0 8.0 8.0
0.2975390312371107 16.612259268184363 1.0 8.0 8.0
0.29751595858066915 16.595668871051892 1.0 8.0 8.0
0.297501139271242 16.610149359709162 1.0 8.0 8.0
0.297502173875304 16.611377763117137 1.0 8.0 8.0
0.2975026622673135 16.609843655448824 1.0 8.0 8.0
0.29750114971941255 16.60842879755355 1.0 8.0 8.0
0.29749991521627905 16.608225599571036 1.0 8.0 8.0
0.2974972415377468 16.609675451638974 1.0 8.0 8.0
0.2974972468346002 16.609670887851912 1.0 8.0 8.0
0.29749724847931314 16.609671836116213 1.0 8.0 8.0
0.2974972483397361 16.60967174846478 1.0 8.0 8.0
0.29749724835589286 16.609671757477674 1.0 8.0 8.0
0.2974972483542847 16.60967175650486 1.0 8.0 8.0
U dimensions = (4971, 31)
Iteration 0 of 1
phi.shape: (200, 4971)
U.shape: (4971, 31)
phi.dot(U).T shape: (31, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741801633.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741801633_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741801633_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741801633_test_data.npy
Cleanup complete.

Simulation 1/10 score: 0.7609324167780311
Running repeat 2/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741801735.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_1805582_1741801735'
Loaded dataset: downsampled_5000genes_1805582_1741801735
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.37544451952392244 13.354999178499863 1.0 8.0 8.0
0.2787892497785911 22.54124519212114 1.0 8.0 8.0
0.2880298507581288 16.707043383598325 1.0 8.0 8.0
0.29561355924085553 16.135917718575307 1.0 8.0 8.0
0.29701225880782633 16.139323838564703 1.0 8.0 8.0
0.2979499426140665 16.342098870561234 1.0 8.0 8.0
0.29817318794520165 16.32386950038682 1.0 8.0 8.0
0.29817634607534893 16.069569324672166 1.0 8.0 8.0
0.29809707286702547 16.082364935217427 1.0 8.0 8.0
0.2980853204511389 16.06218458637698 1.0 8.0 8.0
0.29810491705152153 15.992148565426268 1.0 8.0 8.0
0.2980838118502098 15.972463317195665 1.0 8.0 8.0
0.29807716171745235 15.942943652571415 1.0 8.0 8.0
0.2980717924593027 15.86305236001221 1.0 8.0 8.0
0.29807018657927664 15.873167107684514 1.0 8.0 8.0
0.2980697614064093 15.835462428942598 1.0 8.0 8.0
0.29806897771726937 15.904897485948096 1.0 8.0 8.0
0.2980683312798488 15.903530738189023 1.0 8.0 8.0
0.2980681382441993 15.904273452931196 1.0 8.0 8.0
0.29806783632205125 15.924450339776289 1.0 8.0 8.0
U dimensions = (4971, 33)
Iteration 0 of 1
phi.shape: (200, 4971)
U.shape: (4971, 33)
phi.dot(U).T shape: (33, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741801735.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741801735_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741801735_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741801735_test_data.npy
Cleanup complete.

Simulation 2/10 score: 0.7591187911850283
Running repeat 3/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741801836.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_1805582_1741801836'
Loaded dataset: downsampled_5000genes_1805582_1741801836
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.34359002645683634 11.225393414636162 1.0 8.0 8.0
0.28413559533086497 20.456849941836715 1.0 8.0 8.0
0.29459992264837975 17.18036585271718 1.0 8.0 8.0
0.2964267855927013 16.62051015592301 1.0 8.0 8.0
0.2971335787685474 16.737287507416 1.0 8.0 8.0
0.29727788927999976 16.551278563349424 1.0 8.0 8.0
0.29724968027834586 16.303372841465393 1.0 8.0 8.0
0.2971841250287526 16.256324454155603 1.0 8.0 8.0
0.29710627493963704 16.18497538711352 1.0 8.0 8.0
0.2970940042190441 16.217892497046865 1.0 8.0 8.0
0.29707302519633527 16.187015550969974 1.0 8.0 8.0
0.29703206193239806 16.204530072639823 1.0 8.0 8.0
0.29701860324934193 16.203868746517273 1.0 8.0 8.0
0.2970102651475448 16.216031844567386 1.0 8.0 8.0
0.29699630795901455 16.227492148794795 1.0 8.0 8.0
0.29700396859329403 16.217150999199752 1.0 8.0 8.0
0.2970009809706692 16.232979571425282 1.0 8.0 8.0
0.2969792029258197 16.261826670183765 1.0 8.0 8.0
0.296944418935024 16.300892841659433 1.0 8.0 8.0
0.2969178940990074 16.298813967081145 1.0 8.0 8.0
U dimensions = (4971, 32)
Iteration 0 of 1
phi.shape: (200, 4971)
U.shape: (4971, 32)
phi.dot(U).T shape: (32, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741801836.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741801836_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741801836_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741801836_test_data.npy
Cleanup complete.

Simulation 3/10 score: 0.7458010538256112
Running repeat 4/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741801944.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_1805582_1741801944'
Loaded dataset: downsampled_5000genes_1805582_1741801944
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.33562193066292545 12.615762215742727 1.0 8.0 8.0
0.2868132145217036 18.56064059626202 1.0 8.0 8.0
0.29452413314284753 16.632994423071104 1.0 8.0 8.0
0.2963310909015532 16.695813390995067 1.0 8.0 8.0
0.2974437707907147 16.611214756444845 1.0 8.0 8.0
0.2976051317575781 16.585760182951987 1.0 8.0 8.0
0.29753826191008115 16.530276476187634 1.0 8.0 8.0
0.29748419483682154 16.476377901506645 1.0 8.0 8.0
0.2974656491845198 16.240765099595862 1.0 8.0 8.0
0.2974633782483824 16.212836182434696 1.0 8.0 8.0
0.29745927818992646 16.27435031948574 1.0 8.0 8.0
0.2974561121434529 16.31395195822114 1.0 8.0 8.0
0.29745372080914445 16.341758130175243 1.0 8.0 8.0
0.29745212306147595 16.40816406246498 1.0 8.0 8.0
0.2974503758592191 16.316835287720444 1.0 8.0 8.0
0.2974497404766212 16.244927578777705 1.0 8.0 8.0
0.2974495966497964 16.246022421199164 1.0 8.0 8.0
0.29744957838187447 16.24348182437723 1.0 8.0 8.0
0.29744961096071765 16.24331276799011 1.0 8.0 8.0
0.2974496096107557 16.243308708955727 1.0 8.0 8.0
U dimensions = (4971, 32)
Iteration 0 of 1
phi.shape: (200, 4971)
U.shape: (4971, 32)
phi.dot(U).T shape: (32, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741801944.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741801944_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741801944_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741801944_test_data.npy
Cleanup complete.

Simulation 4/10 score: 0.7518504109972967
Running repeat 5/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802056.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_1805582_1741802056'
Loaded dataset: downsampled_5000genes_1805582_1741802056
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.35583882044098203 11.682990023692472 1.0 8.0 8.0
0.2877982905626899 21.839315910731088 1.0 8.0 8.0
0.29326316050593504 19.04447848184184 1.0 8.0 8.0
0.29817382285343774 17.550845207245796 1.0 8.0 8.0
0.2988835469507015 17.497868562958455 1.0 8.0 8.0
0.29903726450630175 17.57858986762812 1.0 8.0 8.0
0.2989788640866874 17.56261443025113 1.0 8.0 8.0
0.2989816302890268 17.551025004746894 1.0 8.0 8.0
0.29895147416333523 17.54956772715988 1.0 8.0 8.0
0.2989464455367157 17.538116924571515 1.0 8.0 8.0
0.2989344738048907 17.541974643775518 1.0 8.0 8.0
0.29892087755403607 17.537862847039058 1.0 8.0 8.0
0.29891021873858825 17.524349019372146 1.0 8.0 8.0
0.2989075631391691 17.514586499388738 1.0 8.0 8.0
0.2989091502676615 17.512751884425416 1.0 8.0 8.0
0.29891099999263293 17.511498040584925 1.0 8.0 8.0
0.298910896025111 17.511587477351746 1.0 8.0 8.0
0.2989108897622128 17.511592616402034 1.0 8.0 8.0
0.29891088932628074 17.51159301776201 1.0 8.0 8.0
0.2989108892914404 17.51159304716053 1.0 8.0 8.0
U dimensions = (4971, 33)
Iteration 0 of 1
phi.shape: (200, 4971)
U.shape: (4971, 33)
phi.dot(U).T shape: (33, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802056.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802056_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802056_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802056_test_data.npy
Cleanup complete.

Simulation 5/10 score: 0.7547062172046625
Running repeat 6/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802159.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_1805582_1741802159'
Loaded dataset: downsampled_5000genes_1805582_1741802159
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3424648922107729 11.583840433825149 1.0 8.0 8.0
0.2876383217430205 21.040246367792744 1.0 8.0 8.0
0.2970181152001451 19.20324530316991 1.0 8.0 8.0
0.29941720804026095 18.816796825378958 1.0 8.0 8.0
0.29958863548272263 18.788985386802647 1.0 8.0 8.0
0.29972044522168073 18.720804381463516 1.0 8.0 8.0
0.2998124779928353 18.54187257326198 1.0 8.0 8.0
0.2998164372615282 18.472299954883667 1.0 8.0 8.0
0.2998109179579548 18.46748873780028 1.0 8.0 8.0
0.29982647685731645 18.47210961510909 1.0 8.0 8.0
0.29985173058400094 18.452081252460285 1.0 8.0 8.0
0.299849796067877 18.457323999370043 1.0 8.0 8.0
0.29984946288055025 18.463622566535317 1.0 8.0 8.0
0.29984951659402115 18.485490206059197 1.0 8.0 8.0
0.29984843656603866 18.48364605746838 1.0 8.0 8.0
0.2998440586209449 18.48354862540329 1.0 8.0 8.0
0.299840295901209 18.478402801157554 1.0 8.0 8.0
0.29983616502962096 18.47468269344677 1.0 8.0 8.0
0.29983640532735323 18.469767376103242 1.0 8.0 8.0
0.2998328965168511 18.48808448289431 1.0 8.0 8.0
U dimensions = (4971, 33)
Iteration 0 of 1
phi.shape: (200, 4971)
U.shape: (4971, 33)
phi.dot(U).T shape: (33, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802159.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802159_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802159_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802159_test_data.npy
Cleanup complete.

Simulation 6/10 score: 0.7535430645852667
Running repeat 7/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802265.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_1805582_1741802265'
Loaded dataset: downsampled_5000genes_1805582_1741802265
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.36412940856075315 12.600104324842338 1.0 8.0 8.0
0.2799273833041831 20.796809199820597 1.0 8.0 8.0
0.29055620504554924 17.31859922159971 1.0 8.0 8.0
0.29260015398873906 17.071548125885734 1.0 8.0 8.0
0.2936101923826968 17.372277914133957 1.0 8.0 8.0
0.2944961671735433 17.344948755747705 1.0 8.0 8.0
0.2947964522424211 17.288316952972735 1.0 8.0 8.0
0.29482467584237904 17.228732178868615 1.0 8.0 8.0
0.29492501374183144 17.14751438127987 1.0 8.0 8.0
0.2950778355677608 17.10042699047328 1.0 8.0 8.0
0.2951497271449457 17.102307056736453 1.0 8.0 8.0
0.29514513680568644 17.07313484651008 1.0 8.0 8.0
0.2951296200246042 17.064624870617415 1.0 8.0 8.0
0.2951176976055089 17.066338665340403 1.0 8.0 8.0
0.295118004883148 17.058669909925012 1.0 8.0 8.0
0.2951177042600288 17.056600252981656 1.0 8.0 8.0
0.29511762594715196 17.056405970363034 1.0 8.0 8.0
0.2951176168105575 17.056312245816482 1.0 8.0 8.0
0.2951176167667482 17.056315620134466 1.0 8.0 8.0
0.29511761677546366 17.056316282457505 1.0 8.0 8.0
U dimensions = (4971, 35)
Iteration 0 of 1
phi.shape: (200, 4971)
U.shape: (4971, 35)
phi.dot(U).T shape: (35, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802265.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802265_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802265_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802265_test_data.npy
Cleanup complete.

Simulation 7/10 score: 0.7693408552997294
Running repeat 8/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802368.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_1805582_1741802368'
Loaded dataset: downsampled_5000genes_1805582_1741802368
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3418444262761361 11.899899782986983 1.0 8.0 8.0
0.28014434382504105 19.899011313620328 1.0 8.0 8.0
0.2878956422386145 17.24362935212634 1.0 8.0 8.0
0.29159714885326415 17.01925435477067 1.0 8.0 8.0
0.2927562222266554 17.276782896283258 1.0 8.0 8.0
0.29349098700565135 17.250572725673965 1.0 8.0 8.0
0.29408011159478165 17.09593788288978 1.0 8.0 8.0
0.2945426619743833 17.084619534126894 1.0 8.0 8.0
0.2948180034252339 17.076921513320286 1.0 8.0 8.0
0.2950295927528669 17.080001811397306 1.0 8.0 8.0
0.29506899343292337 17.081068150110543 1.0 8.0 8.0
0.29506307118079556 17.08331633163683 1.0 8.0 8.0
0.29506100605478514 17.083302196596602 1.0 8.0 8.0
0.29505874237613616 17.085081576747697 1.0 8.0 8.0
0.2950572925582202 17.089979112381236 1.0 8.0 8.0
0.29505480611388113 17.085219767724567 1.0 8.0 8.0
0.29505124354137047 17.07728390574128 1.0 8.0 8.0
0.29504442710796996 17.070012246906543 1.0 8.0 8.0
0.2950384516368284 17.067026379676797 1.0 8.0 8.0
0.29502758919978966 17.059249658595053 1.0 8.0 8.0
U dimensions = (4971, 34)
Iteration 0 of 1
phi.shape: (200, 4971)
U.shape: (4971, 34)
phi.dot(U).T shape: (34, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802368.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802368_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802368_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802368_test_data.npy
Cleanup complete.

Simulation 8/10 score: 0.763138694946961
Running repeat 9/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802477.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_1805582_1741802477'
Loaded dataset: downsampled_5000genes_1805582_1741802477
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3414516248563366 11.712465458151108 1.0 8.0 8.0
0.2818997089793458 20.530084738895848 1.0 8.0 8.0
0.2872103846828272 18.82895053280312 1.0 8.0 8.0
0.286249212081774 18.01826194776906 1.0 8.0 8.0
0.2943466569414218 17.68151461974644 1.0 8.0 8.0
0.2971812086993928 17.651339522607138 1.0 8.0 8.0
0.2976479320084404 17.610168382045522 1.0 8.0 8.0
0.2977587221393935 17.64717946779276 1.0 8.0 8.0
0.29774461132104857 17.62771156120589 1.0 8.0 8.0
0.29778951192508896 17.710318779310157 1.0 8.0 8.0
0.297778700611552 17.72463684860209 1.0 8.0 8.0
0.2977510613667941 17.752397140760788 1.0 8.0 8.0
0.297740032639089 17.791377583787504 1.0 8.0 8.0
0.297733533167443 17.701996126575857 1.0 8.0 8.0
0.29772944896090336 17.690588102347547 1.0 8.0 8.0
0.29772708580099383 17.69509403387843 1.0 8.0 8.0
0.2977246369600459 17.692625173099476 1.0 8.0 8.0
0.2977235479691115 17.687597110375123 1.0 8.0 8.0
0.2977254033583939 17.67628733025883 1.0 8.0 8.0
0.29772482195398287 17.670973714139766 1.0 8.0 8.0
U dimensions = (4971, 31)
Iteration 0 of 1
phi.shape: (200, 4971)
U.shape: (4971, 31)
phi.dot(U).T shape: (31, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802477.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802477_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802477_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802477_test_data.npy
Cleanup complete.

Simulation 9/10 score: 0.7268770698626273
Running repeat 10/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802594.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_1805582_1741802594'
Loaded dataset: downsampled_5000genes_1805582_1741802594
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3717369544601974 12.308324524824211 1.0 8.0 8.0
0.28192506607723666 22.660842991039587 1.0 8.0 8.0
0.2927490986378709 18.034940030182366 1.0 8.0 8.0
0.29524408409211444 17.37960496497044 1.0 8.0 8.0
0.2959016169326435 17.289434137885895 1.0 8.0 8.0
0.2961637002561466 17.248208393157004 1.0 8.0 8.0
0.29640809849333094 17.23910813596303 1.0 8.0 8.0
0.29648437544859907 17.229725279739473 1.0 8.0 8.0
0.2966334659982812 17.15665010141738 1.0 8.0 8.0
0.2967592477963842 17.00883994191008 1.0 8.0 8.0
0.29685032889223084 17.011867147009237 1.0 8.0 8.0
0.2968965518842692 17.008862529796637 1.0 8.0 8.0
0.29689735667175177 17.00865985193103 1.0 8.0 8.0
0.2968973641315048 17.008630667546857 1.0 8.0 8.0
0.2968973676851616 17.00863037626071 1.0 8.0 8.0
0.2968973671673837 17.008630104589503 1.0 8.0 8.0
0.2968973672740226 17.008630136998388 1.0 8.0 8.0
0.2968973672529355 17.008630129200558 1.0 8.0 8.0
0.2968973672570733 17.00863013058427 1.0 8.0 8.0
0.29689736725625837 17.008630130303068 1.0 8.0 8.0
U dimensions = (4971, 33)
Iteration 0 of 1
phi.shape: (200, 4971)
U.shape: (4971, 33)
phi.dot(U).T shape: (33, 200)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802594.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802594_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802594_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_1805582_1741802594_test_data.npy
Cleanup complete.

Simulation 10/10 score: 0.7420305381048552
Results saved: results/simulation/results_optimal.csv
Running simulation with: num_measurements=500, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=1000
Running repeat 1/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802233.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_146911_1741802233'
Loaded dataset: downsampled_1000genes_146911_1741802233
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.18299919487394345 5.442677431206127 nan 8.0 8.0
0.089171464185415 12.835825224532089 nan 8.0 8.0
0.08640201517716295 11.966726803501013 nan 8.0 8.0
0.08528207331143578 11.983388943228697 nan 8.0 8.0
0.08477188034248462 11.894554149326673 nan 8.0 8.0
0.08427065794782873 11.852382941809743 nan 8.0 8.0
0.08388532053591757 11.84898606051093 nan 8.0 8.0
0.0835931468488148 11.853201025949305 nan 8.0 8.0
0.08327126949193298 11.91399610606141 nan 8.0 8.0
0.0827714670072418 11.984030456044984 nan 8.0 8.0
0.08225770117115494 12.060162358339914 nan 8.0 8.0
0.08193592716474185 12.014758843790977 nan 8.0 8.0
0.08175225133080621 12.03285584076718 nan 8.0 8.0
0.0816297366566533 12.031258941080353 nan 8.0 8.0
0.08151885861044039 12.024839369163084 nan 8.0 8.0
0.08136120488504617 11.910900578139628 nan 8.0 8.0
0.08132011455499566 11.869729964202307 nan 8.0 8.0
0.08125938917499642 11.837514037606145 nan 8.0 8.0
0.081278431147357 11.823569687724415 nan 8.0 8.0
0.08130223751436882 11.803232746419125 nan 8.0 8.0
U dimensions = (906, 34)
Iteration 0 of 1
phi.shape: (500, 906)
U.shape: (906, 34)
phi.dot(U).T shape: (34, 500)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802233.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802233_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802233_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802233_test_data.npy
Cleanup complete.

Simulation 1/10 score: 0.8907163123647446
Running repeat 2/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802287.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_146911_1741802287'
Loaded dataset: downsampled_1000genes_146911_1741802287
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.18004490515369698 5.586000328472909 1.0 8.0 8.0
0.08941096093306489 13.232568515037505 1.0 8.0 8.0
0.08486843818519396 12.429406625777153 1.0 8.0 8.0
0.0832937177720009 11.764459032557026 1.0 8.0 8.0
0.08252383649840123 11.456856243518729 1.0 8.0 8.0
0.08209538435508257 11.517049298200755 1.0 8.0 8.0
0.08214750785567582 11.523508666830622 1.0 8.0 8.0
0.08212800374091156 11.624831755443708 1.0 8.0 8.0
0.08210428478058196 11.658638237973868 1.0 8.0 8.0
0.08208239473052792 11.666076553516858 1.0 8.0 8.0
0.08204185252203511 11.663617304443289 1.0 8.0 8.0
0.08203373287316562 11.653082042750778 1.0 8.0 8.0
0.08206534170538837 11.627755868411594 1.0 8.0 8.0
0.08206337710008593 11.574605627896968 1.0 8.0 8.0
0.08209147689448515 11.522739450579461 1.0 8.0 8.0
0.08209765570054905 11.509652842428991 1.0 8.0 8.0
0.08211765515680691 11.495584838465605 1.0 8.0 8.0
0.0821523190772998 11.49103544755582 1.0 8.0 8.0
0.08214694986933646 11.4993869463935 1.0 8.0 8.0
0.08213985266196488 11.507811404585476 1.0 8.0 8.0
U dimensions = (906, 34)
Iteration 0 of 1
phi.shape: (500, 906)
U.shape: (906, 34)
phi.dot(U).T shape: (34, 500)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802287.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802287_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802287_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802287_test_data.npy
Cleanup complete.

Simulation 2/10 score: 0.895329420233952
Running repeat 3/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802335.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_146911_1741802335'
Loaded dataset: downsampled_1000genes_146911_1741802335
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.15344855245600564 5.119105807393577 nan 8.0 8.0
0.08006043462271506 10.785803951694758 nan 8.0 8.0
0.0782248997790107 10.811805036052949 nan 8.0 8.0
0.07771706429624792 10.841904019610755 nan 8.0 8.0
0.07769195693909903 10.768208865017911 nan 8.0 8.0
0.07781008944117218 10.71122280253676 nan 8.0 8.0
0.07789674299628246 10.73521886292911 nan 8.0 8.0
0.07775701573125504 10.774265275043454 nan 8.0 8.0
0.07764293886139872 10.793542738458667 nan 8.0 8.0
0.07758881720563615 10.764384383347094 nan 8.0 8.0
0.07756090959166473 10.771498081245376 nan 8.0 8.0
0.07754000372322611 10.77786253106126 nan 8.0 8.0
0.07753457899128435 10.779686754421768 nan 8.0 8.0
0.0775311664513344 10.779436238742912 nan 8.0 8.0
0.07752739561201905 10.779639296543364 nan 8.0 8.0
0.07752693717095571 10.779377951352643 nan 8.0 8.0
0.07752697811248 10.779047462450587 nan 8.0 8.0
0.07752663332169807 10.77662445749946 nan 8.0 8.0
0.07752663988205521 10.775828148799702 nan 8.0 8.0
0.07752661701181174 10.7747365717315 nan 8.0 8.0
U dimensions = (906, 36)
Iteration 0 of 1
phi.shape: (500, 906)
U.shape: (906, 36)
phi.dot(U).T shape: (36, 500)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802335.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802335_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802335_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802335_test_data.npy
Cleanup complete.

Simulation 3/10 score: 0.9101110752294755
Running repeat 4/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802379.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_146911_1741802379'
Loaded dataset: downsampled_1000genes_146911_1741802379
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.16997701794013143 5.335334720888719 1.0 8.0 8.0
0.08327024919358783 11.76908922895816 1.0 8.0 8.0
0.08092331491018656 11.18594812895493 1.0 8.0 8.0
0.08039092722959262 10.972422583243349 1.0 8.0 8.0
0.0800200605678334 11.017565331695696 1.0 8.0 8.0
0.07979323600779364 11.042191514295824 1.0 8.0 8.0
0.07971930007468231 10.951494882811378 1.0 8.0 8.0
0.07965978287267539 10.904646956382575 1.0 8.0 8.0
0.07968877001776764 10.847633516724143 1.0 8.0 8.0
0.07974047183790867 10.81469234956795 1.0 8.0 8.0
0.07977936225749094 10.806735209386563 1.0 8.0 8.0
0.07981893516036331 10.785711545900224 1.0 8.0 8.0
0.07983863449385542 10.781049798638206 1.0 8.0 8.0
0.07985176950570216 10.774429092878771 1.0 8.0 8.0
0.07984331674071987 10.773681276890407 1.0 8.0 8.0
0.07984543932499133 10.784151272682882 1.0 8.0 8.0
0.07983706649644884 10.777307407429992 1.0 8.0 8.0
0.07977696856316929 10.758935418192173 1.0 8.0 8.0
0.07978331141922723 10.757275385261515 1.0 8.0 8.0
0.07977867463786892 10.756140570829501 1.0 8.0 8.0
U dimensions = (906, 35)
Iteration 0 of 1
phi.shape: (500, 906)
U.shape: (906, 35)
phi.dot(U).T shape: (35, 500)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802379.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802379_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802379_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802379_test_data.npy
Cleanup complete.

Simulation 4/10 score: 0.856056687597194
Running repeat 5/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802419.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_146911_1741802419'
Loaded dataset: downsampled_1000genes_146911_1741802419
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.15286519921675346 5.073310581702484 nan 8.0 8.0
0.0871748462071481 12.155813580419677 nan 8.0 8.0
0.08548936709151378 11.727935883542324 nan 8.0 8.0
0.08456794968029657 11.576304465076388 nan 8.0 8.0
0.08404711708642854 11.529315432585152 nan 8.0 8.0
0.0840547456506352 11.353345313513636 nan 8.0 8.0
0.08412858358344388 11.243197690689396 nan 8.0 8.0
0.0841736800097792 11.04960158538824 nan 8.0 8.0
0.08424217080098595 10.938761965166858 nan 8.0 8.0
0.08425610874984779 10.65561617694365 nan 8.0 8.0
0.08426153187831664 10.708533761399375 nan 8.0 8.0
0.08426347930651978 10.713230695308408 nan 8.0 8.0
0.08426160999616339 10.723549137047957 nan 8.0 8.0
0.08426151592307118 10.729771615769327 nan 8.0 8.0
0.08426139126144994 10.719916978700702 nan 8.0 8.0
0.08426137678564183 10.718416269016013 nan 8.0 8.0
0.08426137652068266 10.718349698085754 nan 8.0 8.0
0.08426137649407417 10.718345669153196 nan 8.0 8.0
0.08426137649259269 10.718345398861667 nan 8.0 8.0
0.08426137649247767 10.718345376434888 nan 8.0 8.0
U dimensions = (906, 35)
Iteration 0 of 1
phi.shape: (500, 906)
U.shape: (906, 35)
phi.dot(U).T shape: (35, 500)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802419.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802419_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802419_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802419_test_data.npy
Cleanup complete.

Simulation 5/10 score: 0.7359164480458006
Running repeat 6/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802458.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_146911_1741802458'
Loaded dataset: downsampled_1000genes_146911_1741802458
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.15730538989371268 5.0600661447616995 1.0 8.0 8.0
0.07836521220833537 10.520385543125109 1.0 8.0 8.0
0.07682088405221421 10.607791727822022 1.0 8.0 8.0
0.0763032265935244 10.351950022380326 1.0 8.0 8.0
0.07600865328087225 10.183701768313956 1.0 8.0 8.0
0.07568988723778525 10.04804463593577 1.0 8.0 8.0
0.07539532528979775 9.961617643119292 1.0 8.0 8.0
0.07522500680843558 9.922140414161625 1.0 8.0 8.0
0.07520449576786126 9.855684689934867 1.0 8.0 8.0
0.07528006681985733 9.658211169989615 1.0 8.0 8.0
0.07542924469014245 9.613609852570884 1.0 8.0 8.0
0.07545955131200754 9.607881836845669 1.0 8.0 8.0
0.07551385063538796 9.57734466274909 1.0 8.0 8.0
0.07553395367208249 9.578675316398305 1.0 8.0 8.0
0.07554504112225224 9.559569430568592 1.0 8.0 8.0
0.07556489877041517 9.55719026223712 1.0 8.0 8.0
0.07561539745821844 9.546226129253299 1.0 8.0 8.0
0.07567172767272823 9.528909416345131 1.0 8.0 8.0
0.07573278972421493 9.51887886998613 1.0 8.0 8.0
0.07573137816685482 9.521211302330896 1.0 8.0 8.0
U dimensions = (906, 38)
Iteration 0 of 1
phi.shape: (500, 906)
U.shape: (906, 38)
phi.dot(U).T shape: (38, 500)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802458.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802458_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802458_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802458_test_data.npy
Cleanup complete.

Simulation 6/10 score: 0.8758720840801969
Running repeat 7/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802498.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_146911_1741802498'
Loaded dataset: downsampled_1000genes_146911_1741802498
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.17782816653532663 5.787552217492718 1.0 8.0 8.0
0.08534456589059392 13.109172566941647 1.0 8.0 8.0
0.0841410059460369 12.47790355095638 1.0 8.0 8.0
0.08354944102992123 12.10570880189428 1.0 8.0 8.0
0.08292812144819306 12.018681723547855 1.0 8.0 8.0
0.08261117748012725 12.095224521408896 1.0 8.0 8.0
0.08227264732005657 12.111730218878037 1.0 8.0 8.0
0.08175608499713871 12.127945156864635 1.0 8.0 8.0
0.08137785494314898 12.105557965943602 1.0 8.0 8.0
0.08136470109381067 11.98641021401749 1.0 8.0 8.0
0.0813609611180115 11.953509269205448 1.0 8.0 8.0
0.08136169951633732 11.929460795672163 1.0 8.0 8.0
0.0812935782142179 11.901179299484454 1.0 8.0 8.0
0.08123657898259484 11.874738306762953 1.0 8.0 8.0
0.08113744100082809 11.858161994427986 1.0 8.0 8.0
0.08105221236507842 11.843925458633306 1.0 8.0 8.0
0.08099561956138901 11.831933917964946 1.0 8.0 8.0
0.08097547347073764 11.828973953104358 1.0 8.0 8.0
0.08095217350495598 11.835246023630289 1.0 8.0 8.0
0.08095366716187058 11.837609618897313 1.0 8.0 8.0
U dimensions = (906, 36)
Iteration 0 of 1
phi.shape: (500, 906)
U.shape: (906, 36)
phi.dot(U).T shape: (36, 500)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802498.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802498_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802498_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802498_test_data.npy
Cleanup complete.

Simulation 7/10 score: 0.8436167927841259
Running repeat 8/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802556.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_146911_1741802556'
Loaded dataset: downsampled_1000genes_146911_1741802556
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.16268581247717706 4.8527526620748045 1.0 8.0 8.0
0.08024625038892064 12.727754797919985 1.0 8.0 8.0
0.07772845539769224 11.584405024987522 1.0 8.0 8.0
0.07712582855368777 11.211983830281019 1.0 8.0 8.0
0.07695630515424978 10.674994809359891 1.0 8.0 8.0
0.077091350364072 10.466862447416023 1.0 8.0 8.0
0.0772855432204046 10.358352720946487 1.0 8.0 8.0
0.07746850758332902 10.26107303287365 1.0 8.0 8.0
0.07757195952982743 10.07884781914344 1.0 8.0 8.0
0.07758129523709001 10.011510338010751 1.0 8.0 8.0
0.07753326933216531 9.962572965854283 1.0 8.0 8.0
0.07752269299793002 9.950760194411574 1.0 8.0 8.0
0.07752144580526898 9.949600335095925 1.0 8.0 8.0
0.07752309117755918 9.946953195078642 1.0 8.0 8.0
0.07752299986042277 9.94705979945796 1.0 8.0 8.0
0.07752299970262688 9.947060649570165 1.0 8.0 8.0
0.07752299965909792 9.947060760690436 1.0 8.0 8.0
0.07752299965797849 9.947060764748596 1.0 8.0 8.0
0.07752299965794196 9.947060764941723 1.0 8.0 8.0
0.07752299965793996 9.947060764950226 1.0 8.0 8.0
U dimensions = (906, 37)
Iteration 0 of 1
phi.shape: (500, 906)
U.shape: (906, 37)
phi.dot(U).T shape: (37, 500)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802556.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802556_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802556_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802556_test_data.npy
Cleanup complete.

Simulation 8/10 score: 0.43741906942272124
Running repeat 9/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802614.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_146911_1741802614'
Loaded dataset: downsampled_1000genes_146911_1741802614
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.1864523838403993 5.362108497064832 1.0 8.0 8.0
0.08598612726524413 12.581111088550907 1.0 8.0 8.0
0.08432140023544821 12.018822857427367 1.0 8.0 8.0
0.08339518336147722 12.001504232328367 1.0 8.0 8.0
0.08302880902213938 12.017917940786148 1.0 8.0 8.0
0.08287121901506367 11.938312632660924 1.0 8.0 8.0
0.08263339393367852 11.840543930280253 1.0 8.0 8.0
0.08238068773976048 11.811705637843904 1.0 8.0 8.0
0.08234642583591045 11.821051672872995 1.0 8.0 8.0
0.08234754381534581 11.813341160992978 1.0 8.0 8.0
0.0823602874439 11.810623504789772 1.0 8.0 8.0
0.08235961206049447 11.810790142693751 1.0 8.0 8.0
0.0823422468420748 11.82118185791285 1.0 8.0 8.0
0.08232614615290501 11.828147842982256 1.0 8.0 8.0
0.0823298776195941 11.833259459049927 1.0 8.0 8.0
0.08233205439878022 11.832743479653773 1.0 8.0 8.0
0.08233206805385274 11.832850390785836 1.0 8.0 8.0
0.08233207079767202 11.832858564557664 1.0 8.0 8.0
0.0823320709961134 11.832859283875568 1.0 8.0 8.0
0.08233207101275297 11.832859346006286 1.0 8.0 8.0
U dimensions = (906, 35)
Iteration 0 of 1
phi.shape: (500, 906)
U.shape: (906, 35)
phi.dot(U).T shape: (35, 500)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802614.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802614_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802614_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802614_test_data.npy
Cleanup complete.

Simulation 9/10 score: 0.7334660331671629
Running repeat 10/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802670.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_146911_1741802670'
Loaded dataset: downsampled_1000genes_146911_1741802670
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.16759809846734208 4.998688850154165 1.0 8.0 8.0
0.08818652294645102 12.033366370063433 1.0 8.0 8.0
0.08526316204446549 11.746605260125666 1.0 8.0 8.0
0.08287577912695432 11.772109614463897 1.0 8.0 8.0
0.08142124677002827 11.782833532319808 1.0 8.0 8.0
0.08071677468511151 11.817221115935011 1.0 8.0 8.0
0.08032107685298173 11.677790758563802 1.0 8.0 8.0
0.08004972082391482 11.369329740938449 1.0 8.0 8.0
0.07993523828616955 11.361121696488226 1.0 8.0 8.0
0.07998414190616354 11.224028127630996 1.0 8.0 8.0
0.08001962892069792 11.009098028821137 1.0 8.0 8.0
0.0800064506089897 11.011119688582395 1.0 8.0 8.0
0.08000727086410941 11.029022133001986 1.0 8.0 8.0
0.08000893010241172 11.017817394723922 1.0 8.0 8.0
0.08000393410225415 11.009435268807088 1.0 8.0 8.0
0.08000338518337202 11.008706324748031 1.0 8.0 8.0
0.08000035895504998 11.009217710590459 1.0 8.0 8.0
0.07999855153947943 11.009418874175243 1.0 8.0 8.0
0.07999854433285725 11.009407240979682 1.0 8.0 8.0
0.07999854422643782 11.009407867830262 1.0 8.0 8.0
U dimensions = (906, 38)
Iteration 0 of 1
phi.shape: (500, 906)
U.shape: (906, 38)
phi.dot(U).T shape: (38, 500)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802670.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802670_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802670_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_146911_1741802670_test_data.npy
Cleanup complete.

Simulation 10/10 score: 0.8919193404201738
Results saved: results/simulation/results_optimal.csv
Running simulation with: num_measurements=75, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=5000
Running repeat 1/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741800881.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3998861_1741800881'
Loaded dataset: downsampled_5000genes_3998861_1741800881
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.36694219401806083 12.182055217130282 1.0 8.0 8.0
0.2830027160440407 21.435942061752822 1.0 8.0 8.0
0.2895595358923331 17.15955006839264 1.0 8.0 8.0
0.2959943209256459 16.116124282778188 1.0 8.0 8.0
0.29707453152686214 16.065191998856417 1.0 8.0 8.0
0.2985244747498681 16.36814016958458 1.0 8.0 8.0
0.29929127319139326 16.39913245799904 1.0 8.0 8.0
0.29974691192837943 16.705579039772182 1.0 8.0 8.0
0.3001111751216965 16.725905833856817 1.0 8.0 8.0
0.30037257917958593 16.72447236329632 1.0 8.0 8.0
0.3006226207509992 16.690738646673825 1.0 8.0 8.0
0.30092034578762994 16.631979100153146 1.0 8.0 8.0
0.30109975236868525 16.394658250140417 1.0 8.0 8.0
0.3010997220082289 16.386518794597723 1.0 8.0 8.0
0.30110128495225874 16.36669353588205 1.0 8.0 8.0
0.3011005215112289 16.36621619853302 1.0 8.0 8.0
0.3011004881994003 16.362160679730312 1.0 8.0 8.0
0.3011003523097794 16.361813213357486 1.0 8.0 8.0
0.3011003355383898 16.360587498897328 1.0 8.0 8.0
0.30110032918954177 16.360540718277974 1.0 8.0 8.0
U dimensions = (4971, 36)
Iteration 0 of 1
phi.shape: (75, 4971)
U.shape: (4971, 36)
phi.dot(U).T shape: (36, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741800881.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741800881_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741800881_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741800881_test_data.npy
Cleanup complete.

Simulation 1/10 score: 0.6906958521779857
Running repeat 2/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801144.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3998861_1741801144'
Loaded dataset: downsampled_5000genes_3998861_1741801144
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.33404313250288664 11.078066077765067 1.0 8.0 8.0
0.28958584729288495 18.633649585459366 1.0 8.0 8.0
0.2936358488667956 16.813824758286135 1.0 8.0 8.0
0.29545982583729224 16.449650816337012 1.0 8.0 8.0
0.29597026403855076 16.450820796828612 1.0 8.0 8.0
0.29592672565751765 16.418672495387433 1.0 8.0 8.0
0.2956393769627901 16.46645233440796 1.0 8.0 8.0
0.29554273943329645 16.47077768336031 1.0 8.0 8.0
0.2955142863650435 16.48508714045953 1.0 8.0 8.0
0.29552846693689894 16.47354369156414 1.0 8.0 8.0
0.29553575689505207 16.468668643126204 1.0 8.0 8.0
0.2955338064081935 16.450656145598412 1.0 8.0 8.0
0.29553180965883086 16.44448014813566 1.0 8.0 8.0
0.29552716281419045 16.44691152621448 1.0 8.0 8.0
0.29550570132787246 16.430408333825714 1.0 8.0 8.0
0.2954947548294167 16.40712190939041 1.0 8.0 8.0
0.29548750518233746 16.395798596061837 1.0 8.0 8.0
0.2954847854313776 16.45247803760772 1.0 8.0 8.0
0.29548477769345316 16.451854362784704 1.0 8.0 8.0
0.29548454755061315 16.45237944933032 1.0 8.0 8.0
U dimensions = (4971, 35)
Iteration 0 of 1
phi.shape: (75, 4971)
U.shape: (4971, 35)
phi.dot(U).T shape: (35, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801144.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801144_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801144_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801144_test_data.npy
Cleanup complete.

Simulation 2/10 score: 0.7055065985194373
Running repeat 3/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801340.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3998861_1741801340'
Loaded dataset: downsampled_5000genes_3998861_1741801340
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3649818959264194 12.771289700828207 1.0 8.0 8.0
0.28184499595071777 20.847894639221856 1.0 8.0 8.0
0.290989609223122 17.225648848994194 1.0 8.0 8.0
0.2983454945020081 16.442740727711406 1.0 8.0 8.0
0.29973961560840157 16.69259286642799 1.0 8.0 8.0
0.3004053006866284 16.581700919891382 1.0 8.0 8.0
0.3005100694824173 16.38026265099293 1.0 8.0 8.0
0.30071316489725297 16.184128426090343 1.0 8.0 8.0
0.3008829368461099 16.156032808756972 1.0 8.0 8.0
0.3010307940385143 16.192215797366654 1.0 8.0 8.0
0.30096722513040186 16.108859639987216 1.0 8.0 8.0
0.3008621386762428 16.168569443883435 1.0 8.0 8.0
0.3008120743489652 16.22320426014609 1.0 8.0 8.0
0.30077658650598693 16.25171954384885 1.0 8.0 8.0
0.3007593807772002 16.27798560169558 1.0 8.0 8.0
0.3007230244231869 16.28786174111205 1.0 8.0 8.0
0.30072393025939315 16.282243416809845 1.0 8.0 8.0
0.30072405721671336 16.279810042408027 1.0 8.0 8.0
0.3007237234847371 16.282120532729977 1.0 8.0 8.0
0.3007233476993483 16.28208639632837 1.0 8.0 8.0
U dimensions = (4971, 34)
Iteration 0 of 1
phi.shape: (75, 4971)
U.shape: (4971, 34)
phi.dot(U).T shape: (34, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801340.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801340_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801340_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801340_test_data.npy
Cleanup complete.

Simulation 3/10 score: 0.701638187017861
Running repeat 4/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801592.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3998861_1741801592'
Loaded dataset: downsampled_5000genes_3998861_1741801592
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.33472710743583545 11.816317224721693 1.0 8.0 8.0
0.28232231496598403 16.929147566410727 1.0 8.0 8.0
0.29106552911147887 15.425212979787197 1.0 8.0 8.0
0.2927047293016162 15.561594386220698 1.0 8.0 8.0
0.2930386524199309 15.663459890799313 1.0 8.0 8.0
0.293369174690027 15.69927660933597 1.0 8.0 8.0
0.29365787602363214 15.665151620798566 1.0 8.0 8.0
0.29389546896499463 15.686850447278125 1.0 8.0 8.0
0.29403482903706957 15.698102697569105 1.0 8.0 8.0
0.2941354015474743 15.768723667751 1.0 8.0 8.0
0.2941110947968417 15.753376280094933 1.0 8.0 8.0
0.29410115670116166 15.760031557301103 1.0 8.0 8.0
0.294097570293012 15.75654246870619 1.0 8.0 8.0
0.2940926378467811 15.73949744046913 1.0 8.0 8.0
0.2940861205496844 15.737280454649644 1.0 8.0 8.0
0.29408037190874114 15.745632630284575 1.0 8.0 8.0
0.29407140247660235 15.742644244902484 1.0 8.0 8.0
0.29406617303290994 15.728798500120611 1.0 8.0 8.0
0.2940588829608832 15.726144618418182 1.0 8.0 8.0
0.29404265896660764 15.70628141074179 1.0 8.0 8.0
U dimensions = (4971, 36)
Iteration 0 of 1
phi.shape: (75, 4971)
U.shape: (4971, 36)
phi.dot(U).T shape: (36, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801592.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801592_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801592_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801592_test_data.npy
Cleanup complete.

Simulation 4/10 score: 0.6933659824090579
Running repeat 5/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801787.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3998861_1741801787'
Loaded dataset: downsampled_5000genes_3998861_1741801787
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3680353755587682 11.938423480915441 1.0 8.0 8.0
0.2829763351129643 21.605096060509265 1.0 8.0 8.0
0.2872109802904679 18.12388057743093 1.0 8.0 8.0
0.2953174316328788 17.037947899426833 1.0 8.0 8.0
0.29904395106841763 16.82404462355717 1.0 8.0 8.0
0.29926453216617543 16.694745925174978 1.0 8.0 8.0
0.29902504796151563 16.664512883079382 1.0 8.0 8.0
0.2990062672370889 16.671878020830125 1.0 8.0 8.0
0.2989271148525393 16.5830811052167 1.0 8.0 8.0
0.2989893715744395 16.594559521128538 1.0 8.0 8.0
0.2990138166233366 16.596080003326747 1.0 8.0 8.0
0.29901037506496553 16.590322093823957 1.0 8.0 8.0
0.2990093888502189 16.584441589371128 1.0 8.0 8.0
0.2990087307616405 16.58323247285294 1.0 8.0 8.0
0.2990073307030655 16.580364062696525 1.0 8.0 8.0
0.2990067691099476 16.578289392640656 1.0 8.0 8.0
0.299005894183208 16.580075954092546 1.0 8.0 8.0
0.2990054514019178 16.582484496724277 1.0 8.0 8.0
0.2990044918670839 16.584110003685492 1.0 8.0 8.0
0.29900332627702475 16.581733659500447 1.0 8.0 8.0
U dimensions = (4971, 36)
Iteration 0 of 1
phi.shape: (75, 4971)
U.shape: (4971, 36)
phi.dot(U).T shape: (36, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801787.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801787_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801787_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801787_test_data.npy
Cleanup complete.

Simulation 5/10 score: 0.6767985266725783
Running repeat 6/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801977.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3998861_1741801977'
Loaded dataset: downsampled_5000genes_3998861_1741801977
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.344525750219669 11.870891552176744 1.0 8.0 8.0
0.28678105265637954 18.994607071684992 1.0 8.0 8.0
0.29542411872905994 16.550278694467 1.0 8.0 8.0
0.29806472190849354 16.3526185799803 1.0 8.0 8.0
0.29918875633310993 16.005183028882733 1.0 8.0 8.0
0.2993834083493092 15.982564225543001 1.0 8.0 8.0
0.29941217140414134 15.977011214740148 1.0 8.0 8.0
0.29948400178739554 15.83478773812848 1.0 8.0 8.0
0.29965048243189685 15.785280564752348 1.0 8.0 8.0
0.2996138333732057 15.718256439908366 1.0 8.0 8.0
0.29960380428093913 15.667794784021899 1.0 8.0 8.0
0.29956600608670403 15.674430249289664 1.0 8.0 8.0
0.2995430375201017 15.677258289082728 1.0 8.0 8.0
0.29953582184378014 15.676759597161784 1.0 8.0 8.0
0.2995162823166171 15.683342146062351 1.0 8.0 8.0
0.29951609091155484 15.683013072989423 1.0 8.0 8.0
0.29951609686889513 15.68288053352965 1.0 8.0 8.0
0.29951609645684096 15.682881926167191 1.0 8.0 8.0
0.29951609647769106 15.682882677807656 1.0 8.0 8.0
0.29951609646986077 15.682882810303417 1.0 8.0 8.0
U dimensions = (4971, 36)
Iteration 0 of 1
phi.shape: (75, 4971)
U.shape: (4971, 36)
phi.dot(U).T shape: (36, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801977.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801977_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801977_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741801977_test_data.npy
Cleanup complete.

Simulation 6/10 score: 0.664709753103797
Running repeat 7/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741802201.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3998861_1741802201'
Loaded dataset: downsampled_5000genes_3998861_1741802201
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.35019337950202045 12.606839057259073 1.0 8.0 8.0
0.2828173818367328 21.30171053029601 1.0 8.0 8.0
0.2929215613489252 17.857278062722045 1.0 8.0 8.0
0.2948463774743507 17.36316142045493 1.0 8.0 8.0
0.296107982475485 17.233869174944395 1.0 8.0 8.0
0.2968509741140499 17.210019173425636 1.0 8.0 8.0
0.297067310142734 17.41532115918005 1.0 8.0 8.0
0.29714916891270915 17.442800410640256 1.0 8.0 8.0
0.2971685328273921 17.245723588681884 1.0 8.0 8.0
0.2973091250470493 17.16362873201894 1.0 8.0 8.0
0.29725450967578326 17.047067026106266 1.0 8.0 8.0
0.29725986969518114 17.015895583516322 1.0 8.0 8.0
0.2972304150364047 17.0272302596507 1.0 8.0 8.0
0.29722537879126176 17.03809382824457 1.0 8.0 8.0
0.2972225403354325 17.041673744246097 1.0 8.0 8.0
0.2972212501338528 17.044894979725854 1.0 8.0 8.0
0.29722021210105276 17.042473085553535 1.0 8.0 8.0
0.2972186944971462 17.049413154241975 1.0 8.0 8.0
0.29721893517047626 17.046431316339216 1.0 8.0 8.0
0.2972189398692595 17.03116567078549 1.0 8.0 8.0
U dimensions = (4971, 32)
Iteration 0 of 1
phi.shape: (75, 4971)
U.shape: (4971, 32)
phi.dot(U).T shape: (32, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741802201.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741802201_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741802201_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741802201_test_data.npy
Cleanup complete.

Simulation 7/10 score: 0.7206573368402419
Running repeat 8/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741802389.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3998861_1741802389'
Loaded dataset: downsampled_5000genes_3998861_1741802389
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3592531811215355 13.373313179623976 1.0 8.0 8.0
0.28879823963675344 22.235553426394148 1.0 8.0 8.0
0.2916983749153894 18.81930592341073 1.0 8.0 8.0
0.296259411555889 17.505171109705223 1.0 8.0 8.0
0.2983309473883421 17.318410255188763 1.0 8.0 8.0
0.2994861613683715 17.26709051185126 1.0 8.0 8.0
0.2997501796944475 17.22027573157076 1.0 8.0 8.0
0.3000502077352516 17.192331015022663 1.0 8.0 8.0
0.30026590698301414 17.127434531457084 1.0 8.0 8.0
0.30056876495056395 17.228772296012874 1.0 8.0 8.0
0.3007672503048767 17.129201421629865 1.0 8.0 8.0
0.3008322945098715 17.039849339419593 1.0 8.0 8.0
0.30083057530056967 17.03959122055341 1.0 8.0 8.0
0.3008295703681789 17.036026388093195 1.0 8.0 8.0
0.3008290887999502 17.03219027970247 1.0 8.0 8.0
0.3008293981430249 17.03187581322807 1.0 8.0 8.0
0.30082940568070593 17.03188904863251 1.0 8.0 8.0
0.30082940569316574 17.031889379452124 1.0 8.0 8.0
0.30082940569590033 17.031889404690094 1.0 8.0 8.0
0.3008294056967521 17.03188940756091 1.0 8.0 8.0
U dimensions = (4971, 31)
Iteration 0 of 1
phi.shape: (75, 4971)
U.shape: (4971, 31)
phi.dot(U).T shape: (31, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741802389.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741802389_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741802389_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741802389_test_data.npy
Cleanup complete.

Simulation 8/10 score: 0.7257257600538356
Running repeat 9/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741802628.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3998861_1741802628'
Loaded dataset: downsampled_5000genes_3998861_1741802628
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.38472291876331755 11.321403507044472 1.0 8.0 8.0
0.2867586971887034 22.63792676806895 1.0 8.0 8.0
0.28913823940792005 18.796701942662136 1.0 8.0 8.0
0.29316506544175525 18.050549808919346 1.0 8.0 8.0
0.2965255352731081 17.188507031255664 1.0 8.0 8.0
0.2964456587649522 16.947832346167942 1.0 8.0 8.0
0.2963795940481858 16.892537123310035 1.0 8.0 8.0
0.2963720862137639 16.86025994384682 1.0 8.0 8.0
0.29637499801575073 16.87550380541635 1.0 8.0 8.0
0.29636711592209963 16.856915968733365 1.0 8.0 8.0
0.2963645858143823 16.938109578200923 1.0 8.0 8.0
0.2963634060529903 16.963629076698698 1.0 8.0 8.0
0.2963554521298196 16.96409730325789 1.0 8.0 8.0
0.2962666920737179 17.048793157924877 1.0 8.0 8.0
0.2962218957940814 17.085259613227063 1.0 8.0 8.0
0.29619538262370326 17.086485433036064 1.0 8.0 8.0
0.2961939482034328 17.082735908195804 1.0 8.0 8.0
0.29618512326449475 17.080439664649877 1.0 8.0 8.0
0.2961795163548069 17.07540344291897 1.0 8.0 8.0
0.296172506320199 17.043846794720874 1.0 8.0 8.0
U dimensions = (4971, 35)
Iteration 0 of 1
phi.shape: (75, 4971)
U.shape: (4971, 35)
phi.dot(U).T shape: (35, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741802628.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741802628_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741802628_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741802628_test_data.npy
Cleanup complete.

Simulation 9/10 score: 0.6453809904991018
Running repeat 10/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741803011.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_3998861_1741803011'
Loaded dataset: downsampled_5000genes_3998861_1741803011
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.37531528287272353 12.956558129434656 1.0 8.0 8.0
0.27988951663789563 22.27840782390557 1.0 8.0 8.0
0.28899614476336344 18.005598353199257 1.0 8.0 8.0
0.2900008030848569 17.08220591042552 1.0 8.0 8.0
0.29052524264685564 17.083510527073823 1.0 8.0 8.0
0.2930394276829049 17.101917794386285 1.0 8.0 8.0
0.29967822980609793 16.93652640704773 1.0 8.0 8.0
0.29961448765816956 16.98081646523376 1.0 8.0 8.0
0.29976772078103686 16.97985451649961 1.0 8.0 8.0
0.2996573416260805 16.977034421821585 1.0 8.0 8.0
0.2996353121006553 16.975395478522103 1.0 8.0 8.0
0.29965119437326515 16.9776524957323 1.0 8.0 8.0
0.299646406541036 16.98248181202427 1.0 8.0 8.0
0.29963267030342067 16.915945290169297 1.0 8.0 8.0
0.29962944749408527 16.94932425403845 1.0 8.0 8.0
0.29962931600213927 16.996628666460992 1.0 8.0 8.0
0.299628357728412 17.022434714038532 1.0 8.0 8.0
0.29962750349615785 17.02701647337294 1.0 8.0 8.0
0.2996273533696381 17.036301941202176 1.0 8.0 8.0
0.29962721467111364 17.042927059972452 1.0 8.0 8.0
U dimensions = (4971, 33)
Iteration 0 of 1
phi.shape: (75, 4971)
U.shape: (4971, 33)
phi.dot(U).T shape: (33, 75)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741803011.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741803011_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741803011_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_3998861_1741803011_test_data.npy
Cleanup complete.

Simulation 10/10 score: 0.6539296395606808
Results saved: results/simulation/results_optimal.csv
Running simulation with: num_measurements=350, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=1000
Running repeat 1/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741801977.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_4006498_1741801977'
Loaded dataset: downsampled_1000genes_4006498_1741801977
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.1804026921577102 4.702663949470409 1.0 8.0 8.0
0.09354715157568028 12.139722492952028 1.0 8.0 8.0
0.08792745994074869 11.478319352124783 1.0 8.0 8.0
0.08516732003065208 10.975479066851893 1.0 8.0 8.0
0.08425108104069912 10.885694426438423 1.0 8.0 8.0
0.08395272177278945 10.718256098713825 1.0 8.0 8.0
0.08382319525917092 10.688140848130734 1.0 8.0 8.0
0.0837203298573359 10.690643071924796 1.0 8.0 8.0
0.0835367246925669 10.678687432647095 1.0 8.0 8.0
0.08345053882169673 10.677979439539499 1.0 8.0 8.0
0.08342070239521682 10.680818489797975 1.0 8.0 8.0
0.08341432863832365 10.676803692558911 1.0 8.0 8.0
0.0833998269391284 10.67135737021198 1.0 8.0 8.0
0.08338840284311222 10.671325556417305 1.0 8.0 8.0
0.08338810336593461 10.670272817455741 1.0 8.0 8.0
0.08338797525371122 10.669712904833386 1.0 8.0 8.0
0.08338795086181816 10.669624834728172 1.0 8.0 8.0
0.08338795061190873 10.669623894428112 1.0 8.0 8.0
0.08338795060881254 10.669623882625775 1.0 8.0 8.0
0.0833879506087748 10.669623882471182 1.0 8.0 8.0
U dimensions = (906, 37)
Iteration 0 of 1
phi.shape: (350, 906)
U.shape: (906, 37)
phi.dot(U).T shape: (37, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741801977.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741801977_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741801977_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741801977_test_data.npy
Cleanup complete.

Simulation 1/10 score: 0.8908148543149541
Running repeat 2/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741802095.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_4006498_1741802095'
Loaded dataset: downsampled_1000genes_4006498_1741802095
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.12942480660890832 5.039134479950508 1.0 8.0 8.0
0.07604344695592458 11.085689291758918 1.0 8.0 8.0
0.07523825980753063 11.037491690242772 1.0 8.0 8.0
0.07474612578835227 11.007583669014851 1.0 8.0 8.0
0.0744514684798494 10.898943515638774 1.0 8.0 8.0
0.07446791928183882 10.770509486310743 1.0 8.0 8.0
0.0745602782529402 10.690547506000442 1.0 8.0 8.0
0.07458284433184714 10.706841588656319 1.0 8.0 8.0
0.07468048255739845 10.491652666041523 1.0 8.0 8.0
0.07468316616760873 10.553378075486147 1.0 8.0 8.0
0.07464116357755302 10.422009037188609 1.0 8.0 8.0
0.07462022538092461 10.441527829340453 1.0 8.0 8.0
0.07463635528756474 10.407450408108447 1.0 8.0 8.0
0.07465457786070184 10.386202990770315 1.0 8.0 8.0
0.07464060972497266 10.383548211303422 1.0 8.0 8.0
0.07462990208399278 10.448047220535377 1.0 8.0 8.0
0.07462374782396253 10.442549869183118 1.0 8.0 8.0
0.07461953004632993 10.433680158467936 1.0 8.0 8.0
0.07460802504108599 10.334249404747949 1.0 8.0 8.0
0.07460471341770869 10.337685743645594 1.0 8.0 8.0
U dimensions = (906, 34)
Iteration 0 of 1
phi.shape: (350, 906)
U.shape: (906, 34)
phi.dot(U).T shape: (34, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741802095.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741802095_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741802095_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741802095_test_data.npy
Cleanup complete.

Simulation 2/10 score: 0.8763531477756953
Running repeat 3/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741802207.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_4006498_1741802207'
Loaded dataset: downsampled_1000genes_4006498_1741802207
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.19364164866374156 4.962034839148334 1.0 8.0 8.0
0.08575324854577548 11.692733005926438 1.0 8.0 8.0
0.0830270496101313 11.877474812532634 1.0 8.0 8.0
0.08200984282010182 11.696679423719145 1.0 8.0 8.0
0.08150068565828839 11.630022537429333 1.0 8.0 8.0
0.08131929841286767 11.54037351724416 1.0 8.0 8.0
0.08099619784093537 11.540729095659362 1.0 8.0 8.0
0.08073586997470461 11.339488833229504 1.0 8.0 8.0
0.08075247188374357 11.203588225072625 1.0 8.0 8.0
0.08080358610626193 11.135263531363103 1.0 8.0 8.0
0.08077757209626168 11.071009491891363 1.0 8.0 8.0
0.08076969742728946 10.973912654978832 1.0 8.0 8.0
0.08080512334082801 10.944056454063679 1.0 8.0 8.0
0.0807786318236241 10.950891346770588 1.0 8.0 8.0
0.08079090658146892 10.944969741031095 1.0 8.0 8.0
0.08081706140456979 10.941073545773504 1.0 8.0 8.0
0.08080190419215916 10.945064100274852 1.0 8.0 8.0
0.08080741249523804 10.940713536965049 1.0 8.0 8.0
0.08082666992374155 10.937946828808116 1.0 8.0 8.0
0.0808017847277458 10.94512324029858 1.0 8.0 8.0
U dimensions = (906, 34)
Iteration 0 of 1
phi.shape: (350, 906)
U.shape: (906, 34)
phi.dot(U).T shape: (34, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741802207.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741802207_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741802207_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741802207_test_data.npy
Cleanup complete.

Simulation 3/10 score: 0.855746151886265
Running repeat 4/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741802389.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_4006498_1741802389'
Loaded dataset: downsampled_1000genes_4006498_1741802389
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.16391974429685252 5.4059268892062065 1.0 8.0 8.0
0.08621063899178438 11.244944867490231 1.0 8.0 8.0
0.08421417860701608 11.326980586579069 1.0 8.0 8.0
0.0835165485532855 11.27420347470736 1.0 8.0 8.0
0.08307913600524963 11.428848816125088 1.0 8.0 8.0
0.08256778230177242 11.454782459045031 1.0 8.0 8.0
0.08188622188883199 11.492215827289503 1.0 8.0 8.0
0.08153633535831983 11.509478922439307 1.0 8.0 8.0
0.08134105261624769 11.502748013589514 1.0 8.0 8.0
0.08126222897583746 11.559820763733022 1.0 8.0 8.0
0.08113469165270515 11.547783603472954 1.0 8.0 8.0
0.08110892114554413 11.547207793433039 1.0 8.0 8.0
0.08109425734353848 11.548134468866497 1.0 8.0 8.0
0.08108248710897203 11.549597630715532 1.0 8.0 8.0
0.08108255462130565 11.549586578254155 1.0 8.0 8.0
0.0810825544855438 11.549586643170434 1.0 8.0 8.0
0.0810825545006637 11.549586633456743 1.0 8.0 8.0
0.08108255450135282 11.549586632253583 1.0 8.0 8.0
0.08108255450141322 11.549586632101253 1.0 8.0 8.0
0.08108255450141899 11.549586632082962 1.0 8.0 8.0
U dimensions = (906, 38)
Iteration 0 of 1
phi.shape: (350, 906)
U.shape: (906, 38)
phi.dot(U).T shape: (38, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741802389.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741802389_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741802389_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741802389_test_data.npy
Cleanup complete.

Simulation 4/10 score: 0.898693935720091
Running repeat 5/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741802628.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_4006498_1741802628'
Loaded dataset: downsampled_1000genes_4006498_1741802628
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.1465482920726915 3.9434746025137963 nan 8.0 8.0
0.06813929896119097 10.411526172490806 nan 8.0 8.0
0.06675737175060115 9.160871906224173 nan 8.0 8.0
0.06576395251282718 8.968000886485928 nan 8.0 8.0
0.06525281154587059 8.809131121999423 nan 8.0 8.0
0.06501935303046158 8.680990258895322 nan 8.0 8.0
0.06480944230474583 8.637861324023547 nan 8.0 8.0
0.06471946961896535 8.620822182351525 nan 8.0 8.0
0.06471280688122194 8.61258743474889 nan 8.0 8.0
0.0647140541188792 8.601316256368241 nan 8.0 8.0
0.06470021572517703 8.598173865391042 nan 8.0 8.0
0.06470350470399555 8.592609935123152 nan 8.0 8.0
0.0647064752921408 8.590304289789495 nan 8.0 8.0
0.06472166119987566 8.589636742055363 nan 8.0 8.0
0.06473963355842571 8.587361872246213 nan 8.0 8.0
0.064767928369457 8.539378857977278 nan 8.0 8.0
0.06480483205113219 8.528890596946928 nan 8.0 8.0
0.06480360198099566 8.554703224187989 nan 8.0 8.0
0.06481403826332177 8.551348529902075 nan 8.0 8.0
0.06480369092439453 8.563887404183697 nan 8.0 8.0
U dimensions = (906, 35)
Iteration 0 of 1
phi.shape: (350, 906)
U.shape: (906, 35)
phi.dot(U).T shape: (35, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741802628.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741802628_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741802628_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741802628_test_data.npy
Cleanup complete.

Simulation 5/10 score: 0.8960473141937505
Running repeat 6/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803011.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_4006498_1741803011'
Loaded dataset: downsampled_1000genes_4006498_1741803011
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.15697055243779134 4.8024175483451295 1.0 8.0 8.0
0.08709043044985088 11.50835382505423 1.0 8.0 8.0
0.08510112471719433 10.99479519520868 1.0 8.0 8.0
0.08434434831361781 10.924920305204294 1.0 8.0 8.0
0.08400075090626724 11.134649244588108 1.0 8.0 8.0
0.08385049592954463 11.079295976519814 1.0 8.0 8.0
0.08381908152488915 11.076259379700122 1.0 8.0 8.0
0.08378941791144368 11.130068098995329 1.0 8.0 8.0
0.0837740874525934 11.175868879171285 1.0 8.0 8.0
0.0837749178707694 11.190201901351752 1.0 8.0 8.0
0.08374831208254652 11.191173496077697 1.0 8.0 8.0
0.08378368988876295 11.18571016232105 1.0 8.0 8.0
0.08380650127997402 11.184511186331122 1.0 8.0 8.0
0.08379736257141956 11.182398515906964 1.0 8.0 8.0
0.08377736467908514 11.189341801258399 1.0 8.0 8.0
0.08378228351797945 11.19038574050798 1.0 8.0 8.0
0.08380815377738382 11.18864301575587 1.0 8.0 8.0
0.08381116055123672 11.178086551546 1.0 8.0 8.0
0.08382766605772407 11.169764324641365 1.0 8.0 8.0
0.08382762206018812 11.166033416804364 1.0 8.0 8.0
U dimensions = (906, 35)
Iteration 0 of 1
phi.shape: (350, 906)
U.shape: (906, 35)
phi.dot(U).T shape: (35, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803011.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803011_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803011_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803011_test_data.npy
Cleanup complete.

Simulation 6/10 score: 0.881137099633865
Running repeat 7/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803169.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_4006498_1741803169'
Loaded dataset: downsampled_1000genes_4006498_1741803169
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.17071136534835962 5.9495629052523595 1.0 8.0 8.0
0.08260349101021647 12.790268541396184 1.0 8.0 8.0
0.08123481892096418 11.996285762400822 1.0 8.0 8.0
0.08079806636493159 11.537681506782855 1.0 8.0 8.0
0.0806429888291178 11.626491190254933 1.0 8.0 8.0
0.08049096260119681 11.392108051563053 1.0 8.0 8.0
0.08030718079485832 11.404355485737948 1.0 8.0 8.0
0.08028768557022492 11.353088640923932 1.0 8.0 8.0
0.08033949649272798 11.279568705617274 1.0 8.0 8.0
0.08040675191489266 11.243313019611861 1.0 8.0 8.0
0.0804288274950199 11.232097017349899 1.0 8.0 8.0
0.0804874974016555 11.219668996745824 1.0 8.0 8.0
0.08054717004298384 11.190598910812097 1.0 8.0 8.0
0.08057164262284866 11.173045684569281 1.0 8.0 8.0
0.08058695012803674 11.163124530172883 1.0 8.0 8.0
0.08059655620731832 11.152580814927617 1.0 8.0 8.0
0.0805981857788517 11.152396027327068 1.0 8.0 8.0
0.0805981549875271 11.152394135053472 1.0 8.0 8.0
0.08059815527220493 11.15239079945355 1.0 8.0 8.0
0.08059815516434132 11.152390027414905 1.0 8.0 8.0
U dimensions = (906, 37)
Iteration 0 of 1
phi.shape: (350, 906)
U.shape: (906, 37)
phi.dot(U).T shape: (37, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803169.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803169_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803169_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803169_test_data.npy
Cleanup complete.

Simulation 7/10 score: 0.8523403952922439
Running repeat 8/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803322.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_4006498_1741803322'
Loaded dataset: downsampled_1000genes_4006498_1741803322
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.1761756321463418 5.616147138851495 1.0 8.0 8.0
0.08390479702993403 11.653978180215159 1.0 8.0 8.0
0.08376590998635391 11.603549182687999 1.0 8.0 8.0
0.0834909648979848 11.485366946855176 1.0 8.0 8.0
0.08315396914507034 11.527547696753077 1.0 8.0 8.0
0.08293768778104416 11.56176879398374 1.0 8.0 8.0
0.08288253165600812 11.55800011502987 1.0 8.0 8.0
0.08287375577819556 11.550505417910568 1.0 8.0 8.0
0.08293327028823294 11.548134577070634 1.0 8.0 8.0
0.08296854401058862 11.548518342454063 1.0 8.0 8.0
0.08297681754484376 11.55266860210363 1.0 8.0 8.0
0.08296862669301841 11.553520598815638 1.0 8.0 8.0
0.08294967692811295 11.555790801903845 1.0 8.0 8.0
0.08291485366017426 11.557181490931889 1.0 8.0 8.0
0.08289831262044678 11.556816520845093 1.0 8.0 8.0
0.08289310275222661 11.557362357559228 1.0 8.0 8.0
0.0828905350375645 11.557383872439214 1.0 8.0 8.0
0.08289404167371972 11.556073723264491 1.0 8.0 8.0
0.08290361884233177 11.551820556281898 1.0 8.0 8.0
0.08290388311140029 11.55178360420823 1.0 8.0 8.0
U dimensions = (906, 36)
Iteration 0 of 1
phi.shape: (350, 906)
U.shape: (906, 36)
phi.dot(U).T shape: (36, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803322.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803322_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803322_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803322_test_data.npy
Cleanup complete.

Simulation 8/10 score: 0.8954396104602825
Running repeat 9/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803358.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_4006498_1741803358'
Loaded dataset: downsampled_1000genes_4006498_1741803358
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.17955382525494 5.998667087558426 1.0 8.0 8.0
0.08679747162257201 13.030235668764721 1.0 8.0 8.0
0.08199813609924622 12.700734263283678 1.0 8.0 8.0
0.08075685916138076 12.356028461886613 1.0 8.0 8.0
0.0804058274337246 12.186520657406522 1.0 8.0 8.0
0.08011334420580973 12.13641946644031 1.0 8.0 8.0
0.07977907918804217 12.160052987913733 1.0 8.0 8.0
0.07963847827900383 12.146935296927591 1.0 8.0 8.0
0.07962410116359442 12.129416892597517 1.0 8.0 8.0
0.07969335570138814 12.105917965956397 1.0 8.0 8.0
0.07977361780736059 12.081676324674103 1.0 8.0 8.0
0.07983500382513975 12.072130993416664 1.0 8.0 8.0
0.07989487041267851 12.054678750045394 1.0 8.0 8.0
0.07991502248495963 12.042515863366171 1.0 8.0 8.0
0.07999435134624933 12.016764320003272 1.0 8.0 8.0
0.08008583132777258 11.961513966154467 1.0 8.0 8.0
0.0802149574905866 11.900671023712148 1.0 8.0 8.0
0.08021551034556018 11.886659565521333 1.0 8.0 8.0
0.08019747869844607 11.8911617196248 1.0 8.0 8.0
0.08017311943122563 11.894136732015571 1.0 8.0 8.0
U dimensions = (906, 37)
Iteration 0 of 1
phi.shape: (350, 906)
U.shape: (906, 37)
phi.dot(U).T shape: (37, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803358.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803358_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803358_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803358_test_data.npy
Cleanup complete.

Simulation 9/10 score: 0.8688931191017366
Running repeat 10/10...
Matched genes for 1000 set: 906
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803405.h5ad
Train data shape: (5000, 906)
Validation data shape: (2500, 906)
Test data shape: (2500, 906)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_1000genes_4006498_1741803405'
Loaded dataset: downsampled_1000genes_4006498_1741803405
Train data shape: (906, 5000)
Validation data shape: (906, 2500)
Test data shape: (906, 2500)
0.17915069148412233 5.554046294709063 1.0 8.0 8.0
0.08605581170360088 13.277577831771406 1.0 8.0 8.0
0.08462643172106632 12.706661844172906 1.0 8.0 8.0
0.08367442025173233 12.510703043646293 1.0 8.0 8.0
0.08329601513180929 12.280996986848203 1.0 8.0 8.0
0.0830993466584492 12.226916339228655 1.0 8.0 8.0
0.08276199508325399 12.196289008370611 1.0 8.0 8.0
0.08253146421981405 12.189797545341957 1.0 8.0 8.0
0.08228149885852654 12.264439877496255 1.0 8.0 8.0
0.08236372970885186 12.26230225308853 1.0 8.0 8.0
0.08238992095190034 12.23781621768623 1.0 8.0 8.0
0.0823101795335065 12.247124973458666 1.0 8.0 8.0
0.08225591859052905 12.256366850599255 1.0 8.0 8.0
0.08217321181426518 12.258907032333406 1.0 8.0 8.0
0.08213225988560147 12.251309354325576 1.0 8.0 8.0
0.08210348914684307 12.25861582525685 1.0 8.0 8.0
0.08207542161884473 12.262562902925149 1.0 8.0 8.0
0.0820603873946898 12.264192491231762 1.0 8.0 8.0
0.08207229388484527 12.258823575013558 1.0 8.0 8.0
0.08203805590630153 12.256553843351536 1.0 8.0 8.0
U dimensions = (906, 37)
Iteration 0 of 1
phi.shape: (350, 906)
U.shape: (906, 37)
phi.dot(U).T shape: (37, 350)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803405.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803405_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803405_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_1000genes_4006498_1741803405_test_data.npy
Cleanup complete.

Simulation 10/10 score: 0.8931717013931257
Results saved: results/simulation/results_optimal.csv
Running simulation with: num_measurements=500, num_modules=40, lda1=8.0, lda2=8.0, sparsity=0.02, gene_set_size=5000
Running repeat 1/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802349.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_283309_1741802349'
Loaded dataset: downsampled_5000genes_283309_1741802349
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.35647853059501267 11.601985648727855 1.0 8.0 8.0
0.291730089158558 22.004014758111683 1.0 8.0 8.0
0.2999642849617461 17.730549546302896 1.0 8.0 8.0
0.3012381899042381 16.959300795748018 1.0 8.0 8.0
0.30139339148940814 17.051237125735767 1.0 8.0 8.0
0.3017355445715425 17.17599564533958 1.0 8.0 8.0
0.30177131435965965 17.217783771672323 1.0 8.0 8.0
0.3017567515730111 17.219089509806793 1.0 8.0 8.0
0.3018703590811379 17.247957107353216 1.0 8.0 8.0
0.3021249319020243 17.32701734522372 1.0 8.0 8.0
0.3023270758554165 17.347502776874556 1.0 8.0 8.0
0.3025037866362853 17.33857980625543 1.0 8.0 8.0
0.30248360775904515 17.339931966518318 1.0 8.0 8.0
0.3024793406105264 17.33984986393988 1.0 8.0 8.0
0.3024794393703729 17.338744443301003 1.0 8.0 8.0
0.3024793144269142 17.338892845947274 1.0 8.0 8.0
0.30247835845185567 17.33989678597216 1.0 8.0 8.0
0.3024761565565125 17.336659377679506 1.0 8.0 8.0
0.30247485916570127 17.332399875151506 1.0 8.0 8.0
0.30247390014660624 17.33420309213853 1.0 8.0 8.0
U dimensions = (4971, 33)
Iteration 0 of 1
phi.shape: (500, 4971)
U.shape: (4971, 33)
phi.dot(U).T shape: (33, 500)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802349.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802349_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802349_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802349_test_data.npy
Cleanup complete.

Simulation 1/10 score: 0.7831763743476202
Running repeat 2/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802450.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_283309_1741802450'
Loaded dataset: downsampled_5000genes_283309_1741802450
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3539545534823373 11.752662523867142 1.0 8.0 8.0
0.290419586715264 20.42979962069829 1.0 8.0 8.0
0.2972988442952259 15.867905618546962 1.0 8.0 8.0
0.2976687100734289 15.518774746052996 1.0 8.0 8.0
0.2977258295104308 15.461192754530051 1.0 8.0 8.0
0.2975679131908131 15.403200286079226 1.0 8.0 8.0
0.29761223501073053 15.400772391871083 1.0 8.0 8.0
0.29768140711529334 15.452655955054361 1.0 8.0 8.0
0.29766738655868485 15.445106567265514 1.0 8.0 8.0
0.2976663478054161 15.461589257957687 1.0 8.0 8.0
0.2976653064965985 15.469505654140727 1.0 8.0 8.0
0.2976607928728049 15.496700672541659 1.0 8.0 8.0
0.29765525978946483 15.525648343234009 1.0 8.0 8.0
0.29765289434191533 15.513819649032662 1.0 8.0 8.0
0.29765108181146693 15.507716297310822 1.0 8.0 8.0
0.29765001985963235 15.499903568114227 1.0 8.0 8.0
0.2976489211851002 15.492507393308145 1.0 8.0 8.0
0.2976482676459885 15.487143849681576 1.0 8.0 8.0
0.29764796074527344 15.485041379630905 1.0 8.0 8.0
0.2976476071829487 15.484376728193343 1.0 8.0 8.0
U dimensions = (4971, 37)
Iteration 0 of 1
phi.shape: (500, 4971)
U.shape: (4971, 37)
phi.dot(U).T shape: (37, 500)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802450.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802450_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802450_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802450_test_data.npy
Cleanup complete.

Simulation 2/10 score: 0.7950987991051035
Running repeat 3/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802553.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_283309_1741802553'
Loaded dataset: downsampled_5000genes_283309_1741802553
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.35394666618679826 11.383548091506256 1.0 8.0 8.0
0.2921239300244237 21.24326983002085 1.0 8.0 8.0
0.2973119669601222 18.077980782875482 1.0 8.0 8.0
0.29815039270121335 17.803047217782385 1.0 8.0 8.0
0.2987559641975026 17.738141361693366 1.0 8.0 8.0
0.29893698553981074 17.73610213712189 1.0 8.0 8.0
0.2990245145765692 17.71087062425799 1.0 8.0 8.0
0.29899418988584536 17.64798688983934 1.0 8.0 8.0
0.2991314211477375 17.646718150609303 1.0 8.0 8.0
0.299074999498258 17.631549601037246 1.0 8.0 8.0
0.29914468314775244 17.298659194846604 1.0 8.0 8.0
0.2991415933072623 17.35148383945161 1.0 8.0 8.0
0.2991374260185641 17.38530409947518 1.0 8.0 8.0
0.2991302322002303 17.469951432654927 1.0 8.0 8.0
0.2991289604411955 17.44459714801681 1.0 8.0 8.0
0.29912912072320164 17.41605568753293 1.0 8.0 8.0
0.2991398561486216 17.404190420469703 1.0 8.0 8.0
0.2991388956023908 17.410383121985415 1.0 8.0 8.0
0.2991392180055943 17.40837274972097 1.0 8.0 8.0
0.29913916488322967 17.40254898597958 1.0 8.0 8.0
U dimensions = (4971, 34)
Iteration 0 of 1
phi.shape: (500, 4971)
U.shape: (4971, 34)
phi.dot(U).T shape: (34, 500)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802553.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802553_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802553_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802553_test_data.npy
Cleanup complete.

Simulation 3/10 score: 0.7815343461657821
Running repeat 4/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802659.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_283309_1741802659'
Loaded dataset: downsampled_5000genes_283309_1741802659
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3630366167971978 13.06957085186614 1.0 8.0 8.0
0.27865574326597764 22.073156756143977 1.0 8.0 8.0
0.2881733295068861 18.848205060568564 1.0 8.0 8.0
0.29088477051206285 16.70289888501294 1.0 8.0 8.0
0.2958734774430676 15.534352627156151 1.0 8.0 8.0
0.29724619784597606 15.88262867086191 1.0 8.0 8.0
0.2979657844525484 15.977722837915334 1.0 8.0 8.0
0.29837082533639225 16.06647108899884 1.0 8.0 8.0
0.29869717884689273 15.960789296341973 1.0 8.0 8.0
0.2988103200378238 15.934723106432795 1.0 8.0 8.0
0.298772290903467 15.94630945668625 1.0 8.0 8.0
0.29875592323919886 15.95061212975092 1.0 8.0 8.0
0.2987590439105525 15.962635876315343 1.0 8.0 8.0
0.29875309365402347 15.96239906397002 1.0 8.0 8.0
0.29874827839522244 15.917414066800818 1.0 8.0 8.0
0.29874563447027025 15.918971300500846 1.0 8.0 8.0
0.29874451991402673 15.927236439435864 1.0 8.0 8.0
0.2987438566035072 15.937824714493592 1.0 8.0 8.0
0.298743694255423 15.93761729457506 1.0 8.0 8.0
0.29874375897975236 15.938734005869522 1.0 8.0 8.0
U dimensions = (4971, 34)
Iteration 0 of 1
phi.shape: (500, 4971)
U.shape: (4971, 34)
phi.dot(U).T shape: (34, 500)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802659.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802659_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802659_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802659_test_data.npy
Cleanup complete.

Simulation 4/10 score: 0.7839590637396514
Running repeat 5/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802759.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_283309_1741802759'
Loaded dataset: downsampled_5000genes_283309_1741802759
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.34197141395072583 12.002595282657715 1.0 8.0 8.0
0.2854551293572609 19.210050661665832 1.0 8.0 8.0
0.2937534237546163 17.43929914983117 1.0 8.0 8.0
0.2955459902361175 16.884252828426273 1.0 8.0 8.0
0.29637418616804834 16.997848532092988 1.0 8.0 8.0
0.2968089001269294 17.07563795816767 1.0 8.0 8.0
0.29676152351517593 17.098474101679024 1.0 8.0 8.0
0.2966234465214319 16.98693836458518 1.0 8.0 8.0
0.29652809305732164 16.979402630944165 1.0 8.0 8.0
0.2964149760167386 16.954442274621968 1.0 8.0 8.0
0.2963762497955422 16.905141072924017 1.0 8.0 8.0
0.2963584092001852 16.89927063633991 1.0 8.0 8.0
0.296375131215293 16.896693161416966 1.0 8.0 8.0
0.2963824156061913 16.893293526165706 1.0 8.0 8.0
0.296381235486754 16.889996824166143 1.0 8.0 8.0
0.29638066013444886 16.887484780828807 1.0 8.0 8.0
0.2963803412987849 16.885572583287612 1.0 8.0 8.0
0.2963803104740763 16.885153644135155 1.0 8.0 8.0
0.2963802817303496 16.88518589020203 1.0 8.0 8.0
0.29638028096649605 16.88518889168475 1.0 8.0 8.0
U dimensions = (4971, 34)
Iteration 0 of 1
phi.shape: (500, 4971)
U.shape: (4971, 34)
phi.dot(U).T shape: (34, 500)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802759.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802759_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802759_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741802759_test_data.npy
Cleanup complete.

Simulation 5/10 score: 0.7803202927878232
Running repeat 6/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803002.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_283309_1741803002'
Loaded dataset: downsampled_5000genes_283309_1741803002
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3530300163079376 12.449440644131199 1.0 8.0 8.0
0.2804535026331787 20.141220314188214 1.0 8.0 8.0
0.28767317412451077 16.547137565841865 1.0 8.0 8.0
0.2946762085333563 16.21362297769542 1.0 8.0 8.0
0.29630632852356975 16.195127049098442 1.0 8.0 8.0
0.2962612811584934 16.03154518013099 1.0 8.0 8.0
0.29654369749084286 15.940085907024942 1.0 8.0 8.0
0.2966268415904929 15.772950489457978 1.0 8.0 8.0
0.296639991768446 15.666303610247091 1.0 8.0 8.0
0.2966222817422981 15.522212561176692 1.0 8.0 8.0
0.2966130883274435 15.292939502212155 1.0 8.0 8.0
0.2966106253349954 15.279885315208658 1.0 8.0 8.0
0.29660322411744644 15.290319920936343 1.0 8.0 8.0
0.29658954121998804 15.276673960802782 1.0 8.0 8.0
0.2965742557537834 15.26288500816681 1.0 8.0 8.0
0.2965716150481189 15.132096517103442 1.0 8.0 8.0
0.29657005304395934 15.204834714522361 1.0 8.0 8.0
0.29656694887309576 15.20546129376601 1.0 8.0 8.0
0.2965663162905742 15.234497696100792 1.0 8.0 8.0
0.29656619552130215 15.23547836166037 1.0 8.0 8.0
U dimensions = (4971, 36)
Iteration 0 of 1
phi.shape: (500, 4971)
U.shape: (4971, 36)
phi.dot(U).T shape: (36, 500)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803002.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803002_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803002_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803002_test_data.npy
Cleanup complete.

Simulation 6/10 score: 0.7880719523712825
Running repeat 7/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803102.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_283309_1741803102'
Loaded dataset: downsampled_5000genes_283309_1741803102
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.36657107766671393 12.589829283243153 1.0 8.0 8.0
0.28285276547192395 22.5154820204957 1.0 8.0 8.0
0.28867063094119183 18.321171076290653 1.0 8.0 8.0
0.28925116791284644 17.91963743532814 1.0 8.0 8.0
0.29612727940547234 17.749092674971298 1.0 8.0 8.0
0.29637888195415696 17.6240099273097 1.0 8.0 8.0
0.29668729530368054 17.6134198667893 1.0 8.0 8.0
0.2969584746139189 17.595926886951865 1.0 8.0 8.0
0.2971437329539113 17.552965320966184 1.0 8.0 8.0
0.2972278608432951 17.52167437970227 1.0 8.0 8.0
0.297229389340373 17.514304085029384 1.0 8.0 8.0
0.2972335476642072 17.508079264123694 1.0 8.0 8.0
0.2972384462028914 17.501299398339917 1.0 8.0 8.0
0.29724147738562945 17.424732113393258 1.0 8.0 8.0
0.29724453325151 17.314445859386176 1.0 8.0 8.0
0.2972180422535289 17.24565761141939 1.0 8.0 8.0
0.2972061356234882 17.23705445208459 1.0 8.0 8.0
0.29723538076215705 17.173419681083686 1.0 8.0 8.0
0.29723546109504395 17.153755014845103 1.0 8.0 8.0
0.29723524212517183 17.15075241793948 1.0 8.0 8.0
U dimensions = (4971, 32)
Iteration 0 of 1
phi.shape: (500, 4971)
U.shape: (4971, 32)
phi.dot(U).T shape: (32, 500)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803102.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803102_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803102_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803102_test_data.npy
Cleanup complete.

Simulation 7/10 score: 0.7824611272814693
Running repeat 8/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803205.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_283309_1741803205'
Loaded dataset: downsampled_5000genes_283309_1741803205
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3494169758793363 11.849840945035751 1.0 8.0 8.0
0.2877515260457646 19.812259367363378 1.0 8.0 8.0
0.29417473117845827 17.337352507464697 1.0 8.0 8.0
0.2958469441728421 16.547688728734688 1.0 8.0 8.0
0.29653363444634284 16.32825919045093 1.0 8.0 8.0
0.2967657703323425 16.271087150730867 1.0 8.0 8.0
0.29682640010231964 16.273281084486996 1.0 8.0 8.0
0.29683080349178104 16.21356445429585 1.0 8.0 8.0
0.29682917771261264 16.205803543774273 1.0 8.0 8.0
0.2968283920014313 16.207260299553965 1.0 8.0 8.0
0.29682772991324247 16.20628202775109 1.0 8.0 8.0
0.29682748548324955 16.206601466795984 1.0 8.0 8.0
0.29682738376369444 16.206723659277767 1.0 8.0 8.0
0.29682736811413013 16.20672071756755 1.0 8.0 8.0
0.29682736761007 16.20671964265401 1.0 8.0 8.0
0.2968273675106733 16.206719467780115 1.0 8.0 8.0
0.29682736750436667 16.20671944988495 1.0 8.0 8.0
0.29682736750319894 16.20671944760386 1.0 8.0 8.0
0.29682736750311267 16.206719447369164 1.0 8.0 8.0
0.2968273675030987 16.206719447340667 1.0 8.0 8.0
U dimensions = (4971, 36)
Iteration 0 of 1
phi.shape: (500, 4971)
U.shape: (4971, 36)
phi.dot(U).T shape: (36, 500)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803205.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803205_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803205_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803205_test_data.npy
Cleanup complete.

Simulation 8/10 score: 0.7829990850019037
Running repeat 9/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803323.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_283309_1741803323'
Loaded dataset: downsampled_5000genes_283309_1741803323
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.3566404667878822 12.09190311883258 1.0 8.0 8.0
0.28350042847221224 21.83275000323158 1.0 8.0 8.0
0.29576589158631195 17.932141194800653 1.0 8.0 8.0
0.29805111356636593 17.370438922352488 1.0 8.0 8.0
0.29929227251130963 17.087914681304373 1.0 8.0 8.0
0.2998173065712484 17.05106992155058 1.0 8.0 8.0
0.3001502810900848 17.11121673272033 1.0 8.0 8.0
0.3002007127793742 17.30012916777159 1.0 8.0 8.0
0.3002520834264577 17.279772937059697 1.0 8.0 8.0
0.30022994884739707 17.229702020111645 1.0 8.0 8.0
0.3001424631978511 17.21490092830596 1.0 8.0 8.0
0.30012230048531185 17.22778469310133 1.0 8.0 8.0
0.300048088687644 17.237644807273423 1.0 8.0 8.0
0.3000454430942614 17.242851955881516 1.0 8.0 8.0
0.30005253245425223 17.236991928961782 1.0 8.0 8.0
0.30005892871977746 17.23955665024189 1.0 8.0 8.0
0.30005930701358285 17.242027948714004 1.0 8.0 8.0
0.300058715700382 17.243830787307704 1.0 8.0 8.0
0.3000586713353366 17.245649831575168 1.0 8.0 8.0
0.30005862667442096 17.249045866581408 1.0 8.0 8.0
U dimensions = (4971, 30)
Iteration 0 of 1
phi.shape: (500, 4971)
U.shape: (4971, 30)
phi.dot(U).T shape: (30, 500)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803323.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803323_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803323_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803323_test_data.npy
Cleanup complete.

Simulation 9/10 score: 0.7772730659698344
Running repeat 10/10...
Matched genes for 5000 set: 4971
Downsampled dataset saved to ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803423.h5ad
Train data shape: (5000, 4971)
Validation data shape: (2500, 4971)
Test data shape: (2500, 4971)
Datasets saved in ./dataset/pmotorcortex/pmotorcortex_mouse with prefix 'downsampled_5000genes_283309_1741803423'
Loaded dataset: downsampled_5000genes_283309_1741803423
Train data shape: (4971, 5000)
Validation data shape: (4971, 2500)
Test data shape: (4971, 2500)
0.367830344392454 12.592973342462445 1.0 8.0 8.0
0.2811384377291105 21.08244941248522 1.0 8.0 8.0
0.29157354195897045 16.826640362890917 1.0 8.0 8.0
0.2937555830293579 16.971474107387124 1.0 8.0 8.0
0.2954627177152577 17.068829432617356 1.0 8.0 8.0
0.2959529989336036 17.178645757967864 1.0 8.0 8.0
0.296270626555874 17.173456480680933 1.0 8.0 8.0
0.29632351859224315 17.161185715459307 1.0 8.0 8.0
0.29646216004925674 17.413251301937564 1.0 8.0 8.0
0.2963818107784534 17.41297774572728 1.0 8.0 8.0
0.29635054181773945 17.37940591738992 1.0 8.0 8.0
0.29625645047006355 17.397916839124854 1.0 8.0 8.0
0.29622401917490115 17.409568882823926 1.0 8.0 8.0
0.29618327217605367 17.428763071821265 1.0 8.0 8.0
0.29617499175537587 17.442165239188167 1.0 8.0 8.0
0.29618549940782524 17.439783137756514 1.0 8.0 8.0
0.2961828443306682 17.442484500262005 1.0 8.0 8.0
0.2961754641255977 17.456545476966006 1.0 8.0 8.0
0.2961752143568557 17.456369960852033 1.0 8.0 8.0
0.29617500982988254 17.45412556955733 1.0 8.0 8.0
U dimensions = (4971, 32)
Iteration 0 of 1
phi.shape: (500, 4971)
U.shape: (4971, 32)
phi.dot(U).T shape: (32, 500)

Cleaning up temporary files...
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803423.h5ad
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803423_train_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803423_validate_data.npy
Deleted: ./dataset/pmotorcortex/pmotorcortex_mouse/downsampled_5000genes_283309_1741803423_test_data.npy
Cleanup complete.

Simulation 10/10 score: 0.7807664905267669
Results saved: results/simulation/results_optimal.csv
